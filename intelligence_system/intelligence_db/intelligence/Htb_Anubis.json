{
  "writeup_id": "Htb_Anubis",
  "scenario_fingerprint": {
    "scenario_name": "windows_docker_asp_injection_to_certificate_abuse",
    "primary_services": [
      "https",
      "smb",
      "msrpc"
    ],
    "port_signature": "135+443+445+593",
    "service_combination": "https+smb+msrpc+rpc_over_http",
    "os_family": "windows_server",
    "environment_type": "windows_domain_with_docker",
    "entry_vector": "asp_injection",
    "privilege_path": "docker_escape_to_certificate_template_abuse",
    "attack_complexity": "insane",
    "estimated_time": "4-6 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "asp_classic_application",
      "docker_container_hosting",
      "certificate_template_misconfiguration",
      "jamovi_file_exploitation",
      "netntlmv2_hash_capture"
    ],
    "environmental_clues": [
      "microsoft_httpapi_headers",
      "windcorp_domain_certificate",
      "smb_signing_required",
      "clock_skew_present",
      "asp_session_cookies"
    ],
    "similar_scenarios": [
      "escape_htb_insane",
      "blackfield_htb_hard"
    ],
    "unique_aspects": [
      "asp_injection_in_docker",
      "certificate_request_information_disclosure",
      "jamovi_statistical_software_exploitation",
      "smart_card_authentication_template_abuse"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "ASP_Injection",
        "success_reason": "Legacy ASP application vulnerable to server-side injection",
        "prerequisite_indicators": [
          "asp_file_extensions",
          "no_aspnet_headers",
          "classic_asp_session_cookies",
          "get_based_form_submission"
        ],
        "recognition_patterns": [
          "ASPSESSIONID cookie format",
          "Microsoft-IIS server headers",
          "GET requests to .asp files",
          "lack of ViewState parameters"
        ],
        "failure_modes": [
          "modern_aspnet_application",
          "input_validation_present",
          "waf_protection_enabled"
        ],
        "environmental_factors": [
          "legacy_asp_configuration",
          "docker_container_environment",
          "insufficient_input_sanitization"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "Certificate_Template_Abuse",
        "success_reason": "User had full control over certificate template with modifiable purposes",
        "prerequisite_indicators": [
          "active_directory_certificate_services",
          "user_permissions_on_templates",
          "smart_card_authentication_available"
        ],
        "recognition_patterns": [
          "certificate template enumeration",
          "full control permissions",
          "modifiable template purposes",
          "smart card logon capability"
        ],
        "failure_modes": [
          "no_adcs_deployment",
          "restricted_template_permissions",
          "smart_card_auth_disabled"
        ],
        "environmental_factors": [
          "enterprise_ca_available",
          "certificate_services_misconfigured",
          "excessive_user_permissions"
        ],
        "success_probability": 0.82,
        "typical_timeframe": "20-45 minutes"
      },
      {
        "technique": "NetNTLMv2_Capture_and_Crack",
        "success_reason": "Service account with weak password performing automated installs",
        "prerequisite_indicators": [
          "smb_authentication_required",
          "automated_service_processes",
          "weak_password_policies"
        ],
        "recognition_patterns": [
          "service account naming patterns",
          "automated install processes",
          "network authentication attempts",
          "crackable hash complexity"
        ],
        "failure_modes": [
          "strong_password_policy",
          "no_network_authentication",
          "service_account_hardening"
        ],
        "environmental_factors": [
          "automated_deployment_systems",
          "service_account_reuse",
          "insufficient_password_complexity"
        ],
        "success_probability": 0.68,
        "typical_timeframe": "10-25 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Internal hostname from certificate request",
        "discovery_method": "ASP injection code execution in Docker container",
        "why_critical": "Revealed internal infrastructure and attack surface",
        "how_to_recognize": [
          "certificate files in containers",
          "internal domain references",
          "network configuration files"
        ],
        "follow_up_actions": [
          "enumerate_internal_services",
          "test_internal_connectivity",
          "capture_authentication_attempts"
        ]
      },
      {
        "discovery": "Jamovi files with recent access",
        "discovery_method": "SMB enumeration with captured credentials",
        "why_critical": "Provided code execution vector on host system",
        "how_to_recognize": [
          "recently modified statistical files",
          "application-specific file formats",
          "user data directories"
        ],
        "follow_up_actions": [
          "research_file_format_exploits",
          "craft_malicious_payloads",
          "monitor_file_access_patterns"
        ]
      },
      {
        "discovery": "Certificate template with full control permissions",
        "discovery_method": "Active Directory Certificate Services enumeration",
        "why_critical": "Enabled privilege escalation to domain administrator",
        "how_to_recognize": [
          "ADCS deployment indicators",
          "certificate template permissions",
          "smart card authentication support"
        ],
        "follow_up_actions": [
          "modify_template_purposes",
          "generate_admin_certificate",
          "authenticate_with_certificate"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "docker_container_user",
        "escalation_method": "Certificate_Discovery_to_Internal_Access",
        "why_possible": "Certificate request revealed internal hostname and services",
        "recognition_signs": [
          "certificate_files_in_container",
          "internal_domain_references",
          "network_service_configurations"
        ],
        "exploitation_path": "ASP Injection → Container Access → Certificate Discovery → Internal Service Access"
      },
      {
        "privilege_level": "service_account",
        "escalation_method": "Jamovi_File_Exploitation",
        "why_possible": "Statistical software files provided code execution on host",
        "recognition_signs": [
          "recently_accessed_data_files",
          "statistical_software_usage",
          "user_data_directories"
        ],
        "exploitation_path": "NetNTLMv2 Capture → SMB Access → Jamovi Exploitation → Host Access"
      },
      {
        "privilege_level": "domain_user",
        "escalation_method": "Certificate_Template_Modification",
        "why_possible": "Full control permissions on certificate template allowed purpose modification",
        "recognition_signs": [
          "adcs_services_available",
          "certificate_template_permissions",
          "smart_card_authentication_enabled"
        ],
        "exploitation_path": "Template Modification → Smart Card Purpose → Admin Certificate → Domain Admin"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 135,443,445,593 open on Windows host with certificate showing windcorp.htb domain",
        "decision": "Enumerate web application first due to HTTPS on 443 and certificate information",
        "reasoning": "Certificate reveals domain name and web service may provide initial foothold",
        "confidence": 0.85,
        "alternatives": [
          {
            "option": "smb_enumeration",
            "when": "if web enumeration fails"
          },
          {
            "option": "rpc_enumeration",
            "when": "if anonymous access available"
          }
        ],
        "success_indicators": [
          "web_application_accessible",
          "domain_name_discovered",
          "virtual_hosts_found"
        ],
        "next_decision": "analyze_web_application_attack_surface"
      },
      {
        "step": 2,
        "situation": "Found ASP web application with contact form using GET parameters",
        "decision": "Test for ASP injection in form parameters",
        "reasoning": "Classic ASP applications often vulnerable to injection attacks, GET parameters easily testable",
        "confidence": 0.75,
        "prerequisites": [
          "web_form_identified",
          "asp_technology_confirmed"
        ],
        "success_indicators": [
          "code_execution_achieved",
          "error_messages_revealing_info"
        ],
        "failure_fallbacks": [
          "directory_traversal",
          "file_upload_attacks",
          "sql_injection"
        ]
      },
      {
        "step": 3,
        "situation": "Achieved code execution in Docker container",
        "decision": "Search for internal network information and credentials",
        "reasoning": "Docker containers often contain configuration files with internal network details",
        "confidence": 0.9,
        "prerequisites": [
          "code_execution_in_container"
        ],
        "success_indicators": [
          "internal_hostnames_found",
          "certificate_requests_discovered",
          "credentials_located"
        ],
        "next_decision": "pivot_to_internal_network"
      },
      {
        "step": 4,
        "situation": "Found internal hostname from certificate request",
        "decision": "Attempt to capture NetNTLMv2 hash by forcing authentication",
        "reasoning": "Internal web servers often run under service accounts that can be compromised via hash capture",
        "confidence": 0.8,
        "prerequisites": [
          "internal_hostname_known",
          "service_accepts_external_input"
        ],
        "success_indicators": [
          "netntlmv2_hash_captured",
          "hash_successfully_cracked"
        ],
        "failure_fallbacks": [
          "direct_service_exploitation",
          "credential_stuffing"
        ]
      },
      {
        "step": 5,
        "situation": "Obtained domain credentials from cracked NetNTLMv2 hash",
        "decision": "Enumerate SMB shares and look for recently accessed files",
        "reasoning": "Valid domain credentials provide SMB access and recent files indicate active attack vectors",
        "confidence": 0.85,
        "prerequisites": [
          "domain_credentials_obtained",
          "smb_access_available"
        ],
        "success_indicators": [
          "smb_shares_accessible",
          "recently_modified_files_found",
          "exploitable_file_types_discovered"
        ],
        "next_decision": "exploit_file_based_attack_vector"
      },
      {
        "step": 6,
        "situation": "Found Jamovi files with recent access timestamps",
        "decision": "Exploit Jamovi files for code execution",
        "reasoning": "Recently accessed application files suggest active user interaction and potential for exploitation",
        "confidence": 0.7,
        "prerequisites": [
          "jamovi_files_identified",
          "file_modification_possible"
        ],
        "success_indicators": [
          "code_execution_on_host",
          "user_session_compromised"
        ],
        "failure_fallbacks": [
          "other_application_exploits",
          "social_engineering_attacks"
        ]
      },
      {
        "step": 7,
        "situation": "Achieved foothold on Windows host with domain user privileges",
        "decision": "Enumerate certificate templates for privilege escalation",
        "reasoning": "Windows environments with certificates often have misconfigured templates allowing privilege escalation",
        "confidence": 0.75,
        "prerequisites": [
          "domain_user_access",
          "certificate_services_present"
        ],
        "success_indicators": [
          "vulnerable_certificate_template_found",
          "full_control_permissions_identified"
        ],
        "next_decision": "exploit_certificate_template_misconfiguration"
      }
    ],
    "branching_logic": {
      "if_asp_injection_succeeds": {
        "action": "establish_reverse_shell_and_enumerate_container",
        "tools": [
          "aspx_webshell",
          "powershell",
          "certutil"
        ],
        "next_phase": "container_enumeration_and_pivot"
      },
      "if_netntlmv2_captured": {
        "action": "crack_hash_and_authenticate",
        "tools": [
          "hashcat",
          "john",
          "crackmapexec"
        ],
        "next_phase": "smb_enumeration_with_credentials"
      },
      "if_domain_credentials_obtained": {
        "action": "enumerate_smb_and_recent_files",
        "tools": [
          "smbclient",
          "crackmapexec",
          "impacket"
        ],
        "decision_criteria": "focus_on_recently_modified_files"
      },
      "if_certificate_template_vulnerable": {
        "action": "modify_template_and_request_admin_certificate",
        "tools": [
          "PoshADCS",
          "Rubeus",
          "openssl"
        ],
        "next_phase": "kerberos_authentication_with_certificate"
      }
    },
    "optimization_rules": [
      {
        "rule": "prioritize_web_applications_on_windows_hosts",
        "reasoning": "web_applications_often_provide_easier_initial_foothold_than_smb",
        "applicability": "windows_hosts_with_web_services"
      },
      {
        "rule": "always_check_for_certificate_services_privilege_escalation",
        "reasoning": "certificate_template_misconfigurations_common_in_enterprise_environments",
        "applicability": "domain_joined_windows_hosts"
      },
      {
        "rule": "capture_authentication_hashes_when_possible",
        "reasoning": "netntlmv2_hashes_often_crackable_and_provide_domain_access",
        "applicability": "services_that_can_be_forced_to_authenticate"
      },
      {
        "rule": "focus_on_recently_accessed_files_for_exploitation",
        "reasoning": "recent_file_access_indicates_active_users_and_higher_success_probability",
        "applicability": "file_system_access_obtained"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "ASP_Injection",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "asp_application_detected",
          "user_input_reflected",
          "iis_server_present"
        ],
        "success_indicators": [
          "asp_error_messages",
          "code_execution_achieved",
          "server_side_evaluation"
        ],
        "incompatible_with": [
          "input_sanitization_enabled",
          "waf_protection_active",
          "asp_disabled"
        ],
        "confidence_boosters": [
          "save_asp_endpoint_found",
          "get_parameters_processed",
          "legacy_asp_configuration"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "NetNTLMv2_Capture",
        "mitre_id": "T1557.001",
        "required_services": [
          "smb",
          "http"
        ],
        "required_ports": [
          445,
          80,
          443
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "smb_service_accessible",
          "ntlm_authentication_enabled",
          "service_account_present"
        ],
        "success_indicators": [
          "hash_captured_responder",
          "authentication_attempt_logged",
          "service_connects_back"
        ],
        "incompatible_with": [
          "kerberos_only_auth",
          "network_isolation",
          "ntlm_disabled"
        ],
        "confidence_boosters": [
          "automatic_software_installs",
          "service_account_usage",
          "internal_network_access"
        ],
        "typical_success_rate": 0.82,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "Certificate_Template_Abuse",
        "mitre_id": "T1649",
        "required_services": [
          "ldap",
          "rpc"
        ],
        "required_ports": [
          389,
          636,
          135
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_ca_present",
          "certificate_templates_accessible",
          "user_has_template_control"
        ],
        "success_indicators": [
          "template_modification_successful",
          "certificate_issued",
          "smart_card_auth_enabled"
        ],
        "incompatible_with": [
          "ca_not_present",
          "template_permissions_restricted",
          "certificate_enrollment_disabled"
        ],
        "confidence_boosters": [
          "full_control_permissions",
          "legacy_template_configuration",
          "certificate_services_installed"
        ],
        "typical_success_rate": 0.68,
        "estimated_time": "20-45 minutes"
      },
      {
        "technique": "SMB_Enumeration",
        "mitre_id": "T1135",
        "required_services": [
          "smb"
        ],
        "required_ports": [
          445
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "smb_service_running",
          "valid_credentials_available",
          "shares_accessible"
        ],
        "success_indicators": [
          "shares_enumerated",
          "files_accessible",
          "sensitive_data_found"
        ],
        "incompatible_with": [
          "smb_disabled",
          "no_valid_credentials",
          "share_permissions_restricted"
        ],
        "confidence_boosters": [
          "domain_credentials_obtained",
          "service_account_access",
          "default_share_configuration"
        ],
        "typical_success_rate": 0.91,
        "estimated_time": "5-15 minutes"
      }
    ],
    "environmental_detectors": {
      "active_directory": {
        "port_indicators": [
          53,
          88,
          135,
          389,
          445,
          636,
          3268
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns",
          "rpc"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server",
          "domain controller"
        ],
        "confidence_threshold": 0.85
      },
      "iis_web_server": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "Microsoft-IIS",
          "ASP",
          "ASPX"
        ],
        "confidence_threshold": 0.9
      },
      "certificate_services": {
        "port_indicators": [
          135,
          389,
          636
        ],
        "service_indicators": [
          "rpc",
          "ldap"
        ],
        "banner_indicators": [
          "Certificate Services",
          "ADCS"
        ],
        "confidence_threshold": 0.75
      },
      "docker_container": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "Docker",
          "container"
        ],
        "confidence_threshold": 0.7
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "asp_injection",
          "when": "asp_application_detected",
          "reason": "direct_code_execution_potential"
        },
        {
          "attack": "smb_enumeration_with_creds",
          "when": "credentials_obtained_and_smb_detected",
          "reason": "high_success_rate_for_lateral_movement"
        }
      ],
      "medium_priority": [
        {
          "attack": "netntlmv2_capture",
          "when": "internal_services_accessible",
          "reason": "reliable_credential_harvesting"
        },
        {
          "attack": "certificate_template_abuse",
          "when": "ad_ca_detected_and_user_has_permissions",
          "reason": "powerful_privilege_escalation"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "ASP Server-Side Template Injection",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "exploitation",
        "tools_used": [
          {
            "name": "burp_suite",
            "command_template": "Manual request manipulation",
            "actual_command": "GET /save.asp?name=<%=Response.Write(\"testing execution\")%>&email=test&subject=test&message=test",
            "output_pattern": "Server executes ASP code within template",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "feroxbuster",
            "command_template": "feroxbuster -k -u {url} -x asp -w {wordlist}",
            "actual_command": "feroxbuster -k -u https://www.windcorp.htb -x asp -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt",
            "success_factors": [
              "asp_extension_discovery",
              "test_page_found"
            ],
            "effectiveness_rating": 4
          }
        ],
        "prerequisites": [
          "asp_application_identified",
          "user_input_reflected_in_template",
          "insufficient_input_sanitization"
        ],
        "success_indicators": [
          "asp_code_execution_confirmed",
          "server_response_shows_code_output",
          "access_to_test_asp_page"
        ],
        "common_failures": [
          "input_sanitization_blocks_injection",
          "template_engine_restrictions",
          "waf_blocking_payloads"
        ],
        "follow_up_techniques": [
          "command_execution_via_asp",
          "file_system_enumeration",
          "reverse_shell_establishment"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Certificate Analysis for Hostname Discovery",
        "mitre_id": "T1590.001",
        "category": "reconnaissance",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "nmap",
            "command_template": "nmap -p {ports} -sCV -oA {output} {target}",
            "actual_command": "nmap -p 135,443,445,593 -sCV -oA scans/nmap-tcpscripts 10.10.11.102",
            "output_pattern": "Subject: commonName=www.windcorp.htb",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "ssl_certificate_accessible",
          "target_uses_https"
        ],
        "success_indicators": [
          "domain_name_extracted",
          "subject_alternative_names_found",
          "certificate_validity_period_noted"
        ],
        "common_failures": [
          "self_signed_certificates_with_no_useful_info",
          "default_certificates"
        ],
        "follow_up_techniques": [
          "virtual_host_enumeration",
          "subdomain_discovery",
          "certificate_transparency_logs"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Virtual Host Discovery",
        "mitre_id": "T1590.001",
        "category": "reconnaissance",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "wfuzz",
            "command_template": "wfuzz -u https://{ip} -H \"Host: FUZZ.{domain}\" -w {wordlist} --hh {hide_chars}",
            "actual_command": "wfuzz -u https://10.10.11.102 -H \"Host: FUZZ.windcorp.htb\" -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt --hh 315",
            "output_pattern": "200 response with different content length",
            "effectiveness_rating": 4,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "domain_name_known",
          "web_server_responds_to_host_headers"
        ],
        "success_indicators": [
          "additional_vhosts_discovered",
          "different_response_codes_or_lengths",
          "unique_content_found"
        ],
        "common_failures": [
          "no_virtual_hosts_configured",
          "all_vhosts_return_same_content",
          "rate_limiting_blocks_enumeration"
        ],
        "follow_up_techniques": [
          "content_discovery_on_new_vhosts",
          "technology_stack_identification",
          "vulnerability_assessment"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "feroxbuster",
        "use_case": "asp_application_directory_discovery",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "web_application_enumeration"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "include_relevant_file_extensions",
          "use_case_insensitive_wordlists_for_iis",
          "enable_ssl_ignore_for_https"
        ]
      },
      {
        "tool": "crackmapexec",
        "use_case": "smb_domain_enumeration",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "windows_domain_reconnaissance"
        ],
        "alternatives": [
          "smbclient",
          "enum4linux",
          "rpcclient"
        ],
        "best_practices": [
          "always_check_for_null_sessions",
          "note_domain_and_hostname_information",
          "verify_smb_signing_requirements"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "asp_ssti_to_code_execution",
        "steps": [
          {
            "step": 1,
            "command": "feroxbuster -k -u https://www.windcorp.htb -x asp",
            "purpose": "Discover ASP pages and endpoints",
            "expected_output": "test.asp, save.asp, preview.asp discovered"
          },
          {
            "step": 2,
            "command": "Submit form with payload: <%=Response.Write(\"testing execution\")%>",
            "purpose": "Test for server-side template injection",
            "expected_output": "Code execution confirmed in test.asp"
          },
          {
            "step": 3,
            "command": "Escalate to command execution via ASP payload",
            "purpose": "Achieve remote code execution",
            "expected_output": "System command output in web response"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "15-30 minutes"
      },
      {
        "sequence_name": "initial_reconnaissance_windows_target",
        "steps": [
          {
            "step": 1,
            "command": "nmap -p- --min-rate 10000 10.10.11.102",
            "purpose": "Discover open ports",
            "expected_output": "Ports 135,443,445,593,49721 open"
          },
          {
            "step": 2,
            "command": "nmap -p 135,443,445,593 -sCV 10.10.11.102",
            "purpose": "Service enumeration and certificate analysis",
            "expected_output": "Domain windcorp.htb discovered in certificate"
          },
          {
            "step": 3,
            "command": "crackmapexec smb 10.10.11.102",
            "purpose": "SMB and domain enumeration",
            "expected_output": "Hostname EARTH, domain windcorp.htb confirmed"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "10-15 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Anubis",
      "difficulty": "Insane",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2021-08-14",
      "author": "4ndr34z",
      "estimated_time": "4-6 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "asp_injection",
        "certificate_abuse",
        "ntlm_relay"
      ],
      "key_vulnerabilities": [
        "code_injection",
        "certificate_template_misconfiguration",
        "netntlmv2_capture"
      ],
      "environment_type": "corporate_windows_domain",
      "real_world_relevance": "very_high",
      "learning_value": [
        "certificate_attacks",
        "docker_container_escape",
        "jamovi_exploitation",
        "pki_abuse"
      ],
      "prerequisite_knowledge": [
        "advanced_windows_security",
        "certificate_services",
        "docker_concepts",
        "ntlm_authentication"
      ]
    },
    "categorization": {
      "primary_category": "certificate_attacks",
      "subcategories": [
        "code_injection",
        "container_exploitation",
        "pki_abuse"
      ],
      "attack_types": [
        "initial_access",
        "credential_access",
        "privilege_escalation",
        "lateral_movement"
      ],
      "defensive_lessons": [
        "secure_certificate_templates",
        "container_hardening",
        "input_validation",
        "smb_security"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Escape",
        "Authority",
        "Certified"
      ],
      "similarity_reasons": [
        "certificate_abuse",
        "ntlm_attacks",
        "windows_domain_environment"
      ],
      "unique_aspects": [
        "docker_container_pivot",
        "jamovi_file_exploitation",
        "asp_injection_entry"
      ],
      "difficulty_factors": [
        "multi_stage_attack_chain",
        "certificate_template_manipulation",
        "container_to_host_escalation"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T21:14:37.715638",
    "original_file": "0xdf_writeups/Htb Anubis.md",
    "content_length": 83794,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}