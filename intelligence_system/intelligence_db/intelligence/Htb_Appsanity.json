{
  "writeup_id": "Htb_Appsanity",
  "scenario_fingerprint": {
    "scenario_name": "windows_web_jwt_privilege_escalation",
    "primary_services": [
      "http",
      "https",
      "winrm"
    ],
    "port_signature": "80+443+5985",
    "service_combination": "iis+winrm",
    "os_family": "windows_server",
    "environment_type": "web_application",
    "entry_vector": "jwt_shared_secret",
    "privilege_path": "web_user_to_administrator",
    "attack_complexity": "hard",
    "estimated_time": "3-4 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "shared_jwt_secret_between_sites",
      "hidden_input_privilege_escalation",
      "ssrf_with_file_upload",
      "dll_hijacking_privilege_escalation"
    ],
    "environmental_clues": [
      "multiple_subdomains_same_host",
      "aspnet_core_application",
      "medical_themed_application",
      "user_registration_available"
    ],
    "similar_scenarios": [
      "json_htb_medium",
      "worker_htb_medium"
    ],
    "unique_aspects": [
      "jwt_cross_site_authentication",
      "pdf_upload_webshell_bypass",
      "registry_credential_extraction",
      "cpp_binary_reverse_engineering"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "JWT_Secret_Reuse",
        "success_reason": "Two websites shared the same JWT signing secret",
        "prerequisite_indicators": [
          "multiple_web_applications",
          "jwt_authentication_present",
          "shared_infrastructure"
        ],
        "recognition_patterns": [
          "same JWT issuer across domains",
          "identical JWT structure/claims",
          "cross-domain cookie acceptance"
        ],
        "failure_modes": [
          "unique_jwt_secrets_per_app",
          "jwt_signature_verification",
          "domain_isolation"
        ],
        "environmental_factors": [
          "shared_development_environment",
          "copy_paste_configuration",
          "insufficient_secret_management"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-30 minutes"
      },
      {
        "technique": "Hidden_Input_Privilege_Escalation",
        "success_reason": "Client-side role assignment through hidden form fields",
        "prerequisite_indicators": [
          "registration_forms_present",
          "role_based_access_control",
          "client_side_validation_only"
        ],
        "recognition_patterns": [
          "hidden input fields in forms",
          "role/privilege parameters",
          "lack of server-side validation"
        ],
        "failure_modes": [
          "server_side_role_validation",
          "role_assignment_restrictions",
          "proper_authorization_checks"
        ],
        "environmental_factors": [
          "rapid_development_practices",
          "insufficient_security_review",
          "client_side_trust_model"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "15-45 minutes"
      },
      {
        "technique": "SSRF_to_Internal_Services",
        "success_reason": "Server-side request forgery allowed access to internal management interfaces",
        "prerequisite_indicators": [
          "url_parameter_processing",
          "external_resource_fetching",
          "internal_network_services"
        ],
        "recognition_patterns": [
          "URL parameters in requests",
          "localhost/internal IP responses",
          "different response patterns"
        ],
        "failure_modes": [
          "url_validation_whitelist",
          "network_segmentation",
          "internal_service_authentication"
        ],
        "environmental_factors": [
          "internal_management_interfaces",
          "lack_of_network_isolation",
          "permissive_firewall_rules"
        ],
        "success_probability": 0.7,
        "typical_timeframe": "20-60 minutes"
      },
      {
        "technique": "File_Upload_Filter_Bypass",
        "success_reason": "PDF upload functionality bypassed to upload webshell",
        "prerequisite_indicators": [
          "file_upload_functionality",
          "weak_file_type_validation",
          "web_accessible_upload_directory"
        ],
        "recognition_patterns": [
          "file extension filtering only",
          "MIME type validation bypass",
          "executable file upload success"
        ],
        "failure_modes": [
          "strict_file_type_validation",
          "file_content_scanning",
          "non_executable_upload_directory"
        ],
        "environmental_factors": [
          "business_requirement_for_uploads",
          "insufficient_input_validation",
          "web_server_file_execution"
        ],
        "success_probability": 0.6,
        "typical_timeframe": "30-90 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Shared JWT secret between applications",
        "discovery_method": "JWT token analysis and cross-domain testing",
        "why_critical": "Enabled privilege escalation from one app to another",
        "how_to_recognize": [
          "identical JWT structure across domains",
          "same issuer/audience claims",
          "successful token reuse"
        ],
        "follow_up_actions": [
          "test_token_on_other_domains",
          "analyze_jwt_claims_structure",
          "attempt_privilege_escalation"
        ]
      },
      {
        "discovery": "Hidden role assignment in registration form",
        "discovery_method": "HTML source inspection and form manipulation",
        "why_critical": "Direct path to elevated privileges without authentication bypass",
        "how_to_recognize": [
          "hidden input fields with role/privilege names",
          "client-side role assignment",
          "lack of server-side validation"
        ],
        "follow_up_actions": [
          "modify_hidden_field_values",
          "test_elevated_functionality",
          "enumerate_available_roles"
        ]
      },
      {
        "discovery": "Internal management interface via SSRF",
        "discovery_method": "SSRF parameter testing with localhost URLs",
        "why_critical": "Provided access to administrative functions and code execution",
        "how_to_recognize": [
          "URL parameters accepting external resources",
          "different responses for internal IPs",
          "management interface discovery"
        ],
        "follow_up_actions": [
          "enumerate_internal_services",
          "test_management_functions",
          "attempt_code_execution"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "authenticated_user",
        "escalation_method": "JWT_reuse_with_elevated_role",
        "why_possible": "Shared JWT secret and client-side role assignment",
        "recognition_signs": [
          "multiple_web_applications",
          "jwt_authentication_mechanism",
          "role_based_access_differences"
        ],
        "exploitation_path": "Register account → Modify hidden role field → Use JWT on second application"
      },
      {
        "privilege_level": "web_application_user",
        "escalation_method": "SSRF_to_RCE",
        "why_possible": "SSRF access to internal management interface with code execution",
        "recognition_signs": [
          "ssrf_vulnerability_present",
          "internal_management_interfaces",
          "administrative_functions_available"
        ],
        "exploitation_path": "SSRF discovery → Internal service enumeration → Management interface → Code execution"
      },
      {
        "privilege_level": "web_shell_access",
        "escalation_method": "Credential_extraction_and_service_abuse",
        "why_possible": "Application credentials stored in accessible locations",
        "recognition_signs": [
          "dotnet_application_structure",
          "registry_credential_storage",
          "service_account_usage"
        ],
        "exploitation_path": "Web shell → Credential extraction → Service authentication → System access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 80,443,5985 open on Windows host with IIS",
        "decision": "Enumerate web applications and identify technology stack",
        "reasoning": "Multiple web ports suggest web application focus, WinRM indicates potential Windows domain",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "winrm_enumeration",
            "when": "if credentials obtained"
          },
          {
            "option": "certificate_analysis",
            "when": "for additional hostnames"
          }
        ],
        "success_indicators": [
          "web_applications_identified",
          "subdomains_discovered",
          "technology_stack_determined"
        ],
        "next_decision": "analyze_web_applications"
      },
      {
        "step": 2,
        "situation": "Discovered two ASP.NET sites sharing JWT infrastructure",
        "decision": "Test for JWT secret reuse between applications",
        "reasoning": "Same issuer 'MedDigi' suggests shared authentication infrastructure",
        "confidence": 0.85,
        "prerequisites": [
          "jwt_token_obtained",
          "multiple_applications_identified"
        ],
        "success_indicators": [
          "jwt_accepted_across_applications"
        ],
        "failure_fallbacks": [
          "privilege_escalation_via_hidden_inputs",
          "application_specific_vulnerabilities"
        ]
      },
      {
        "step": 3,
        "situation": "JWT token works across applications, need elevated privileges",
        "decision": "Exploit hidden input vulnerability to escalate role",
        "reasoning": "Hidden form fields often control authorization without proper server-side validation",
        "confidence": 0.75,
        "prerequisites": [
          "form_with_hidden_inputs_found",
          "role_based_access_identified"
        ],
        "success_indicators": [
          "elevated_role_obtained",
          "doctor_privileges_gained"
        ],
        "next_decision": "leverage_elevated_access"
      },
      {
        "step": 4,
        "situation": "Obtained doctor role access on portal application",
        "decision": "Enumerate file upload and SSRF capabilities",
        "reasoning": "Medical portals often have document upload features that can be exploited",
        "confidence": 0.8,
        "prerequisites": [
          "doctor_access_confirmed",
          "portal_functionality_mapped"
        ],
        "success_indicators": [
          "file_upload_found",
          "ssrf_vulnerability_identified"
        ],
        "next_decision": "exploit_file_upload_and_ssrf"
      }
    ],
    "branching_logic": {
      "if_jwt_reuse_succeeds": {
        "action": "escalate_privileges_via_hidden_inputs",
        "tools": [
          "burp_suite",
          "browser_dev_tools"
        ],
        "next_phase": "application_exploitation"
      },
      "if_file_upload_available": {
        "action": "bypass_filters_and_upload_webshell",
        "alternatives": [
          "pdf_upload_with_embedded_payload",
          "extension_bypass_techniques"
        ],
        "decision_criteria": "based_on_file_type_restrictions"
      },
      "if_ssrf_identified": {
        "action": "enumerate_internal_services",
        "purpose": "find_internal_management_interfaces",
        "tools": [
          "burp_collaborator",
          "custom_payloads"
        ]
      },
      "if_webshell_uploaded": {
        "action": "combine_with_ssrf_for_execution",
        "reasoning": "ssrf_can_trigger_webshell_execution",
        "next_phase": "initial_access_obtained"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_test_jwt_reuse_in_multi_application_environments",
        "reasoning": "shared_authentication_infrastructure_common_vulnerability",
        "applicability": "multiple_web_applications_same_domain"
      },
      {
        "rule": "check_hidden_form_inputs_for_privilege_escalation",
        "reasoning": "client_side_authorization_controls_often_bypassable",
        "applicability": "role_based_web_applications"
      },
      {
        "rule": "combine_file_upload_with_ssrf_for_execution",
        "reasoning": "ssrf_can_access_uploaded_files_internally",
        "applicability": "both_vulnerabilities_present"
      },
      {
        "rule": "enumerate_dotnet_applications_for_credential_storage",
        "reasoning": "registry_and_config_files_common_credential_locations",
        "applicability": "dotnet_application_access_obtained"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "JWT Secret Reuse",
        "mitre_id": "T1550.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "multiple_web_applications",
          "jwt_authentication_enabled",
          "shared_jwt_secret_between_apps"
        ],
        "success_indicators": [
          "jwt_token_accepted_across_domains",
          "cross_application_authentication",
          "shared_secret_validation"
        ],
        "incompatible_with": [
          "unique_jwt_secrets_per_app",
          "jwt_disabled",
          "certificate_based_jwt"
        ],
        "confidence_boosters": [
          "same_organization_multiple_apps",
          "shared_infrastructure",
          "default_jwt_configurations"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "Hidden Input Manipulation",
        "mitre_id": "T1565.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_application_with_forms",
          "hidden_input_fields_present",
          "client_side_privilege_validation"
        ],
        "success_indicators": [
          "hidden_fields_in_html_source",
          "role_based_hidden_inputs",
          "privilege_escalation_successful"
        ],
        "incompatible_with": [
          "server_side_validation_only",
          "no_hidden_inputs",
          "encrypted_form_data"
        ],
        "confidence_boosters": [
          "role_selection_forms",
          "registration_forms",
          "legacy_web_applications"
        ],
        "typical_success_rate": 0.45,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "SSRF via File Upload",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "file_upload_functionality",
          "pdf_processing_enabled",
          "internal_network_accessible"
        ],
        "success_indicators": [
          "file_upload_forms_present",
          "pdf_mime_type_accepted",
          "internal_services_reachable"
        ],
        "incompatible_with": [
          "no_file_upload",
          "strict_file_validation",
          "network_segmentation"
        ],
        "confidence_boosters": [
          "document_processing_features",
          "pdf_generation_services",
          "weak_file_type_validation"
        ],
        "typical_success_rate": 0.55,
        "estimated_time": "20-45 minutes"
      },
      {
        "technique": "DLL Hijacking",
        "mitre_id": "T1574.001",
        "required_services": [
          "any"
        ],
        "required_ports": [],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "windows_environment",
          "writable_dll_search_path",
          "application_loads_dlls_dynamically"
        ],
        "success_indicators": [
          "procmon_shows_dll_search_order",
          "writable_directories_in_path",
          "missing_dll_errors"
        ],
        "incompatible_with": [
          "dll_signing_enforced",
          "restricted_write_permissions",
          "static_dll_loading"
        ],
        "confidence_boosters": [
          "legacy_applications",
          "custom_cpp_binaries",
          "service_applications"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "30-60 minutes"
      }
    ],
    "environmental_detectors": {
      "iis_web_server": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "Microsoft-IIS",
          "ASP.NET"
        ],
        "confidence_threshold": 0.9
      },
      "aspnet_application": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          ".AspNetCore",
          "mvc",
          "razor"
        ],
        "confidence_threshold": 0.85
      },
      "winrm_service": {
        "port_indicators": [
          5985,
          5986
        ],
        "service_indicators": [
          "wsman",
          "winrm"
        ],
        "banner_indicators": [
          "Microsoft-HTTPAPI"
        ],
        "confidence_threshold": 0.95
      },
      "jwt_authentication": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "jwt",
          "bearer",
          "authorization"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "subdomain_enumeration",
          "when": "multiple_vhosts_detected",
          "reason": "often_reveals_additional_attack_surface"
        },
        {
          "attack": "jwt_secret_reuse",
          "when": "multiple_jwt_apps_detected",
          "reason": "common_misconfiguration_easy_lateral_movement"
        },
        {
          "attack": "hidden_input_manipulation",
          "when": "registration_forms_detected",
          "reason": "quick_privilege_escalation_opportunity"
        }
      ],
      "medium_priority": [
        {
          "attack": "file_upload_testing",
          "when": "upload_functionality_detected",
          "reason": "potential_webshell_or_ssrf_vector"
        },
        {
          "attack": "dll_hijacking",
          "when": "windows_shell_obtained",
          "reason": "reliable_privilege_escalation_method"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Hidden Field Manipulation",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "Burp Suite",
            "command_template": "Intercept POST request and modify Acctype parameter",
            "actual_command": "Change Acctype=1 to Acctype=2 in registration request",
            "output_pattern": "Elevated privileges in JWT token",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "web_application_with_hidden_fields",
          "client_side_privilege_determination",
          "intercepting_proxy_available"
        ],
        "success_indicators": [
          "account_created_with_elevated_privileges",
          "jwt_contains_doctor_role",
          "access_to_restricted_functionality"
        ],
        "common_failures": [
          "server_side_validation_present",
          "hidden_field_values_validated",
          "privilege_escalation_detected"
        ],
        "follow_up_techniques": [
          "jwt_token_reuse",
          "cross_site_authentication",
          "privilege_abuse"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "JWT Secret Reuse",
        "mitre_id": "T1550.001",
        "category": "defense_evasion",
        "phase": "lateral_movement",
        "tools_used": [
          {
            "name": "Browser Developer Tools",
            "command_template": "Copy JWT from site A to site B cookies",
            "actual_command": "Copy access_token from meddigi.htb to portal.meddigi.htb",
            "output_pattern": "Successful authentication on second site",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "multiple_applications_sharing_jwt_secret",
          "valid_jwt_token_obtained",
          "same_domain_or_subdomain_structure"
        ],
        "success_indicators": [
          "authentication_successful_on_target_site",
          "access_to_restricted_areas",
          "elevated_privileges_maintained"
        ],
        "common_failures": [
          "different_jwt_secrets_used",
          "audience_validation_implemented",
          "token_binding_mechanisms"
        ],
        "follow_up_techniques": [
          "server_side_request_forgery",
          "file_upload_exploitation",
          "internal_service_enumeration"
        ],
        "time_investment": "1-2 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Server-Side Request Forgery",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "exploitation",
        "tools_used": [
          {
            "name": "Burp Suite",
            "command_template": "Modify request parameter to target internal services",
            "actual_command": "Change URL parameter to http://127.0.0.1:8080/ExamPanel",
            "output_pattern": "Internal service response or error messages",
            "effectiveness_rating": 4,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "application_makes_server_side_requests",
          "user_controlled_url_parameter",
          "insufficient_input_validation"
        ],
        "success_indicators": [
          "internal_services_accessible",
          "port_scanning_successful",
          "internal_application_discovery"
        ],
        "common_failures": [
          "url_validation_implemented",
          "network_segmentation_blocks_requests",
          "allowlist_filtering_active"
        ],
        "follow_up_techniques": [
          "internal_service_exploitation",
          "credential_harvesting",
          "reverse_shell_execution"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "File Upload Filter Bypass",
        "mitre_id": "T1105",
        "category": "command_and_control",
        "phase": "exploitation",
        "tools_used": [
          {
            "name": "Custom Webshell",
            "command_template": "Create malicious file with allowed extension",
            "actual_command": "Upload .aspx webshell disguised as PDF",
            "output_pattern": "File uploaded successfully to web directory",
            "effectiveness_rating": 4,
            "reliability": 0.8
          },
          {
            "name": "Content-Type Manipulation",
            "command_template": "Modify Content-Type header to bypass filters",
            "actual_command": "Set Content-Type: application/pdf for .aspx file",
            "output_pattern": "Upload validation bypassed",
            "effectiveness_rating": 3,
            "reliability": 0.7
          }
        ],
        "prerequisites": [
          "file_upload_functionality_available",
          "weak_file_type_validation",
          "web_accessible_upload_directory"
        ],
        "success_indicators": [
          "malicious_file_uploaded_successfully",
          "webshell_accessible_via_http",
          "code_execution_achieved"
        ],
        "common_failures": [
          "strong_file_validation_present",
          "uploaded_files_not_executable",
          "upload_directory_not_web_accessible"
        ],
        "follow_up_techniques": [
          "webshell_command_execution",
          "reverse_shell_establishment",
          "system_enumeration"
        ],
        "time_investment": "15-45 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Registry Credential Extraction",
        "mitre_id": "T1552.002",
        "category": "credential_access",
        "phase": "credential_access",
        "tools_used": [
          {
            "name": "reg.exe",
            "command_template": "reg query {registry_path}",
            "actual_command": "reg query HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
            "output_pattern": "Registry values containing credentials",
            "effectiveness_rating": 4,
            "reliability": 0.9
          },
          {
            "name": "PowerShell",
            "command_template": "Get-ItemProperty -Path {registry_path}",
            "actual_command": "Get-ItemProperty -Path 'HKLM:\\SOFTWARE\\Application'",
            "output_pattern": "Credential values in registry keys",
            "effectiveness_rating": 4,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "system_access_obtained",
          "credentials_stored_in_registry",
          "registry_read_permissions"
        ],
        "success_indicators": [
          "credentials_found_in_registry",
          "successful_authentication_with_extracted_creds",
          "privilege_escalation_achieved"
        ],
        "common_failures": [
          "credentials_encrypted_in_registry",
          "insufficient_registry_permissions",
          "credentials_not_stored_in_registry"
        ],
        "follow_up_techniques": [
          "credential_spraying",
          "lateral_movement",
          "privilege_escalation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "DLL Hijacking",
        "mitre_id": "T1574.001",
        "category": "privilege_escalation",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "ProcMon",
            "command_template": "Monitor file system access for missing DLLs",
            "actual_command": "Filter for 'NAME NOT FOUND' and .dll extensions",
            "output_pattern": "Missing DLL files in writable locations",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "Ghidra",
            "command_template": "Reverse engineer binary to understand DLL loading",
            "actual_command": "Analyze C++ binary for LoadLibrary calls",
            "output_pattern": "DLL loading patterns and search paths",
            "effectiveness_rating": 4,
            "reliability": 0.85
          },
          {
            "name": "x64dbg",
            "command_template": "Dynamic analysis of DLL loading behavior",
            "actual_command": "Set breakpoints on LoadLibrary functions",
            "output_pattern": "Runtime DLL loading behavior",
            "effectiveness_rating": 4,
            "reliability": 0.8
          }
        ],
        "prerequisites": [
          "privileged_application_available",
          "writable_location_in_dll_search_path",
          "ability_to_trigger_application_execution"
        ],
        "success_indicators": [
          "malicious_dll_loaded_successfully",
          "code_execution_as_privileged_user",
          "administrator_shell_obtained"
        ],
        "common_failures": [
          "dll_search_path_secured",
          "application_uses_full_dll_paths",
          "dll_signature_verification_enabled"
        ],
        "follow_up_techniques": [
          "persistence_establishment",
          "credential_dumping",
          "lateral_movement"
        ],
        "time_investment": "30-120 minutes",
        "skill_level": "advanced"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Burp Suite",
        "use_case": "web_application_testing",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "medium",
        "essential_for": [
          "web_application_penetration_testing"
        ],
        "alternatives": [
          "OWASP ZAP",
          "manual_browser_tools"
        ],
        "best_practices": [
          "always_intercept_registration_requests",
          "check_for_hidden_form_fields",
          "validate_client_side_restrictions"
        ]
      },
      {
        "tool": "ProcMon",
        "use_case": "dll_hijacking_identification",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "windows_privilege_escalation"
        ],
        "alternatives": [
          "Process Hacker",
          "API Monitor"
        ],
        "best_practices": [
          "filter_for_name_not_found_results",
          "focus_on_dll_extensions",
          "check_writable_locations_first"
        ]
      },
      {
        "tool": "Ghidra",
        "use_case": "binary_reverse_engineering",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "high",
        "essential_for": [
          "advanced_binary_analysis"
        ],
        "alternatives": [
          "IDA Pro",
          "x64dbg",
          "Radare2"
        ],
        "best_practices": [
          "start_with_string_analysis",
          "identify_api_calls_first",
          "use_dynamic_analysis_to_complement"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "hidden_field_to_jwt_reuse",
        "steps": [
          {
            "step": 1,
            "command": "Intercept registration POST and change Acctype=1 to Acctype=2",
            "purpose": "Elevate account privileges during registration",
            "expected_output": "Account created with doctor privileges"
          },
          {
            "step": 2,
            "command": "Login and extract JWT access_token from cookies",
            "purpose": "Obtain elevated privilege JWT token",
            "expected_output": "JWT with doctor role claims"
          },
          {
            "step": 3,
            "command": "Copy access_token to portal.meddigi.htb cookies",
            "purpose": "Reuse JWT on second application",
            "expected_output": "Successful authentication on portal site"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "5-10 minutes"
      },
      {
        "sequence_name": "ssrf_to_webshell_upload",
        "steps": [
          {
            "step": 1,
            "command": "Use SSRF to scan internal services: http://127.0.0.1:8080/",
            "purpose": "Discover internal management interface",
            "expected_output": "Internal application discovery"
          },
          {
            "step": 2,
            "command": "Upload .aspx webshell with Content-Type: application/pdf",
            "purpose": "Bypass file upload restrictions",
            "expected_output": "Webshell uploaded successfully"
          },
          {
            "step": 3,
            "command": "Use SSRF to trigger webshell execution via internal interface",
            "purpose": "Execute uploaded webshell",
            "expected_output": "Code execution achieved"
          }
        ],
        "success_rate": 0.78,
        "typical_duration": "20-45 minutes"
      },
      {
        "sequence_name": "registry_creds_to_privilege_escalation",
        "steps": [
          {
            "step": 1,
            "command": "reg query HKLM\\SOFTWARE\\{application_path}",
            "purpose": "Extract credentials from registry",
            "expected_output": "Password found in registry values"
          },
          {
            "step": 2,
            "command": "Use extracted credentials for authentication",
            "purpose": "Authenticate as different user",
            "expected_output": "Shell as new user account"
          },
          {
            "step": 3,
            "command": "Run ProcMon to identify DLL hijacking opportunities",
            "purpose": "Find privilege escalation path",
            "expected_output": "Missing DLL in writable location identified"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "15-30 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Appsanity",
      "difficulty": "Hard",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2023-10-28",
      "author": "xRogue",
      "estimated_time": "4-6 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "web_application",
        "jwt_manipulation",
        "ssrf",
        "dll_hijacking"
      ],
      "key_vulnerabilities": [
        "jwt_secret_reuse",
        "hidden_input_manipulation",
        "file_upload_bypass",
        "dll_sideloading"
      ],
      "environment_type": "web_application_server",
      "real_world_relevance": "very_high",
      "learning_value": [
        "jwt_attacks",
        "ssrf_exploitation",
        "reverse_engineering",
        "dll_hijacking"
      ],
      "prerequisite_knowledge": [
        "web_security",
        "jwt_tokens",
        "reverse_engineering",
        "windows_internals"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "jwt_attacks",
        "ssrf",
        "file_upload",
        "reverse_engineering",
        "dll_hijacking"
      ],
      "attack_types": [
        "privilege_escalation",
        "code_execution",
        "authentication_bypass"
      ],
      "defensive_lessons": [
        "jwt_secret_management",
        "input_validation",
        "file_upload_restrictions",
        "dll_loading_security"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Acute",
        "StreamIO",
        "Scrambled"
      ],
      "similarity_reasons": [
        "windows_web_apps",
        "multi_stage_exploitation",
        "reverse_engineering_required"
      ],
      "unique_aspects": [
        "jwt_cross_site_reuse",
        "procmon_analysis",
        "ghidra_reversing"
      ],
      "difficulty_factors": [
        "complex_attack_chain",
        "reverse_engineering_skills",
        "multiple_exploitation_phases"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T19:51:43.334835",
    "original_file": "0xdf_writeups/Htb Appsanity.md",
    "content_length": 66245,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}