{
  "writeup_id": "Htb_Sherlock_Noted",
  "scenario_fingerprint": {
    "scenario_name": "windows_insider_threat_data_exfiltration",
    "primary_services": [
      "file_system",
      "notepad_plus_plus",
      "local_access"
    ],
    "port_signature": "physical_access",
    "service_combination": "local_file_access+text_editor+backup_artifacts",
    "os_family": "windows_workstation",
    "environment_type": "corporate_developer_workstation",
    "entry_vector": "physical_access_or_insider_threat",
    "privilege_path": "user_level_to_data_exfiltration",
    "attack_complexity": "easy",
    "estimated_time": "30-45 minutes",
    "scenario_confidence": 0.9,
    "distinguishing_factors": [
      "notepad_plus_plus_artifacts",
      "backup_file_recovery",
      "java_compilation_on_target",
      "extortion_note_creation"
    ],
    "environmental_clues": [
      "appdata_roaming_notepad_artifacts",
      "session_xml_file_history",
      "config_xml_recent_files",
      "backup_folder_contents"
    ],
    "similar_scenarios": [
      "dfir_forensics_challenges",
      "insider_threat_investigations"
    ],
    "unique_aspects": [
      "notepad_plus_plus_forensics",
      "java_source_code_exfiltration",
      "crypto_wallet_extortion",
      "developer_workstation_targeting"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Physical Access Exploitation",
        "success_reason": "Attacker gained hands-on keyboard access to developer workstation",
        "prerequisite_indicators": [
          "physical_access_available",
          "unattended_workstation",
          "developer_environment_present"
        ],
        "recognition_patterns": [
          "direct file system access",
          "use of installed development tools",
          "compilation on target system"
        ],
        "failure_modes": [
          "workstation_locked",
          "physical_security_controls",
          "user_present_at_workstation"
        ],
        "environmental_factors": [
          "developer_workstation_with_tools",
          "insufficient_physical_security",
          "unmonitored_workspace"
        ],
        "success_probability": 0.95,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "Living Off The Land",
        "success_reason": "Used victim's Notepad++ and Java compiler instead of bringing external tools",
        "prerequisite_indicators": [
          "development_environment_available",
          "java_compiler_installed",
          "text_editor_present"
        ],
        "recognition_patterns": [
          "compilation artifacts on system",
          "use of legitimate system tools",
          "notepad++ backup files created"
        ],
        "failure_modes": [
          "no_development_tools_available",
          "restricted_execution_policies",
          "application_whitelisting"
        ],
        "environmental_factors": [
          "software_engineer_workstation",
          "full_development_stack_available",
          "unrestricted_compilation_rights"
        ],
        "success_probability": 0.88,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Data Exfiltration via Archive",
        "success_reason": "Successfully collected and compressed sensitive files for extraction",
        "prerequisite_indicators": [
          "file_system_access",
          "compression_utilities_available",
          "sensitive_data_accessible"
        ],
        "recognition_patterns": [
          "archive creation activities",
          "file enumeration patterns",
          "data staging behaviors"
        ],
        "failure_modes": [
          "file_permissions_restrictions",
          "dlp_solutions_active",
          "insufficient_storage_space"
        ],
        "environmental_factors": [
          "sensitive_files_unencrypted",
          "no_data_loss_prevention",
          "unrestricted_file_access"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "5-15 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Notepad++ backup artifacts",
        "discovery_method": "AppData forensic analysis",
        "why_critical": "Preserved complete attack timeline and malicious code",
        "how_to_recognize": [
          "backup files in notepad++ directory",
          "session.xml with file timestamps",
          "config.xml with file history"
        ],
        "follow_up_actions": [
          "analyze_backup_file_contents",
          "reconstruct_attack_timeline",
          "identify_exfiltrated_data"
        ]
      },
      {
        "discovery": "LootAndPurge.java source code",
        "discovery_method": "Notepad++ backup file analysis",
        "why_critical": "Reveals complete attack methodology and data collection strategy",
        "how_to_recognize": [
          "java source files in backup",
          "file enumeration logic",
          "archive creation code"
        ],
        "follow_up_actions": [
          "analyze_targeted_file_types",
          "identify_exfiltration_methods",
          "trace_compiled_executable"
        ]
      },
      {
        "discovery": "Extortion note with contact details",
        "discovery_method": "Backup file content analysis",
        "why_critical": "Contains attacker contact information and payment demands",
        "how_to_recognize": [
          "ransom note text patterns",
          "cryptocurrency wallet addresses",
          "contact email addresses"
        ],
        "follow_up_actions": [
          "extract_payment_details",
          "identify_communication_channels",
          "analyze_threat_actor_opsec"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "physical_access",
        "escalation_method": "developer_environment_abuse",
        "why_possible": "Full development environment with compilation capabilities available",
        "recognition_signs": [
          "java_compiler_available",
          "unrestricted_file_system_access",
          "development_tools_present"
        ],
        "exploitation_path": "Physical Access → Code Compilation → Data Collection → Exfiltration"
      },
      {
        "privilege_level": "user_context",
        "escalation_method": "sensitive_data_access",
        "why_possible": "Developer workstation contained unprotected sensitive files",
        "recognition_signs": [
          "internal_development_plans_accessible",
          "application_codebases_unencrypted",
          "aws_scripts_available"
        ],
        "exploitation_path": "User Access → File Enumeration → Data Staging → Archive Creation"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found Notepad++ artifacts during DFIR investigation",
        "decision": "Analyze session.xml and config.xml for file history and active sessions",
        "reasoning": "These files contain comprehensive history of opened files and current state",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "backup_file_analysis",
            "when": "if session files corrupted"
          },
          {
            "option": "registry_analysis",
            "when": "if notepad artifacts insufficient"
          }
        ],
        "success_indicators": [
          "file_paths_discovered",
          "backup_locations_identified",
          "modification_timestamps_found"
        ],
        "next_decision": "extract_backup_file_contents"
      },
      {
        "step": 2,
        "situation": "Discovered Java malware source code in backup files",
        "decision": "Analyze LootAndPurge.java for data exfiltration methodology",
        "reasoning": "Source code reveals complete attack methodology and IOCs",
        "confidence": 0.9,
        "prerequisites": [
          "backup_files_accessible",
          "java_source_identified"
        ],
        "success_indicators": [
          "zip_filename_found",
          "password_extracted",
          "target_extensions_identified"
        ],
        "failure_fallbacks": [
          "memory_dump_analysis",
          "filesystem_timeline_analysis"
        ]
      },
      {
        "step": 3,
        "situation": "Found extortion note in backup files",
        "decision": "Extract contact information and payment details from ransom note",
        "reasoning": "Critical for incident response and threat actor communication",
        "confidence": 0.85,
        "prerequisites": [
          "ransom_note_accessible"
        ],
        "success_indicators": [
          "crypto_wallet_found",
          "contact_email_extracted"
        ],
        "failure_fallbacks": [
          "network_traffic_analysis",
          "external_communication_review"
        ]
      }
    ],
    "branching_logic": {
      "if_session_xml_available": {
        "action": "parse_file_metadata_and_timestamps",
        "tools": [
          "text_editor",
          "timestamp_converter"
        ],
        "next_phase": "backup_file_recovery"
      },
      "if_java_source_found": {
        "action": "reverse_engineer_malware_functionality",
        "purpose": "understand_data_collection_and_exfiltration",
        "tools": [
          "static_analysis",
          "code_review"
        ]
      },
      "if_backup_files_corrupted": {
        "action": "attempt_file_recovery",
        "alternatives": [
          "filesystem_carving",
          "shadow_copy_analysis"
        ],
        "decision_criteria": "based_on_file_system_integrity"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_check_application_backup_folders_first",
        "reasoning": "backup_files_often_contain_deleted_or_modified_content",
        "applicability": "text_editor_and_ide_investigations"
      },
      {
        "rule": "convert_proprietary_timestamps_immediately",
        "reasoning": "critical_for_timeline_establishment_and_correlation",
        "applicability": "windows_application_artifacts"
      },
      {
        "rule": "analyze_source_code_for_complete_attack_chain",
        "reasoning": "reveals_full_methodology_and_additional_iocs",
        "applicability": "when_malware_source_code_available"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Notepad++ Artifact Analysis",
        "mitre_id": "T1005",
        "required_services": [
          "file_system"
        ],
        "required_ports": [],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "notepad_plus_plus_installed",
          "appdata_roaming_accessible",
          "backup_files_enabled"
        ],
        "success_indicators": [
          "config_xml_exists",
          "session_xml_exists",
          "backup_folder_present",
          "file_history_available"
        ],
        "incompatible_with": [
          "notepad_plus_plus_not_installed",
          "appdata_encrypted",
          "backup_disabled"
        ],
        "confidence_boosters": [
          "recent_file_modifications",
          "suspicious_file_extensions",
          "backup_timestamp_patterns"
        ],
        "typical_success_rate": 0.92,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "File History Enumeration",
        "mitre_id": "T1083",
        "required_services": [
          "file_system"
        ],
        "required_ports": [],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "text_editor_artifacts_present",
          "user_profile_accessible",
          "file_system_readable"
        ],
        "success_indicators": [
          "xml_config_files_readable",
          "backup_files_recoverable",
          "timestamp_data_available"
        ],
        "incompatible_with": [
          "file_system_encrypted",
          "artifacts_deleted",
          "permissions_restricted"
        ],
        "confidence_boosters": [
          "multiple_artifact_sources",
          "consistent_timestamps",
          "clear_file_paths"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "5-20 minutes"
      }
    ],
    "environmental_detectors": {
      "notepad_plus_plus_environment": {
        "port_indicators": [],
        "service_indicators": [
          "notepad++.exe"
        ],
        "banner_indicators": [
          "Notepad++"
        ],
        "file_indicators": [
          "AppData/Roaming/Notepad++/config.xml",
          "AppData/Roaming/Notepad++/session.xml",
          "AppData/Roaming/Notepad++/backup/"
        ],
        "confidence_threshold": 0.95
      },
      "windows_user_profile": {
        "port_indicators": [],
        "service_indicators": [
          "explorer.exe"
        ],
        "path_indicators": [
          "C:/Users/*/AppData/",
          "C:/Users/*/Documents/",
          "C:/Users/*/Desktop/"
        ],
        "confidence_threshold": 0.9
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "notepad_artifact_analysis",
          "when": "notepad_plus_plus_detected",
          "reason": "high_success_rate_reveals_file_history"
        },
        {
          "attack": "backup_file_recovery",
          "when": "backup_folder_detected",
          "reason": "often_contains_deleted_or_modified_content"
        }
      ],
      "medium_priority": [
        {
          "attack": "xml_config_parsing",
          "when": "xml_files_detected",
          "reason": "reliable_but_requires_parsing"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Data Collection and Staging",
        "mitre_id": "T1074.001",
        "category": "collection",
        "phase": "collection",
        "tools_used": [
          {
            "name": "Custom Java Program",
            "command_template": "javac {source_file} && java {class_name}",
            "actual_command": "javac LootAndPurge.java && java Sensitive_data_extort",
            "output_pattern": "Zip archive created successfully at: {path}",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "java_development_environment",
          "local_system_access",
          "write_permissions_desktop"
        ],
        "success_indicators": [
          "zip_archive_created",
          "target_file_extensions_collected",
          "password_protected_archive"
        ],
        "common_failures": [
          "missing_java_compiler",
          "insufficient_disk_space",
          "antivirus_detection"
        ],
        "follow_up_techniques": [
          "data_exfiltration",
          "extortion_note_creation"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Data Extortion Note Deployment",
        "mitre_id": "T1491.001",
        "category": "impact",
        "phase": "impact",
        "tools_used": [
          {
            "name": "Notepad++",
            "command_template": "notepad++ {extortion_note_path}",
            "actual_command": "notepad++ \"C:\\Users\\Simon.stark\\Desktop\\YOU HAVE BEEN HACKED.txt\"",
            "output_pattern": "Text file with extortion demands",
            "effectiveness_rating": 4,
            "reliability": 0.99
          }
        ],
        "prerequisites": [
          "data_collection_complete",
          "external_paste_service_access",
          "crypto_wallet_prepared"
        ],
        "success_indicators": [
          "note_visible_on_desktop",
          "paste_service_links_functional",
          "payment_instructions_clear"
        ],
        "common_failures": [
          "paste_service_takedown",
          "password_lockout_self_inflicted",
          "contact_information_inaccessible"
        ],
        "follow_up_techniques": [
          "victim_communication_monitoring",
          "payment_tracking"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Living Off The Land Binary Usage",
        "mitre_id": "T1218",
        "category": "defense_evasion",
        "phase": "execution",
        "tools_used": [
          {
            "name": "Java Compiler (javac)",
            "command_template": "javac {malicious_source}.java",
            "actual_command": "javac LootAndPurge.java",
            "output_pattern": "Compiled .class file",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "java_development_kit_installed",
          "source_code_prepared",
          "compilation_environment_available"
        ],
        "success_indicators": [
          "successful_compilation",
          "executable_class_file_created",
          "no_antivirus_alerts"
        ],
        "common_failures": [
          "compilation_errors",
          "missing_dependencies",
          "security_software_detection"
        ],
        "follow_up_techniques": [
          "malicious_code_execution",
          "artifact_cleanup"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Notepad++",
        "use_case": "forensic_artifact_analysis",
        "effectiveness_rating": 5,
        "reliability": 0.99,
        "learning_curve": "low",
        "essential_for": [
          "windows_dfir",
          "text_file_analysis"
        ],
        "alternatives": [
          "volatility",
          "autopsy",
          "manual_file_analysis"
        ],
        "best_practices": [
          "analyze_backup_directory_for_deleted_content",
          "examine_session_xml_for_file_history",
          "convert_timestamps_from_windows_filetime_format",
          "check_config_xml_for_recently_opened_files"
        ]
      },
      {
        "tool": "Custom Java Data Collector",
        "use_case": "targeted_file_collection",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "medium",
        "essential_for": [
          "data_theft_operations"
        ],
        "alternatives": [
          "powershell_scripts",
          "batch_files",
          "python_scripts"
        ],
        "best_practices": [
          "target_specific_file_extensions",
          "use_password_protected_archives",
          "implement_recursive_directory_traversal",
          "blend_with_legitimate_development_tools"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "notepad_plus_plus_forensic_analysis",
        "steps": [
          {
            "step": 1,
            "command": "examine AppData/Roaming/Notepad++/config.xml",
            "purpose": "Extract recently opened file history",
            "expected_output": "List of legitimate files accessed by user"
          },
          {
            "step": 2,
            "command": "examine AppData/Roaming/Notepad++/session.xml",
            "purpose": "Identify currently open files and backup locations",
            "expected_output": "Active file sessions with backup paths and timestamps"
          },
          {
            "step": 3,
            "command": "analyze backup directory contents",
            "purpose": "Recover deleted or modified file contents",
            "expected_output": "Source code and extortion note contents"
          },
          {
            "step": 4,
            "command": "convert Windows FILETIME timestamps",
            "purpose": "Establish attack timeline",
            "expected_output": "Human readable modification timestamps"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "15-30 minutes"
      },
      {
        "sequence_name": "data_collection_and_extortion",
        "steps": [
          {
            "step": 1,
            "command": "javac LootAndPurge.java",
            "purpose": "Compile data collection program",
            "expected_output": "Sensitive_data_extort.class file"
          },
          {
            "step": 2,
            "command": "java Sensitive_data_extort",
            "purpose": "Execute file collection and archiving",
            "expected_output": "Forela-Dev-Data.zip with password protection"
          },
          {
            "step": 3,
            "command": "create extortion note with paste service links",
            "purpose": "Deploy ransom demands",
            "expected_output": "Desktop note with payment instructions"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "20-45 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Noted",
      "difficulty": "Easy",
      "os": "Windows",
      "platform": "HackTheBox Sherlock",
      "release_date": "2024-01-25",
      "author": "CyberJunkie",
      "estimated_time": "30-45 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "low",
      "skill_level_required": "beginner",
      "primary_attack_vectors": [
        "physical_access",
        "data_exfiltration"
      ],
      "key_vulnerabilities": [
        "notepad_artifacts",
        "local_file_recovery"
      ],
      "environment_type": "developer_workstation",
      "real_world_relevance": "high",
      "learning_value": [
        "digital_forensics",
        "artifact_analysis",
        "data_recovery"
      ],
      "prerequisite_knowledge": [
        "basic_dfir",
        "notepad_plus_plus_artifacts",
        "file_system_analysis"
      ]
    },
    "categorization": {
      "primary_category": "digital_forensics",
      "subcategories": [
        "artifact_analysis",
        "data_exfiltration",
        "extortion"
      ],
      "attack_types": [
        "data_theft",
        "extortion",
        "insider_threat"
      ],
      "defensive_lessons": [
        "endpoint_monitoring",
        "application_logging",
        "data_loss_prevention"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Campfire",
        "Tracer",
        "Bumblebee"
      ],
      "similarity_reasons": [
        "dfir_analysis",
        "artifact_recovery",
        "threat_hunting"
      ],
      "unique_aspects": [
        "notepad_plus_plus_focus",
        "extortion_scenario",
        "physical_access"
      ],
      "difficulty_factors": [
        "straightforward_artifact_analysis",
        "clear_attack_timeline"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T12:59:39.536915",
    "original_file": "0xdf_writeups/Htb Sherlock Noted.md",
    "content_length": 15278,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}