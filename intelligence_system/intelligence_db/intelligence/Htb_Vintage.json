{
  "writeup_id": "Htb_Vintage",
  "scenario_fingerprint": {
    "scenario_name": "windows_domain_controller_advanced_ad_exploitation",
    "primary_services": [
      "kerberos",
      "ldap",
      "smb",
      "dns",
      "winrm"
    ],
    "port_signature": "53+88+389+445+5985",
    "service_combination": "dns+kerberos+ldap+smb+winrm",
    "os_family": "windows_server",
    "environment_type": "active_directory",
    "entry_vector": "initial_credentials_provided",
    "privilege_path": "user_to_domain_admin_via_rbcd",
    "attack_complexity": "hard",
    "estimated_time": "3-4 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "ntlm_authentication_disabled",
      "kerberos_only_authentication",
      "pre_windows_2000_compatible_access_group",
      "gmsa_service_accounts",
      "resource_based_constrained_delegation"
    ],
    "environmental_clues": [
      "domain_controller_role",
      "bloodhound_enumeration_required",
      "computer_object_group_membership",
      "disabled_service_accounts",
      "windows_credential_manager_secrets"
    ],
    "similar_scenarios": [
      "forest_htb_hard",
      "blackfield_htb_hard"
    ],
    "unique_aspects": [
      "computer_password_guessing",
      "gmsa_password_extraction",
      "targeted_kerberoast_attack",
      "dpapi_credential_extraction",
      "rbcd_privilege_escalation"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Pre-Windows 2000 Compatible Access Exploitation",
        "success_reason": "Computer object FS01$ was member of Pre-Windows 2000 Compatible Access group with predictable password",
        "prerequisite_indicators": [
          "bloodhound_data_available",
          "computer_objects_enumerated",
          "legacy_group_memberships_present"
        ],
        "recognition_patterns": [
          "computer in Pre-Windows 2000 Compatible Access group",
          "machine account naming (hostname$)",
          "legacy AD configurations"
        ],
        "failure_modes": [
          "modern_password_policies_enforced",
          "no_legacy_group_memberships",
          "computer_accounts_hardened"
        ],
        "environmental_factors": [
          "legacy_active_directory_migration",
          "insufficient_group_cleanup",
          "default_machine_password_policy"
        ],
        "success_probability": 0.95,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "GMSA Password Extraction",
        "success_reason": "Machine account had permissions to read GMSA password attribute",
        "prerequisite_indicators": [
          "gmsa_accounts_exist",
          "machine_account_access",
          "ldap_query_permissions"
        ],
        "recognition_patterns": [
          "service accounts with $ suffix",
          "msDS-ManagedPassword attribute readable",
          "PrincipalsAllowedToRetrieveManagedPassword populated"
        ],
        "failure_modes": [
          "insufficient_permissions_to_read_gmsa",
          "no_gmsa_accounts_configured",
          "proper_gmsa_delegation"
        ],
        "environmental_factors": [
          "gmsa_implementation_present",
          "service_account_modernization",
          "delegation_misconfiguration"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Targeted Kerberoasting",
        "success_reason": "Service account enabled with weak password after gaining privileged access",
        "prerequisite_indicators": [
          "disabled_service_accounts_exist",
          "permissions_to_enable_accounts",
          "kerberos_authentication_available"
        ],
        "recognition_patterns": [
          "disabled user accounts with SPNs",
          "service account naming patterns",
          "account modification permissions"
        ],
        "failure_modes": [
          "strong_service_account_passwords",
          "no_permissions_to_modify_accounts",
          "no_spns_on_accounts"
        ],
        "environmental_factors": [
          "legacy_service_accounts",
          "weak_password_policies",
          "insufficient_account_monitoring"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "DPAPI Credential Extraction",
        "success_reason": "User had stored credentials in Windows Credential Manager accessible via DPAPI",
        "prerequisite_indicators": [
          "user_shell_access",
          "credential_manager_populated",
          "dpapi_masterkeys_accessible"
        ],
        "recognition_patterns": [
          "credential files in user profile",
          "DPAPI protected data present",
          "administrative credentials stored"
        ],
        "failure_modes": [
          "no_stored_credentials",
          "dpapi_keys_inaccessible",
          "credential_guard_enabled"
        ],
        "environmental_factors": [
          "user_credential_storage_habits",
          "lack_of_credential_policies",
          "legacy_authentication_methods"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "20-40 minutes"
      },
      {
        "technique": "Resource Based Constrained Delegation",
        "success_reason": "User could add computer objects to group with RBCD permissions on domain controller",
        "prerequisite_indicators": [
          "rbcd_configured_on_targets",
          "group_modification_permissions",
          "computer_account_control"
        ],
        "recognition_patterns": [
          "msDS-AllowedToActOnBehalfOfOtherIdentity attribute",
          "group membership modification rights",
          "delegation trust relationships"
        ],
        "failure_modes": [
          "no_rbcd_configurations",
          "insufficient_group_permissions",
          "delegation_restrictions"
        ],
        "environmental_factors": [
          "complex_delegation_setup",
          "service_account_requirements",
          "insufficient_delegation_hardening"
        ],
        "success_probability": 0.8,
        "typical_timeframe": "30-60 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "FS01$ computer in Pre-Windows 2000 Compatible Access",
        "discovery_method": "Bloodhound group membership analysis",
        "why_critical": "Provided machine account access with predictable password",
        "how_to_recognize": [
          "computer objects in legacy groups",
          "Pre-Windows 2000 Compatible Access membership",
          "machine account naming patterns"
        ],
        "follow_up_actions": [
          "test_lowercase_hostname_password",
          "enumerate_gmsa_permissions",
          "check_service_account_access"
        ]
      },
      {
        "discovery": "GMSA service account access",
        "discovery_method": "Machine account LDAP enumeration",
        "why_critical": "Enabled service account manipulation and targeted Kerberoasting",
        "how_to_recognize": [
          "msDS-ManagedPassword attribute readable",
          "service accounts with delegation",
          "PrincipalsAllowedToRetrieveManagedPassword populated"
        ],
        "follow_up_actions": [
          "extract_gmsa_password",
          "enumerate_service_permissions",
          "identify_disabled_accounts"
        ]
      },
      {
        "discovery": "DPAPI stored administrative credentials",
        "discovery_method": "Windows Credential Manager enumeration",
        "why_critical": "Provided administrative access for privilege escalation",
        "how_to_recognize": [
          "credential files in user profile",
          "DPAPI protected credential stores",
          "administrative account references"
        ],
        "follow_up_actions": [
          "extract_dpapi_masterkeys",
          "decrypt_stored_credentials",
          "test_administrative_access"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "machine_account",
        "escalation_method": "GMSA_to_service_account",
        "why_possible": "Machine account had permissions to read GMSA passwords",
        "recognition_signs": [
          "computer_in_legacy_groups",
          "gmsa_delegation_configured",
          "service_account_management_rights"
        ],
        "exploitation_path": "Pre-Windows 2000 → GMSA Access → Service Account Control"
      },
      {
        "privilege_level": "service_account",
        "escalation_method": "targeted_kerberoasting_to_user",
        "why_possible": "Could enable disabled accounts and extract service tickets",
        "recognition_signs": [
          "disabled_accounts_with_spns",
          "account_modification_permissions",
          "weak_service_passwords"
        ],
        "exploitation_path": "Enable Account → Kerberoast → Password Crack → User Access"
      },
      {
        "privilege_level": "user_account",
        "escalation_method": "DPAPI_to_administrative_access",
        "why_possible": "Administrative credentials stored in Windows Credential Manager",
        "recognition_signs": [
          "credential_manager_populated",
          "dpapi_protected_data",
          "administrative_credential_storage"
        ],
        "exploitation_path": "User Shell → DPAPI Extraction → Administrative Credentials"
      },
      {
        "privilege_level": "administrative_user",
        "escalation_method": "RBCD_to_domain_admin",
        "why_possible": "Could modify group membership for RBCD exploitation",
        "recognition_signs": [
          "group_modification_rights",
          "rbcd_configured_on_dc",
          "computer_account_control"
        ],
        "exploitation_path": "Add Computer to Group → RBCD → Domain Controller Access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 53,88,389,445 open on Windows host",
        "decision": "Identify as Domain Controller and try Kerberos attacks first",
        "reasoning": "Port combination indicates AD DC with high probability",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "smb_enumeration",
            "when": "if kerberos fails"
          },
          {
            "option": "ldap_enumeration",
            "when": "if anonymous access"
          }
        ],
        "success_indicators": [
          "kerberos_service_responds",
          "domain_name_discovered",
          "ldap_base_dn_found"
        ],
        "next_decision": "verify_initial_credentials"
      },
      {
        "step": 2,
        "situation": "Given initial credentials P.Rosa/Rosaisbest123",
        "decision": "Test credentials with Kerberos auth when NTLM fails",
        "reasoning": "NTLM disabled environments require Kerberos authentication",
        "confidence": 0.9,
        "prerequisites": [
          "domain_name_known",
          "proper_hostname_format"
        ],
        "success_indicators": [
          "kerberos_auth_successful"
        ],
        "failure_fallbacks": [
          "credential_spraying",
          "asreproast"
        ]
      },
      {
        "step": 3,
        "situation": "Valid domain credentials obtained",
        "decision": "Run Bloodhound enumeration immediately",
        "reasoning": "Essential for identifying privilege escalation paths and unusual group memberships",
        "confidence": 0.95,
        "prerequisites": [
          "valid_domain_credentials"
        ],
        "success_indicators": [
          "bloodhound_data_collected",
          "computer_objects_enumerated"
        ],
        "next_decision": "analyze_bloodhound_data"
      },
      {
        "step": 4,
        "situation": "Found computer FS01 in Pre-Windows 2000 Compatible Access group",
        "decision": "Test lowercase hostname as machine account password",
        "reasoning": "Pre-Windows 2000 Compatible Access indicates weak machine password",
        "confidence": 0.85,
        "prerequisites": [
          "computer_in_prewin2k_group"
        ],
        "success_indicators": [
          "machine_account_auth_successful"
        ],
        "next_decision": "check_gmsa_permissions"
      },
      {
        "step": 5,
        "situation": "Machine account has ReadGMSAPassword permission",
        "decision": "Extract GMSA password using machine account",
        "reasoning": "GMSA accounts often have elevated privileges",
        "confidence": 0.9,
        "prerequisites": [
          "machine_account_access",
          "gmsa_read_permission"
        ],
        "success_indicators": [
          "gmsa_password_extracted"
        ],
        "next_decision": "escalate_with_gmsa"
      }
    ],
    "branching_logic": {
      "if_ntlm_disabled": {
        "action": "switch_to_kerberos_auth",
        "tools": [
          "netexec",
          "kinit",
          "ldapsearch"
        ],
        "requirements": [
          "proper_hostname_format",
          "krb5_config"
        ]
      },
      "if_bloodhound_shows_unusual_groups": {
        "action": "investigate_group_memberships",
        "focus": [
          "pre_windows_2000_compatible_access",
          "gmsa_permissions"
        ],
        "next_phase": "machine_account_exploitation"
      },
      "if_machine_account_obtained": {
        "action": "check_gmsa_and_delegation_rights",
        "tools": [
          "ldapsearch",
          "bloodhound"
        ],
        "purpose": "find_service_account_passwords"
      },
      "if_gmsa_password_obtained": {
        "action": "authenticate_as_service_account",
        "tools": [
          "netexec",
          "evil-winrm"
        ],
        "next_phase": "service_account_enumeration"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_run_bloodhound_with_any_domain_credentials",
        "reasoning": "reveals_critical_attack_paths_and_unusual_configurations",
        "applicability": "any_active_directory_environment"
      },
      {
        "rule": "check_pre_windows_2000_group_memberships",
        "reasoning": "indicates_weak_machine_passwords_and_legacy_configurations",
        "applicability": "when_computer_objects_found"
      },
      {
        "rule": "prioritize_gmsa_password_extraction",
        "reasoning": "service_accounts_often_have_elevated_privileges",
        "applicability": "when_readgmsapassword_permission_found"
      },
      {
        "rule": "use_kerberos_auth_when_ntlm_disabled",
        "reasoning": "modern_ad_environments_disable_ntlm_for_security",
        "applicability": "when_ntlm_auth_fails_with_status_not_supported"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "ASREPRoast",
        "mitre_id": "T1558.004",
        "required_services": [
          "kerberos"
        ],
        "required_ports": [
          88
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "kerberos_authentication_enabled",
          "accounts_without_preauth_exist"
        ],
        "success_indicators": [
          "GetNPUsers_returns_hashes",
          "domain_controller_accessible",
          "service_accounts_present"
        ],
        "incompatible_with": [
          "kerberos_disabled",
          "all_accounts_require_preauth",
          "network_isolation"
        ],
        "confidence_boosters": [
          "service_account_naming_patterns",
          "default_ad_configuration",
          "legacy_exchange_services"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "5-15 minutes"
      },
      {
        "technique": "Kerberoasting",
        "mitre_id": "T1558.003",
        "required_services": [
          "kerberos"
        ],
        "required_ports": [
          88
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "service_accounts_with_spn_exist",
          "valid_domain_credentials"
        ],
        "success_indicators": [
          "GetUserSPNs_returns_tickets",
          "service_accounts_enumerated",
          "weak_passwords_likely"
        ],
        "incompatible_with": [
          "no_service_accounts",
          "strong_password_policy_enforced",
          "managed_service_accounts_only"
        ],
        "confidence_boosters": [
          "legacy_service_accounts",
          "default_service_passwords",
          "disabled_accounts_with_spns"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "GMSA_Password_Reading",
        "mitre_id": "T1555.004",
        "required_services": [
          "ldap"
        ],
        "required_ports": [
          389,
          636
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "gmsa_accounts_exist",
          "read_permissions_on_gmsa"
        ],
        "success_indicators": [
          "gmsa_password_blob_readable",
          "computer_account_access",
          "service_account_privileges"
        ],
        "incompatible_with": [
          "no_gmsa_accounts",
          "insufficient_permissions",
          "legacy_ad_environment"
        ],
        "confidence_boosters": [
          "computer_object_membership",
          "pre_windows_2000_compatible_access",
          "default_computer_passwords"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "DPAPI_Credential_Extraction",
        "mitre_id": "T1555.004",
        "required_services": [
          "winrm",
          "smb"
        ],
        "required_ports": [
          5985,
          445
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "user_access_to_target",
          "credential_manager_data_exists",
          "dpapi_keys_accessible"
        ],
        "success_indicators": [
          "credential_files_found",
          "master_keys_accessible",
          "stored_credentials_decrypted"
        ],
        "incompatible_with": [
          "no_stored_credentials",
          "encrypted_profile_unavailable",
          "insufficient_user_privileges"
        ],
        "confidence_boosters": [
          "windows_credential_manager_usage",
          "saved_rdp_credentials",
          "browser_saved_passwords"
        ],
        "typical_success_rate": 0.7,
        "estimated_time": "15-45 minutes"
      },
      {
        "technique": "Resource_Based_Constrained_Delegation",
        "mitre_id": "T1558.003",
        "required_services": [
          "kerberos",
          "ldap"
        ],
        "required_ports": [
          88,
          389
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "computer_object_control",
          "target_has_rbcd_permissions"
        ],
        "success_indicators": [
          "msds_allowedtoactonbehalfofotheridentity_writable",
          "computer_account_available",
          "delegation_configured_successfully"
        ],
        "incompatible_with": [
          "no_computer_object_control",
          "rbcd_not_supported",
          "insufficient_permissions"
        ],
        "confidence_boosters": [
          "group_membership_allows_modification",
          "domain_controller_target",
          "service_account_impersonation"
        ],
        "typical_success_rate": 0.8,
        "estimated_time": "20-60 minutes"
      }
    ],
    "environmental_detectors": {
      "active_directory": {
        "port_indicators": [
          53,
          88,
          389,
          445,
          3268,
          636,
          464,
          9389
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns",
          "adws"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server",
          "Domain Controller"
        ],
        "confidence_threshold": 0.95
      },
      "kerberos_only_auth": {
        "port_indicators": [
          88,
          464
        ],
        "service_indicators": [
          "kerberos-sec",
          "kpasswd5"
        ],
        "auth_indicators": [
          "ntlm_disabled",
          "kerberos_required"
        ],
        "confidence_threshold": 0.9
      },
      "gmsa_environment": {
        "port_indicators": [
          389,
          636
        ],
        "service_indicators": [
          "ldap"
        ],
        "object_indicators": [
          "computer_objects",
          "service_accounts",
          "gmsa_accounts"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "bloodhound_collection",
          "when": "active_directory_detected_with_creds",
          "reason": "comprehensive_attack_path_identification"
        },
        {
          "attack": "gmsa_password_reading",
          "when": "computer_object_in_pre_windows_2000_group",
          "reason": "high_success_rate_privilege_escalation"
        },
        {
          "attack": "kerberoasting_disabled_accounts",
          "when": "service_accounts_with_spns_found",
          "reason": "often_overlooked_attack_vector"
        }
      ],
      "medium_priority": [
        {
          "attack": "dpapi_credential_extraction",
          "when": "user_access_obtained",
          "reason": "reliable_lateral_movement_technique"
        },
        {
          "attack": "resource_based_constrained_delegation",
          "when": "computer_object_control_available",
          "reason": "path_to_domain_controller_compromise"
        }
      ],
      "low_priority": [
        {
          "attack": "asreproast",
          "when": "no_initial_credentials_available",
          "reason": "requires_accounts_without_preauth"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "GMSA Password Extraction",
        "mitre_id": "T1555.003",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "ldapsearch",
            "command_template": "ldapsearch -LLL -H ldap://{dc_host} -Y GSSAPI -b 'DC={domain},DC={tld}' '(&(ObjectClass=msDS-GroupManagedServiceAccount))' msDS-ManagedPassword",
            "actual_command": "ldapsearch -LLL -H ldap://dc01.vintage.htb -Y GSSAPI -b 'DC=vintage,DC=htb' '(&(ObjectClass=msDS-GroupManagedServiceAccount))' msDS-ManagedPassword",
            "output_pattern": "msDS-ManagedPassword:: {base64_blob}",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "netexec",
            "command_template": "netexec ldap {target} -u '{username}' -p {password} -k",
            "actual_command": "netexec ldap vintage.htb -u 'FS01$' -p fs01 -k",
            "success_factors": [
              "kerberos_auth_enabled",
              "machine_account_access"
            ],
            "effectiveness_rating": 4
          }
        ],
        "prerequisites": [
          "machine_account_credentials",
          "readgmsapassword_permission",
          "kerberos_authentication_available"
        ],
        "success_indicators": [
          "base64_encoded_password_blob_retrieved",
          "nt_hash_successfully_decoded",
          "service_account_authentication_successful"
        ],
        "common_failures": [
          "insufficient_permissions",
          "gmsa_account_not_found",
          "kerberos_ticket_issues"
        ],
        "follow_up_techniques": [
          "service_account_enumeration",
          "kerberoasting",
          "credential_spraying"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Pre-Windows 2000 Compatible Access Exploitation",
        "mitre_id": "T1078.002",
        "category": "credential_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "netexec",
            "command_template": "netexec ldap {target} -u '{hostname}$' -p {lowercase_hostname} -k",
            "actual_command": "netexec ldap vintage.htb -u 'FS01$' -p fs01 -k",
            "output_pattern": "[+] vintage.htb\\{hostname}$:{password}",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "computer_object_in_pre_windows_2000_group",
          "bloodhound_enumeration_completed",
          "kerberos_authentication_available"
        ],
        "success_indicators": [
          "machine_account_authentication_successful",
          "access_to_additional_resources_granted"
        ],
        "common_failures": [
          "password_changed_from_default",
          "group_membership_removed",
          "kerberos_configuration_issues"
        ],
        "follow_up_techniques": [
          "gmsa_password_extraction",
          "bloodhound_analysis",
          "privilege_escalation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Bloodhound Enumeration",
        "mitre_id": "T1087.002",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "bloodhound-ce-python",
            "command_template": "bloodhound-ce-python -c all -d {domain} -u {username} -p {password} -ns {nameserver} --zip",
            "actual_command": "bloodhound-ce-python -c all -d vintage.htb -u P.Rosa -p Rosaisbest123 -ns 10.10.11.45 --zip",
            "output_pattern": "Compressing output into {timestamp}_bloodhound.zip",
            "effectiveness_rating": 5,
            "reliability": 0.99
          }
        ],
        "prerequisites": [
          "domain_credentials_available",
          "ldap_access_granted",
          "network_connectivity_to_dc"
        ],
        "success_indicators": [
          "bloodhound_zip_file_created",
          "computer_objects_enumerated",
          "group_memberships_identified",
          "attack_paths_discovered"
        ],
        "common_failures": [
          "insufficient_permissions",
          "network_connectivity_issues",
          "authentication_failures"
        ],
        "follow_up_techniques": [
          "attack_path_analysis",
          "privilege_escalation_planning",
          "targeted_exploitation"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Kerberos Authentication Setup",
        "mitre_id": "T1558",
        "category": "credential_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "netexec",
            "command_template": "netexec smb {target} -u {username} -p {password} -k --generate-krb5-file {output_file}",
            "actual_command": "netexec smb dc01.vintage.htb -u 'P.Rosa' -p 'Rosaisbest123' -k --generate-krb5-file vintage-krb5.conf",
            "output_pattern": "krb5.conf configuration file generated",
            "effectiveness_rating": 4,
            "reliability": 0.95
          },
          {
            "name": "kinit",
            "command_template": "echo \"{password}\" | kinit '{username}'",
            "actual_command": "echo \"fs01\" | kinit 'fs01$'",
            "success_factors": [
              "valid_credentials",
              "proper_krb5_config"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "kerberos_enabled_environment",
          "valid_domain_credentials",
          "proper_dns_resolution"
        ],
        "success_indicators": [
          "kerberos_ticket_obtained",
          "authentication_successful",
          "service_tickets_available"
        ],
        "common_failures": [
          "clock_skew_issues",
          "dns_resolution_problems",
          "invalid_credentials"
        ],
        "follow_up_techniques": [
          "ldap_enumeration",
          "service_ticket_requests",
          "delegation_attacks"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "BloodHound",
        "use_case": "active_directory_enumeration",
        "effectiveness_rating": 5,
        "reliability": 0.99,
        "learning_curve": "medium",
        "essential_for": [
          "active_directory_environments"
        ],
        "alternatives": [
          "manual_ldap_enumeration",
          "powerview"
        ],
        "best_practices": [
          "run_after_obtaining_domain_credentials",
          "analyze_computer_objects_for_unusual_group_memberships",
          "focus_on_service_accounts_and_delegation_rights"
        ]
      },
      {
        "tool": "netexec",
        "use_case": "kerberos_authentication_and_enumeration",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "kerberos_enabled_environments"
        ],
        "alternatives": [
          "impacket_tools",
          "crackmapexec"
        ],
        "best_practices": [
          "use_full_hostnames_for_kerberos_auth",
          "generate_krb5_conf_for_consistent_results",
          "verify_authentication_before_enumeration"
        ]
      },
      {
        "tool": "ldapsearch",
        "use_case": "gmsa_password_extraction",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "medium",
        "essential_for": [
          "gmsa_environments"
        ],
        "alternatives": [
          "bloodyad",
          "powershell_ad_module"
        ],
        "best_practices": [
          "use_gssapi_authentication_with_kerberos",
          "target_specific_object_classes",
          "decode_base64_password_blobs_properly"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "pre_windows_2000_to_gmsa_extraction",
        "steps": [
          {
            "step": 1,
            "command": "bloodhound-ce-python -c all -d vintage.htb -u P.Rosa -p Rosaisbest123 -ns 10.10.11.45 --zip",
            "purpose": "Enumerate AD environment and identify computer objects",
            "expected_output": "Bloodhound data with computer object group memberships"
          },
          {
            "step": 2,
            "command": "netexec ldap vintage.htb -u 'FS01$' -p fs01 -k",
            "purpose": "Authenticate with Pre-Windows 2000 machine account",
            "expected_output": "[+] vintage.htb\\FS01$:fs01"
          },
          {
            "step": 3,
            "command": "netexec smb dc01.vintage.htb -u 'P.Rosa' -p 'Rosaisbest123' -k --generate-krb5-file vintage-krb5.conf",
            "purpose": "Generate Kerberos configuration file",
            "expected_output": "krb5.conf file created"
          },
          {
            "step": 4,
            "command": "echo \"fs01\" | kinit 'fs01$'",
            "purpose": "Obtain Kerberos ticket for machine account",
            "expected_output": "Kerberos ticket cached"
          },
          {
            "step": 5,
            "command": "ldapsearch -LLL -H ldap://dc01.vintage.htb -Y GSSAPI -b 'DC=vintage,DC=htb' '(&(ObjectClass=msDS-GroupManagedServiceAccount))' msDS-ManagedPassword",
            "purpose": "Extract GMSA password blob",
            "expected_output": "Base64 encoded GMSA password"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "15-30 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Vintage",
      "difficulty": "Hard",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2024-11-30",
      "author": "Geiseric",
      "estimated_time": "3-4 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "active_directory",
        "kerberos",
        "gmsa",
        "rbcd"
      ],
      "key_vulnerabilities": [
        "pre_windows_2000_group",
        "gmsa_password_extraction",
        "disabled_service_accounts",
        "dpapi_credential_extraction",
        "resource_based_constrained_delegation"
      ],
      "environment_type": "corporate_domain_controller",
      "real_world_relevance": "very_high",
      "learning_value": [
        "gmsa_attacks",
        "rbcd_exploitation",
        "dpapi_credential_extraction",
        "bloodhound_analysis",
        "kerberoasting"
      ],
      "prerequisite_knowledge": [
        "advanced_ad_concepts",
        "kerberos_delegation",
        "gmsa_fundamentals",
        "dpapi_concepts",
        "bloodhound_usage"
      ]
    },
    "categorization": {
      "primary_category": "active_directory",
      "subcategories": [
        "gmsa_attacks",
        "rbcd_exploitation",
        "credential_extraction",
        "kerberoasting"
      ],
      "attack_types": [
        "credential_access",
        "privilege_escalation",
        "lateral_movement",
        "persistence"
      ],
      "defensive_lessons": [
        "secure_gmsa_configuration",
        "monitor_group_memberships",
        "rbcd_restrictions",
        "credential_manager_hardening"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Forest",
        "Blackfield",
        "Intelligence"
      ],
      "similarity_reasons": [
        "pure_ad_environment",
        "bloodhound_enumeration",
        "advanced_kerberos_attacks",
        "multi_stage_privilege_escalation"
      ],
      "unique_aspects": [
        "gmsa_password_extraction",
        "pre_windows_2000_group_exploitation",
        "rbcd_through_group_manipulation",
        "dpapi_credential_extraction"
      ],
      "difficulty_factors": [
        "complex_attack_chain",
        "advanced_ad_concepts",
        "multiple_privilege_escalation_stages",
        "rbcd_exploitation"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T21:56:41.914352",
    "original_file": "0xdf_writeups/Htb Vintage.md",
    "content_length": 76084,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}