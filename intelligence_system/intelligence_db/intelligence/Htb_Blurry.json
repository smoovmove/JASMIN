{
  "writeup_id": "Htb_Blurry",
  "scenario_fingerprint": {
    "scenario_name": "linux_ml_platform_clearml_exploitation",
    "primary_services": [
      "http",
      "ssh"
    ],
    "port_signature": "22+80",
    "service_combination": "ssh+nginx+clearml",
    "os_family": "linux",
    "environment_type": "machine_learning_platform",
    "entry_vector": "clearml_cve_exploitation",
    "privilege_path": "web_app_to_root_via_ml_model_injection",
    "attack_complexity": "medium",
    "estimated_time": "60-90 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "clearml_platform_deployment",
      "ml_model_injection_capability",
      "administrative_review_workflow",
      "rocketchat_collaboration_platform"
    ],
    "environmental_clues": [
      "subdomain_based_architecture",
      "api_files_chat_app_subdomains",
      "black_swan_project_reference",
      "review_tag_workflow",
      "nginx_reverse_proxy"
    ],
    "similar_scenarios": [
      "jupyter_notebook_exploitation",
      "tensorboard_rce"
    ],
    "unique_aspects": [
      "clearml_specific_vulnerability",
      "ml_model_poisoning_privilege_escalation",
      "multi_subdomain_ml_infrastructure"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "CVE_exploitation_ClearML",
        "success_reason": "ClearML instance vulnerable to known CVE allowing arbitrary code execution",
        "prerequisite_indicators": [
          "clearml_service_accessible",
          "vulnerable_version_running",
          "api_endpoints_exposed"
        ],
        "recognition_patterns": [
          "ClearML web interface accessible",
          "API endpoints responding with structured JSON",
          "ML platform mentioned in reconnaissance",
          "Version disclosure in headers/responses"
        ],
        "failure_modes": [
          "patched_clearml_version",
          "api_authentication_required",
          "network_segmentation_blocking_access"
        ],
        "environmental_factors": [
          "ml_development_environment",
          "default_clearml_configuration",
          "exposed_api_without_authentication"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "malicious_ML_model_injection",
        "success_reason": "ML platform accepts and executes arbitrary model code without proper sandboxing",
        "prerequisite_indicators": [
          "ml_model_upload_functionality",
          "code_execution_in_model_context",
          "insufficient_input_validation"
        ],
        "recognition_patterns": [
          "model upload endpoints available",
          "pickle/serialized model acceptance",
          "execution environment accessible",
          "review tag mechanism mentioned"
        ],
        "failure_modes": [
          "model_validation_blocking_malicious_code",
          "sandboxed_execution_environment",
          "code_signing_requirements"
        ],
        "environmental_factors": [
          "development_ml_environment",
          "trusted_model_execution_context",
          "administrative_review_process_bypassable"
        ],
        "success_probability": 0.82,
        "typical_timeframe": "20-45 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "ClearML platform identification",
        "discovery_method": "subdomain enumeration and service fingerprinting",
        "why_critical": "Identified vulnerable ML platform as primary attack vector",
        "how_to_recognize": [
          "app.blurry.htb redirects to ML platform",
          "API endpoints with structured responses",
          "Chat mentions ClearML and review process"
        ],
        "follow_up_actions": [
          "identify_clearml_version",
          "search_for_known_cves",
          "test_api_authentication_requirements"
        ]
      },
      {
        "discovery": "Black Swan project review mechanism",
        "discovery_method": "RocketChat message analysis",
        "why_critical": "Revealed privileged execution context for tagged tasks",
        "how_to_recognize": [
          "chat mentions review tag process",
          "administrative review for certain tasks",
          "Black Swan project name mentioned"
        ],
        "follow_up_actions": [
          "craft_malicious_model_with_review_tag",
          "bypass_detection_mechanisms",
          "target_administrative_execution_context"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "web_application_user",
        "escalation_method": "CVE_exploitation_to_system_access",
        "why_possible": "ClearML CVE allows code execution in application context",
        "recognition_signs": [
          "clearml_version_vulnerable",
          "api_endpoints_accessible",
          "no_authentication_required"
        ],
        "exploitation_path": "CVE exploit → application shell → system reconnaissance"
      },
      {
        "privilege_level": "application_context",
        "escalation_method": "malicious_model_to_root",
        "why_possible": "ML model execution runs in privileged context with review tag",
        "recognition_signs": [
          "model_upload_functionality_available",
          "review_tag_triggers_privileged_execution",
          "detection_bypass_possible"
        ],
        "exploitation_path": "Malicious model creation → review tag → Black Swan execution → root access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80 open on Linux host with HTTP redirect to app.blurry.htb",
        "decision": "Enumerate subdomains and identify web applications",
        "reasoning": "Host-based routing indicates multiple services, need full attack surface",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "direct_ssh_attack",
            "when": "if no web vulnerabilities found"
          },
          {
            "option": "port_scan_expansion",
            "when": "if initial enum fails"
          }
        ],
        "success_indicators": [
          "multiple_subdomains_discovered",
          "application_types_identified",
          "user_accounts_accessible"
        ],
        "next_decision": "analyze_discovered_applications"
      },
      {
        "step": 2,
        "situation": "Discovered ClearML application and RocketChat with accessible registration",
        "decision": "Focus on ClearML CVE exploitation over chat enumeration",
        "reasoning": "ClearML is specialized ML platform with known CVEs, higher privilege potential",
        "confidence": 0.85,
        "prerequisites": [
          "clearml_version_identified",
          "user_access_obtained"
        ],
        "success_indicators": [
          "clearml_dashboard_access",
          "task_creation_possible"
        ],
        "failure_fallbacks": [
          "rocketchat_exploitation",
          "api_enumeration",
          "files_subdomain_analysis"
        ]
      },
      {
        "step": 3,
        "situation": "ClearML access obtained with task creation capabilities",
        "decision": "Exploit ClearML artifact processing for code execution",
        "reasoning": "Review process indicates automated execution of tagged tasks",
        "confidence": 0.8,
        "prerequisites": [
          "task_creation_access",
          "review_tag_mechanism_understood"
        ],
        "success_indicators": [
          "malicious_task_executed",
          "reverse_shell_obtained"
        ],
        "failure_fallbacks": [
          "model_injection_attack",
          "api_abuse",
          "file_upload_exploitation"
        ]
      }
    ],
    "branching_logic": {
      "if_clearml_cve_succeeds": {
        "action": "establish_foothold_and_enumerate",
        "tools": [
          "reverse_shell",
          "linpeas",
          "pspy"
        ],
        "next_phase": "privilege_escalation_enumeration"
      },
      "if_clearml_cve_fails": {
        "action": "try_model_injection_attack",
        "alternatives": [
          "malicious_ml_model",
          "artifact_manipulation",
          "api_direct_exploitation"
        ],
        "decision_criteria": "based_on_available_ml_model_upload_paths"
      },
      "if_initial_access_obtained": {
        "action": "enumerate_ml_infrastructure",
        "purpose": "find_model_execution_privilege_escalation",
        "tools": [
          "find_ml_configs",
          "check_docker_containers",
          "enumerate_ml_processes"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "prioritize_specialized_applications_over_generic",
        "reasoning": "specialized_apps_like_clearml_have_unique_attack_vectors",
        "applicability": "when_multiple_web_applications_discovered"
      },
      {
        "rule": "exploit_automated_review_processes_in_ml_platforms",
        "reasoning": "ml_platforms_often_have_automated_execution_of_user_content",
        "applicability": "clearml_or_similar_ml_platform_environments"
      },
      {
        "rule": "leverage_ml_model_injection_for_privilege_escalation",
        "reasoning": "ml_models_often_executed_with_elevated_privileges",
        "applicability": "after_obtaining_ml_platform_access"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "ClearML_CVE_Exploitation",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "clearml"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8081
        ],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "clearml_service_running",
          "web_interface_accessible",
          "api_endpoints_exposed"
        ],
        "success_indicators": [
          "clearml_login_page_present",
          "api_endpoints_respond",
          "task_creation_possible"
        ],
        "incompatible_with": [
          "clearml_patched",
          "api_authentication_required",
          "network_isolation"
        ],
        "confidence_boosters": [
          "clearml_version_disclosure",
          "default_configuration",
          "admin_review_workflow_present"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "15-30 minutes"
      },
      {
        "technique": "ML_Model_Injection",
        "mitre_id": "T1055",
        "required_services": [
          "clearml",
          "python"
        ],
        "required_ports": [
          8080,
          8081
        ],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "ml_platform_access",
          "model_upload_capability",
          "automated_model_execution"
        ],
        "success_indicators": [
          "model_upload_successful",
          "task_execution_triggered",
          "reverse_shell_received"
        ],
        "incompatible_with": [
          "model_validation_strict",
          "sandboxed_execution",
          "code_signing_required"
        ],
        "confidence_boosters": [
          "admin_review_tags_present",
          "black_swan_project_exists",
          "automated_workflows_enabled"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "20-45 minutes"
      },
      {
        "technique": "RocketChat_Enumeration",
        "mitre_id": "T1087",
        "required_services": [
          "http",
          "rocketchat"
        ],
        "required_ports": [
          80,
          443,
          3000
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "rocketchat_accessible",
          "user_registration_enabled",
          "channels_discoverable"
        ],
        "success_indicators": [
          "user_list_accessible",
          "channel_messages_readable",
          "organizational_info_disclosed"
        ],
        "incompatible_with": [
          "registration_disabled",
          "channels_private_only",
          "guest_access_restricted"
        ],
        "confidence_boosters": [
          "default_rocketchat_config",
          "admin_announcements_present",
          "integration_details_shared"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "5-15 minutes"
      }
    ],
    "environmental_detectors": {
      "clearml_platform": {
        "port_indicators": [
          80,
          443,
          8080,
          8081,
          8008
        ],
        "service_indicators": [
          "http",
          "clearml-api",
          "clearml-web"
        ],
        "banner_indicators": [
          "ClearML",
          "Allegro AI",
          "trains"
        ],
        "confidence_threshold": 0.9
      },
      "rocketchat": {
        "port_indicators": [
          80,
          443,
          3000
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "Rocket.Chat",
          "rocketchat"
        ],
        "confidence_threshold": 0.95
      },
      "ml_environment": {
        "port_indicators": [
          8080,
          8081,
          8888,
          9000
        ],
        "service_indicators": [
          "jupyter",
          "tensorboard",
          "mlflow"
        ],
        "technology_indicators": [
          "python",
          "pytorch",
          "tensorflow"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "rocketchat_enumeration",
          "when": "rocketchat_detected",
          "reason": "high_success_rate_information_disclosure"
        },
        {
          "attack": "clearml_cve_exploitation",
          "when": "clearml_platform_detected",
          "reason": "direct_code_execution_possible"
        }
      ],
      "medium_priority": [
        {
          "attack": "ml_model_injection",
          "when": "ml_platform_access_gained",
          "reason": "privilege_escalation_through_model_execution"
        },
        {
          "attack": "api_enumeration",
          "when": "api_endpoints_discovered",
          "reason": "potential_authentication_bypass"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "ClearML Pickle Deserialization RCE",
        "mitre_id": "T1203",
        "category": "execution",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "clearml",
            "command_template": "clearml-init",
            "actual_command": "clearml-init",
            "output_pattern": "ClearML SDK setup",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "python_pickle",
            "command_template": "pickle.dumps({malicious_object})",
            "actual_command": "pickle.dumps(reverse_shell_payload)",
            "success_factors": [
              "artifact_get_called",
              "pickle_deserialization_occurs"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "clearml_version_1.13.1_or_vulnerable",
          "ability_to_create_tasks",
          "review_tag_processing_active",
          "artifact_get_function_used"
        ],
        "success_indicators": [
          "task_created_successfully",
          "review_process_triggered",
          "reverse_shell_connection_established"
        ],
        "common_failures": [
          "clearml_version_patched",
          "review_process_not_running",
          "network_connectivity_blocked"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "persistence_establishment",
          "lateral_movement"
        ],
        "time_investment": "15-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "ML Model Injection",
        "mitre_id": "T1055",
        "category": "execution",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "clearml_task_creation",
            "command_template": "Task.init(project_name='{project}', task_name='{name}', tags=['{tag}'])",
            "actual_command": "Task.init(project_name='Black Swan', task_name='malicious_task', tags=['review'])",
            "output_pattern": "Task initialized",
            "effectiveness_rating": 4,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "clearml_access_established",
          "understanding_of_review_process",
          "ability_to_upload_artifacts"
        ],
        "success_indicators": [
          "malicious_task_created",
          "artifact_uploaded_successfully",
          "automated_review_triggered"
        ],
        "common_failures": [
          "detection_mechanisms_active",
          "insufficient_permissions",
          "payload_format_incorrect"
        ],
        "follow_up_techniques": [
          "root_access_via_model_execution",
          "persistence_via_scheduled_tasks"
        ],
        "time_investment": "20-45 minutes",
        "skill_level": "advanced"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "ClearML",
        "use_case": "ml_ops_exploitation",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "medium",
        "essential_for": [
          "ml_infrastructure_environments"
        ],
        "alternatives": [
          "direct_api_exploitation",
          "web_interface_abuse"
        ],
        "best_practices": [
          "understand_task_lifecycle",
          "identify_automated_processes",
          "craft_proper_pickle_payloads"
        ]
      },
      {
        "tool": "feroxbuster",
        "use_case": "subdomain_enumeration",
        "effectiveness_rating": 4,
        "reliability": 0.85,
        "learning_curve": "low",
        "essential_for": [
          "web_application_reconnaissance"
        ],
        "alternatives": [
          "ffuf",
          "gobuster",
          "dirb"
        ],
        "best_practices": [
          "use_appropriate_wordlists",
          "adjust_thread_count_for_target",
          "filter_false_positives"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "clearml_cve_exploitation",
        "steps": [
          {
            "step": 1,
            "command": "nmap -p- --min-rate 10000 {target_ip}",
            "purpose": "Initial port discovery",
            "expected_output": "Open ports 22, 80"
          },
          {
            "step": 2,
            "command": "ffuf -u http://{target_ip} -H 'Host: FUZZ.blurry.htb' -w /opt/SecLists/Discovery/DNS/subdomains-top1million-20000.txt -mc all -ac",
            "purpose": "Subdomain enumeration",
            "expected_output": "api, app, files, chat subdomains"
          },
          {
            "step": 3,
            "command": "clearml-init",
            "purpose": "Initialize ClearML client",
            "expected_output": "SDK configuration setup"
          },
          {
            "step": 4,
            "command": "python3 exploit_script.py",
            "purpose": "Execute pickle deserialization exploit",
            "expected_output": "Reverse shell as jippity user"
          }
        ],
        "success_rate": 0.9,
        "typical_duration": "30-60 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Blurry",
      "difficulty": "Medium",
      "os": "Linux (Debian 11)",
      "platform": "HackTheBox",
      "release_date": "2024-06-08",
      "author": "C4rm3l0",
      "estimated_time": "2-3 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "cve_exploitation",
        "machine_learning_abuse"
      ],
      "key_vulnerabilities": [
        "clearml_cve",
        "ml_model_injection"
      ],
      "environment_type": "machine_learning_platform",
      "real_world_relevance": "high",
      "learning_value": [
        "ml_security",
        "model_poisoning",
        "cve_exploitation"
      ],
      "prerequisite_knowledge": [
        "web_exploitation",
        "python",
        "ml_concepts"
      ]
    },
    "categorization": {
      "primary_category": "web_exploitation",
      "subcategories": [
        "cve_exploitation",
        "machine_learning_security",
        "privilege_escalation"
      ],
      "attack_types": [
        "initial_access",
        "privilege_escalation",
        "code_execution"
      ],
      "defensive_lessons": [
        "ml_model_validation",
        "input_sanitization",
        "least_privilege"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Jupyter",
        "Analytics",
        "Sandworm"
      ],
      "similarity_reasons": [
        "python_environment",
        "data_science_tools",
        "model_manipulation"
      ],
      "unique_aspects": [
        "clearml_platform",
        "ml_model_injection",
        "detection_bypass"
      ],
      "difficulty_factors": [
        "specialized_ml_knowledge",
        "cve_research",
        "detection_evasion"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T01:28:12.480478",
    "original_file": "0xdf_writeups/Htb Blurry.md",
    "content_length": 48636,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 0.9166666666666667,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 0.6666666666666666,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}