{
  "writeup_id": "Htb_Underpass",
  "scenario_fingerprint": {
    "scenario_name": "linux_snmp_daloradius_default_creds",
    "primary_services": [
      "ssh",
      "http",
      "snmp"
    ],
    "port_signature": "22+80+161",
    "service_combination": "ssh+apache+snmp",
    "os_family": "ubuntu_linux",
    "environment_type": "radius_server",
    "entry_vector": "snmp_enumeration_to_default_credentials",
    "privilege_path": "web_access_to_ssh_to_sudo_mosh",
    "attack_complexity": "easy",
    "estimated_time": "30-45 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "daloradius_web_interface",
      "snmp_public_community",
      "default_web_credentials",
      "mosh_sudo_privilege"
    ],
    "environmental_clues": [
      "snmp_system_description_reveals_daloradius",
      "ubuntu_apache_default_page",
      "contact_email_in_snmp",
      "hostname_in_snmp_data"
    ],
    "similar_scenarios": [
      "linux_radius_servers",
      "snmp_enumeration_boxes"
    ],
    "unique_aspects": [
      "mobile_shell_privilege_escalation",
      "daloradius_hash_extraction",
      "snmp_hostname_disclosure"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "SNMP_enumeration",
        "success_reason": "Default community string 'public' was enabled with full read access",
        "prerequisite_indicators": [
          "udp_161_open",
          "snmp_service_running",
          "default_community_strings_enabled"
        ],
        "recognition_patterns": [
          "snmpwalk responds to 'public' community",
          "system information disclosure",
          "contact information exposed"
        ],
        "failure_modes": [
          "snmp_disabled",
          "custom_community_strings",
          "snmp_access_restricted"
        ],
        "environmental_factors": [
          "default_snmp_configuration",
          "insufficient_network_hardening",
          "legacy_monitoring_setup"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "default_credentials",
        "success_reason": "daloRADIUS application deployed with default administrative credentials",
        "prerequisite_indicators": [
          "web_application_identified",
          "login_page_accessible",
          "default_installation_present"
        ],
        "recognition_patterns": [
          "daloRADIUS login interface",
          "default admin/radius credentials work",
          "immediate administrative access"
        ],
        "failure_modes": [
          "credentials_changed_during_setup",
          "application_properly_hardened",
          "custom_authentication_implemented"
        ],
        "environmental_factors": [
          "rapid_deployment_practices",
          "insufficient_post_install_hardening",
          "default_application_configurations"
        ],
        "success_probability": 0.82,
        "typical_timeframe": "1-3 minutes"
      },
      {
        "technique": "sudo_privilege_escalation",
        "success_reason": "User allowed to run mosh-server as root without password",
        "prerequisite_indicators": [
          "sudo_permissions_available",
          "mosh_server_installed",
          "nopasswd_sudo_configured"
        ],
        "recognition_patterns": [
          "sudo -l shows mosh-server permissions",
          "NOPASSWD configuration present",
          "root execution allowed"
        ],
        "failure_modes": [
          "sudo_properly_restricted",
          "mosh_not_installed",
          "password_required_for_sudo"
        ],
        "environmental_factors": [
          "convenience_over_security_configuration",
          "mobile_shell_deployment",
          "administrative_shortcuts"
        ],
        "success_probability": 0.91,
        "typical_timeframe": "1-2 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "daloRADIUS server location",
        "discovery_method": "SNMP system description enumeration",
        "why_critical": "Revealed hidden web application not found through directory brute force",
        "how_to_recognize": [
          "snmp sysName contains application hints",
          "service descriptions in snmp data",
          "contact information disclosure"
        ],
        "follow_up_actions": [
          "enumerate_application_paths",
          "test_default_credentials",
          "identify_application_version"
        ]
      },
      {
        "discovery": "user hash in daloRADIUS database",
        "discovery_method": "Administrative access to user management interface",
        "why_critical": "Provided crackable hash leading to SSH access",
        "how_to_recognize": [
          "user management sections in admin panels",
          "password hash fields visible",
          "database export functionality"
        ],
        "follow_up_actions": [
          "extract_all_user_hashes",
          "attempt_hash_cracking",
          "test_ssh_access_with_credentials"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "web_application_admin",
        "escalation_method": "hash_extraction_to_ssh",
        "why_possible": "Application stored user credentials accessible to administrators",
        "recognition_signs": [
          "user_database_access_available",
          "password_hashes_visible",
          "same_credentials_reused_for_ssh"
        ],
        "exploitation_path": "Default creds → Admin panel → Extract hash → Crack → SSH"
      },
      {
        "privilege_level": "ssh_user",
        "escalation_method": "sudo_mosh_server_to_root",
        "why_possible": "Misconfigured sudo permissions allowing root command execution",
        "recognition_signs": [
          "sudo_l_shows_mosh_permissions",
          "nopasswd_configuration",
          "mosh_server_spawns_root_shell"
        ],
        "exploitation_path": "SSH access → sudo mosh-server → root shell"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80 open on Linux host with default Apache page",
        "decision": "Perform UDP scan to discover additional services",
        "reasoning": "TCP scan shows limited attack surface, UDP may reveal hidden services",
        "confidence": 0.75,
        "alternatives": [
          {
            "option": "directory_bruteforce",
            "when": "if no UDP services found"
          },
          {
            "option": "subdomain_enumeration",
            "when": "if domain name available"
          }
        ],
        "success_indicators": [
          "additional_services_discovered",
          "snmp_service_found",
          "information_disclosure_via_udp"
        ],
        "next_decision": "enumerate_discovered_udp_services"
      },
      {
        "step": 2,
        "situation": "SNMP service discovered on UDP 161",
        "decision": "Enumerate SNMP with default community string 'public'",
        "reasoning": "SNMP often misconfigured with default credentials and reveals system information",
        "confidence": 0.9,
        "prerequisites": [
          "snmp_service_accessible"
        ],
        "success_indicators": [
          "system_information_disclosed",
          "hostnames_discovered",
          "application_names_revealed",
          "user_emails_found"
        ],
        "next_decision": "analyze_snmp_data_for_attack_vectors"
      },
      {
        "step": 3,
        "situation": "SNMP reveals 'daloradius server' and hostname 'UnDerPass.htb'",
        "decision": "Search for daloradius web interface at common paths",
        "reasoning": "Application name disclosure suggests web-based management interface exists",
        "confidence": 0.85,
        "alternatives": [
          {
            "option": "directory_bruteforce_with_app_name",
            "when": "if direct path fails"
          },
          {
            "option": "subdomain_enumeration",
            "when": "if not in web root"
          }
        ],
        "success_indicators": [
          "daloradius_interface_found",
          "login_page_discovered",
          "different_http_response_code"
        ],
        "next_decision": "attempt_default_credentials"
      },
      {
        "step": 4,
        "situation": "Found daloradius login interface",
        "decision": "Try default credentials before brute force",
        "reasoning": "Management interfaces often use default credentials, faster than brute force",
        "confidence": 0.8,
        "prerequisites": [
          "login_interface_accessible"
        ],
        "success_indicators": [
          "successful_authentication",
          "admin_panel_access",
          "user_data_visible"
        ],
        "failure_fallbacks": [
          "credential_bruteforce",
          "version_specific_exploits"
        ]
      }
    ],
    "branching_logic": {
      "if_snmp_enumeration_succeeds": {
        "action": "extract_application_and_hostname_info",
        "tools": [
          "snmpwalk",
          "snmp-check"
        ],
        "next_phase": "targeted_application_enumeration"
      },
      "if_application_name_discovered": {
        "action": "search_for_web_interface",
        "alternatives": [
          "direct_path_access",
          "directory_bruteforce",
          "subdomain_enum"
        ],
        "decision_criteria": "based_on_initial_path_response"
      },
      "if_management_interface_found": {
        "action": "attempt_authentication",
        "methods": [
          "default_credentials",
          "credential_stuffing",
          "version_exploits"
        ],
        "tools": [
          "burp",
          "hydra",
          "custom_scripts"
        ]
      },
      "if_credentials_obtained": {
        "action": "enumerate_application_data",
        "purpose": "find_user_credentials_or_system_access",
        "tools": [
          "manual_inspection",
          "sqlmap",
          "custom_extraction"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_scan_udp_when_tcp_shows_limited_services",
        "reasoning": "udp_services_often_reveal_additional_attack_surface",
        "applicability": "minimal_tcp_services_found"
      },
      {
        "rule": "enumerate_snmp_with_public_community_string_first",
        "reasoning": "high_success_rate_and_valuable_information_disclosure",
        "applicability": "snmp_service_discovered"
      },
      {
        "rule": "use_application_names_from_snmp_for_targeted_enumeration",
        "reasoning": "reduces_enumeration_time_and_increases_success_probability",
        "applicability": "application_names_discovered_via_snmp"
      },
      {
        "rule": "try_default_credentials_on_management_interfaces",
        "reasoning": "management_tools_frequently_use_default_authentication",
        "applicability": "administrative_web_interfaces_found"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "SNMP_Enumeration",
        "mitre_id": "T1040",
        "required_services": [
          "snmp"
        ],
        "required_ports": [
          161
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "snmp_service_enabled",
          "default_community_strings",
          "network_accessible"
        ],
        "success_indicators": [
          "snmpwalk_returns_data",
          "system_information_disclosed",
          "process_list_accessible"
        ],
        "incompatible_with": [
          "snmp_disabled",
          "custom_community_strings_only",
          "snmp_filtered_by_firewall"
        ],
        "confidence_boosters": [
          "default_public_community",
          "verbose_system_descriptions",
          "contact_information_exposed"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "Default_Credentials",
        "mitre_id": "T1078.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_application_detected",
          "login_page_accessible",
          "default_installation"
        ],
        "success_indicators": [
          "login_successful",
          "admin_panel_access",
          "configuration_accessible"
        ],
        "incompatible_with": [
          "credentials_changed",
          "account_lockout_enabled",
          "multi_factor_authentication"
        ],
        "confidence_boosters": [
          "fresh_installation_indicators",
          "default_page_content",
          "common_application_frameworks"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "1-3 minutes"
      },
      {
        "technique": "Hash_Cracking",
        "mitre_id": "T1110.002",
        "required_services": [
          "any"
        ],
        "required_ports": [],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "password_hashes_obtained",
          "weak_password_policy",
          "common_hash_formats"
        ],
        "success_indicators": [
          "hash_successfully_cracked",
          "plaintext_password_recovered",
          "credential_reuse_confirmed"
        ],
        "incompatible_with": [
          "strong_password_policy",
          "salted_hashes",
          "modern_hashing_algorithms"
        ],
        "confidence_boosters": [
          "md5_or_sha1_hashes",
          "short_password_length",
          "dictionary_words_used"
        ],
        "typical_success_rate": 0.7,
        "estimated_time": "5-30 minutes"
      },
      {
        "technique": "Sudo_Privilege_Escalation",
        "mitre_id": "T1548.003",
        "required_services": [
          "ssh"
        ],
        "required_ports": [
          22
        ],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "user_shell_access",
          "sudo_permissions_configured",
          "misconfigured_sudo_rules"
        ],
        "success_indicators": [
          "sudo_l_shows_permissions",
          "root_command_execution",
          "privilege_escalation_successful"
        ],
        "incompatible_with": [
          "no_sudo_access",
          "properly_configured_sudo",
          "password_required_for_sudo"
        ],
        "confidence_boosters": [
          "nopasswd_sudo_entries",
          "wildcard_sudo_permissions",
          "service_management_sudo_access"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "1-5 minutes"
      }
    ],
    "environmental_detectors": {
      "snmp_service": {
        "port_indicators": [
          161
        ],
        "service_indicators": [
          "snmp"
        ],
        "banner_indicators": [
          "SNMPv1",
          "SNMPv2",
          "net-snmp"
        ],
        "confidence_threshold": 0.95
      },
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "apache",
          "nginx",
          "iis"
        ],
        "confidence_threshold": 0.9
      },
      "linux_system": {
        "port_indicators": [
          22
        ],
        "service_indicators": [
          "ssh"
        ],
        "banner_indicators": [
          "OpenSSH",
          "Ubuntu",
          "Linux"
        ],
        "confidence_threshold": 0.85
      },
      "radius_application": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http"
        ],
        "technology_indicators": [
          "daloradius",
          "radius"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "snmp_enumeration",
          "when": "snmp_service_detected",
          "reason": "often_reveals_system_information_and_credentials"
        },
        {
          "attack": "default_credentials",
          "when": "web_application_detected",
          "reason": "quick_win_for_application_access"
        }
      ],
      "medium_priority": [
        {
          "attack": "hash_cracking",
          "when": "password_hashes_obtained",
          "reason": "reliable_but_time_dependent"
        },
        {
          "attack": "sudo_privilege_escalation",
          "when": "user_shell_access_obtained",
          "reason": "common_misconfiguration_in_linux"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "SNMP Enumeration",
        "mitre_id": "T1040",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "nmap",
            "command_template": "nmap -sU --min-rate 10000 {target}",
            "actual_command": "nmap -sU --min-rate 10000 10.10.11.48",
            "output_pattern": "161/udp   open   snmp",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "snmpwalk",
            "command_template": "snmpwalk -v 2c -c {community} {target}",
            "actual_command": "snmpwalk -v 2c -c public 10.10.11.48",
            "output_pattern": "SNMPv2-MIB::sysContact.0 = STRING: steve@underpass.htb",
            "success_factors": [
              "default_community_string",
              "snmp_service_accessible"
            ],
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "snmp_service_running",
          "default_community_strings",
          "network_connectivity"
        ],
        "success_indicators": [
          "system_information_disclosed",
          "usernames_emails_discovered",
          "service_information_revealed"
        ],
        "common_failures": [
          "custom_community_strings",
          "snmp_service_disabled",
          "firewall_blocking_udp_161"
        ],
        "follow_up_techniques": [
          "directory_brute_force",
          "service_enumeration",
          "credential_testing"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Web Directory Discovery",
        "mitre_id": "T1083",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "feroxbuster",
            "command_template": "feroxbuster -u http://{target}/{path}",
            "actual_command": "feroxbuster -u http://underpass.htb/daloradius",
            "output_pattern": "301      GET        9l       28w      319c",
            "effectiveness_rating": 4,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "web_service_accessible",
          "target_application_identified",
          "wordlist_available"
        ],
        "success_indicators": [
          "hidden_directories_found",
          "application_structure_mapped",
          "potential_entry_points_identified"
        ],
        "common_failures": [
          "incomplete_wordlists",
          "rate_limiting_blocking_requests",
          "custom_directory_names"
        ],
        "follow_up_techniques": [
          "application_login_testing",
          "source_code_analysis",
          "configuration_file_discovery"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Service Fingerprinting",
        "mitre_id": "T1046",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "nmap",
            "command_template": "nmap -p {ports} -sCV {target}",
            "actual_command": "nmap -p 22,80 -vv -sCV 10.10.11.48",
            "output_pattern": "OpenSSH 8.9p1 Ubuntu 3ubuntu0.10",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "open_ports_identified",
          "network_connectivity",
          "target_responsive"
        ],
        "success_indicators": [
          "service_versions_identified",
          "operating_system_determined",
          "potential_vulnerabilities_noted"
        ],
        "common_failures": [
          "service_banner_disabled",
          "custom_service_configurations",
          "firewall_interference"
        ],
        "follow_up_techniques": [
          "vulnerability_research",
          "exploit_development",
          "credential_attacks"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "snmpwalk",
        "use_case": "information_disclosure_via_snmp",
        "effectiveness_rating": 5,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "network_reconnaissance",
          "system_enumeration"
        ],
        "alternatives": [
          "snmp-check",
          "onesixtyone",
          "snmpenum"
        ],
        "best_practices": [
          "try_common_community_strings_first",
          "save_output_for_analysis",
          "look_for_contact_information_and_system_details"
        ]
      },
      {
        "tool": "feroxbuster",
        "use_case": "web_directory_enumeration",
        "effectiveness_rating": 4,
        "reliability": 0.85,
        "learning_curve": "low",
        "essential_for": [
          "web_application_testing",
          "hidden_content_discovery"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "use_multiple_wordlists_for_comprehensive_coverage",
          "adjust_threads_based_on_target_response",
          "follow_up_on_403_responses_with_targeted_enumeration"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "snmp_to_web_application_discovery",
        "steps": [
          {
            "step": 1,
            "command": "nmap -sU --min-rate 10000 10.10.11.48",
            "purpose": "Discover SNMP service",
            "expected_output": "161/udp open snmp"
          },
          {
            "step": 2,
            "command": "snmpwalk -v 2c -c public 10.10.11.48",
            "purpose": "Extract system information",
            "expected_output": "daloradius server reference and contact info"
          },
          {
            "step": 3,
            "command": "feroxbuster -u http://underpass.htb/daloradius",
            "purpose": "Map application structure",
            "expected_output": "Multiple directories and application files"
          }
        ],
        "success_rate": 0.75,
        "typical_duration": "15-25 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "UnderPass",
      "difficulty": "Easy",
      "os": "Linux Ubuntu 22.04",
      "platform": "HackTheBox",
      "release_date": "2024-12-21",
      "author": "dakkmaddy",
      "estimated_time": "30-45 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "low",
      "skill_level_required": "beginner",
      "primary_attack_vectors": [
        "snmp_enumeration",
        "default_credentials",
        "sudo_misconfiguration"
      ],
      "key_vulnerabilities": [
        "snmp_information_disclosure",
        "default_authentication",
        "privilege_escalation_via_mosh"
      ],
      "environment_type": "network_infrastructure_server",
      "real_world_relevance": "high",
      "learning_value": [
        "snmp_reconnaissance",
        "radius_server_exploitation",
        "mosh_privilege_escalation"
      ],
      "prerequisite_knowledge": [
        "basic_networking",
        "snmp_concepts",
        "linux_fundamentals"
      ]
    },
    "categorization": {
      "primary_category": "network_services",
      "subcategories": [
        "snmp_enumeration",
        "radius_exploitation",
        "sudo_abuse"
      ],
      "attack_types": [
        "information_gathering",
        "credential_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "secure_snmp_configuration",
        "change_default_credentials",
        "restrict_sudo_permissions"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Mirai",
        "Shocker",
        "Beep"
      ],
      "similarity_reasons": [
        "default_credentials",
        "service_misconfiguration",
        "straightforward_attack_path"
      ],
      "unique_aspects": [
        "daloradius_exploitation",
        "mosh_server_privilege_escalation",
        "snmp_to_web_pivot"
      ],
      "difficulty_factors": [
        "clear_attack_progression",
        "well_known_default_credentials",
        "simple_privilege_escalation"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T20:01:04.694599",
    "original_file": "0xdf_writeups/Htb Underpass.md",
    "content_length": 28736,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}