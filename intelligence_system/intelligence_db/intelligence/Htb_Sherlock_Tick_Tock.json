{
  "writeup_id": "Htb_Sherlock_Tick_Tock",
  "scenario_fingerprint": {
    "scenario_name": "social_engineering_remote_access_c2",
    "primary_services": [
      "teamviewer",
      "powershell",
      "windows_defender"
    ],
    "port_signature": "5938+443",
    "service_combination": "remote_access+c2_framework",
    "os_family": "windows_workstation",
    "environment_type": "corporate_endpoint",
    "entry_vector": "social_engineering_phone_call",
    "privilege_path": "user_to_system_manipulation",
    "attack_complexity": "medium",
    "estimated_time": "30-45 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "teamviewer_remote_session",
      "merlin_c2_agent",
      "time_manipulation_script",
      "bitlocker_password_attempt",
      "windows_defender_detection"
    ],
    "environmental_clues": [
      "teamviewer_logs_present",
      "powershell_execution_policy_bypass",
      "invoke_timewizard_script",
      "session_id_tracking",
      "participant_management_logs"
    ],
    "similar_scenarios": [
      "helpdesk_impersonation",
      "it_support_scam"
    ],
    "unique_aspects": [
      "systematic_time_manipulation",
      "forensics_evasion_via_time_changes",
      "teamviewer_session_hijacking",
      "c2_agent_upload_via_remote_access"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Social Engineering via IT Support Impersonation",
        "success_reason": "New employee trusted caller claiming to be IT department",
        "prerequisite_indicators": [
          "new_employee_target",
          "legitimate_sounding_pretext",
          "authority_impersonation"
        ],
        "recognition_patterns": [
          "unsolicited IT support calls",
          "requests for remote access",
          "urgency or authority pressure"
        ],
        "failure_modes": [
          "employee_verification_procedures",
          "security_awareness_training",
          "callback_verification_required"
        ],
        "environmental_factors": [
          "lack_of_security_awareness",
          "no_verification_procedures",
          "new_employee_vulnerability"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-30 minutes"
      },
      {
        "technique": "TeamViewer Remote Access",
        "success_reason": "Legitimate remote access tool bypassed security controls",
        "prerequisite_indicators": [
          "teamviewer_installed",
          "user_cooperation_obtained",
          "network_connectivity_available"
        ],
        "recognition_patterns": [
          "teamviewer_process_execution",
          "incoming_remote_connections",
          "session_establishment_logs"
        ],
        "failure_modes": [
          "application_whitelisting",
          "remote_access_tool_blocking",
          "user_refuses_connection"
        ],
        "environmental_factors": [
          "legitimate_tool_abuse",
          "no_remote_access_restrictions",
          "user_trust_established"
        ],
        "success_probability": 0.9,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "Merlin C2 Agent Deployment",
        "success_reason": "C2 agent uploaded via established remote access session",
        "prerequisite_indicators": [
          "remote_access_established",
          "file_transfer_capability",
          "execution_permissions_available"
        ],
        "recognition_patterns": [
          "merlin.exe_file_creation",
          "c2_callback_connections",
          "defender_detection_alerts"
        ],
        "failure_modes": [
          "antivirus_real_time_protection",
          "application_whitelisting",
          "network_egress_filtering"
        ],
        "environmental_factors": [
          "windows_defender_present_but_bypassed",
          "network_egress_allowed",
          "user_execution_context"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "1-3 minutes"
      },
      {
        "technique": "Time Manipulation for Forensic Evasion",
        "success_reason": "PowerShell script repeatedly changed system time to confuse timeline analysis",
        "prerequisite_indicators": [
          "administrative_privileges_obtained",
          "powershell_execution_allowed",
          "system_time_change_permissions"
        ],
        "recognition_patterns": [
          "invoke-timewizard.ps1_execution",
          "multiple_time_change_events",
          "timeline_inconsistencies_in_logs"
        ],
        "failure_modes": [
          "time_change_restrictions",
          "powershell_execution_policy",
          "privilege_escalation_failure"
        ],
        "environmental_factors": [
          "powershell_execution_policy_bypass",
          "user_has_time_change_privileges",
          "no_time_synchronization_enforcement"
        ],
        "success_probability": 0.8,
        "typical_timeframe": "ongoing throughout attack"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "TeamViewer session establishment",
        "discovery_method": "TeamViewer log analysis",
        "why_critical": "Provided initial access vector and remote control capability",
        "how_to_recognize": [
          "teamviewer_logfile_entries",
          "session_id_-2102926010",
          "participant_fritjof_olfasson"
        ],
        "follow_up_actions": [
          "analyze_teamviewer_logs",
          "check_network_connections",
          "identify_remote_participant"
        ]
      },
      {
        "discovery": "merlin.exe C2 agent",
        "discovery_method": "File transfer logs in TeamViewer",
        "why_critical": "Established persistent command and control channel",
        "how_to_recognize": [
          "file_write_to_desktop",
          "10.95_mb_executable",
          "c2_callback_connections"
        ],
        "follow_up_actions": [
          "hash_analysis",
          "network_traffic_analysis",
          "defender_alert_correlation"
        ]
      },
      {
        "discovery": "Invoke-TimeWizard.ps1 script",
        "discovery_method": "PowerShell console history",
        "why_critical": "Anti-forensics technique to disrupt timeline analysis",
        "how_to_recognize": [
          "powershell_history_entries",
          "execution_policy_bypass",
          "time_manipulation_script"
        ],
        "follow_up_actions": [
          "analyze_time_change_events",
          "correlate_timeline_discrepancies",
          "check_system_event_logs"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "user_context",
        "escalation_method": "social_engineering_to_remote_access",
        "why_possible": "User willingly granted remote access believing it was legitimate IT support",
        "recognition_signs": [
          "teamviewer_session_logs",
          "user_initiated_connection",
          "no_authentication_challenges"
        ],
        "exploitation_path": "Phone Call → TeamViewer Access → File Upload → C2 Deployment"
      },
      {
        "privilege_level": "remote_access",
        "escalation_method": "c2_agent_deployment",
        "why_possible": "Remote access allowed file upload and execution capabilities",
        "recognition_signs": [
          "file_transfer_via_teamviewer",
          "executable_dropped_to_desktop",
          "c2_callback_connections"
        ],
        "exploitation_path": "Remote Access → File Upload → C2 Agent → Persistent Access"
      },
      {
        "privilege_level": "user_privileges",
        "escalation_method": "anti_forensics_deployment",
        "why_possible": "User context allowed PowerShell execution and system time changes",
        "recognition_signs": [
          "powershell_execution_policy_bypass",
          "time_change_permissions",
          "script_execution_capability"
        ],
        "exploitation_path": "User Access → PowerShell Execution → Time Manipulation → Forensic Evasion"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found TeamViewer logs with remote connection and file transfer",
        "decision": "Analyze TeamViewer session logs for C2 deployment indicators",
        "reasoning": "Remote access tools commonly used for initial access and C2 deployment",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "check_event_logs",
            "when": "if teamviewer logs incomplete"
          },
          {
            "option": "analyze_mft",
            "when": "if file timeline needed"
          }
        ],
        "success_indicators": [
          "session_id_found",
          "file_transfer_logged",
          "remote_participant_identified"
        ],
        "next_decision": "identify_transferred_executable"
      },
      {
        "step": 2,
        "situation": "Found merlin.exe transferred via TeamViewer",
        "decision": "Identify as Merlin C2 agent and check for execution artifacts",
        "reasoning": "Merlin is known C2 framework, file transfer indicates deployment",
        "confidence": 0.9,
        "prerequisites": [
          "file_transfer_confirmed",
          "executable_identified"
        ],
        "success_indicators": [
          "process_execution_found",
          "network_connections_established"
        ],
        "failure_fallbacks": [
          "check_defender_logs",
          "analyze_powershell_history"
        ]
      },
      {
        "step": 3,
        "situation": "Time manipulation detected in logs",
        "decision": "Correlate events using multiple timestamp sources",
        "reasoning": "Attackers manipulating time to evade forensics",
        "confidence": 0.85,
        "alternatives": [
          {
            "option": "use_mft_timestamps",
            "when": "if event_log_times_unreliable"
          },
          {
            "option": "cross_reference_defender_logs",
            "when": "if_available"
          }
        ],
        "success_indicators": [
          "powershell_script_identified",
          "time_changes_counted"
        ],
        "next_decision": "analyze_privilege_escalation_attempts"
      }
    ],
    "branching_logic": {
      "if_remote_access_found": {
        "action": "analyze_file_transfers_and_commands",
        "tools": [
          "log_analysis",
          "timeline_correlation"
        ],
        "next_phase": "c2_identification"
      },
      "if_c2_identified": {
        "action": "trace_execution_and_persistence",
        "alternatives": [
          "event_logs",
          "mft_analysis",
          "registry_analysis"
        ],
        "decision_criteria": "based_on_available_artifacts"
      },
      "if_time_manipulation_detected": {
        "action": "use_alternative_timestamp_sources",
        "purpose": "establish_accurate_timeline",
        "tools": [
          "mft_analysis",
          "multiple_log_correlation"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "prioritize_remote_access_logs_for_initial_access",
        "reasoning": "remote_access_tools_primary_vector_for_c2_deployment",
        "applicability": "social_engineering_scenarios"
      },
      {
        "rule": "cross_correlate_timestamps_when_time_manipulation_suspected",
        "reasoning": "attackers_commonly_manipulate_time_for_evasion",
        "applicability": "forensic_evasion_detected"
      },
      {
        "rule": "analyze_powershell_history_for_post_exploitation_activities",
        "reasoning": "powershell_commonly_used_for_system_manipulation",
        "applicability": "windows_environments_with_c2_presence"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Remote Access Tool Deployment",
        "mitre_id": "T1219",
        "required_services": [
          "teamviewer",
          "remote_desktop"
        ],
        "required_ports": [
          5938,
          3389
        ],
        "os_requirements": [
          "windows",
          "linux",
          "macos"
        ],
        "environmental_prerequisites": [
          "social_engineering_success",
          "user_interaction_available",
          "outbound_internet_access"
        ],
        "success_indicators": [
          "teamviewer_logs_present",
          "session_establishment_logged",
          "participant_connections_recorded"
        ],
        "incompatible_with": [
          "application_whitelisting_strict",
          "outbound_connections_blocked",
          "user_awareness_high"
        ],
        "confidence_boosters": [
          "legitimate_software_abuse",
          "it_support_pretext",
          "established_trust_relationship"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "Command and Control Agent",
        "mitre_id": "T1071.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "initial_access_established",
          "execution_privileges_obtained",
          "network_connectivity_available"
        ],
        "success_indicators": [
          "c2_binary_uploaded",
          "callback_connections_established",
          "defender_detection_triggered"
        ],
        "incompatible_with": [
          "egress_filtering_strict",
          "endpoint_protection_blocking",
          "network_monitoring_active"
        ],
        "confidence_boosters": [
          "merlin_c2_framework",
          "powershell_execution_available",
          "administrative_access"
        ],
        "typical_success_rate": 0.82,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "Time Manipulation",
        "mitre_id": "T1070.006",
        "required_services": [
          "windows_time_service"
        ],
        "required_ports": [],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "administrative_privileges",
          "powershell_execution_enabled",
          "system_time_modification_allowed"
        ],
        "success_indicators": [
          "powershell_time_script_executed",
          "system_time_changes_logged",
          "forensic_timeline_disrupted"
        ],
        "incompatible_with": [
          "time_synchronization_enforced",
          "privilege_restrictions_active",
          "powershell_execution_blocked"
        ],
        "confidence_boosters": [
          "invoke_timewizard_script",
          "multiple_time_changes",
          "forensic_evasion_intent"
        ],
        "typical_success_rate": 0.9,
        "estimated_time": "2-5 minutes"
      }
    ],
    "environmental_detectors": {
      "windows_workstation": {
        "port_indicators": [
          135,
          139,
          445,
          3389,
          5985
        ],
        "service_indicators": [
          "smb",
          "rpc",
          "winrm",
          "rdp"
        ],
        "banner_indicators": [
          "Windows",
          "Microsoft"
        ],
        "confidence_threshold": 0.9
      },
      "remote_access_software": {
        "port_indicators": [
          5938,
          5939,
          3389
        ],
        "service_indicators": [
          "teamviewer",
          "rdp",
          "vnc"
        ],
        "process_indicators": [
          "TeamViewer.exe",
          "mstsc.exe"
        ],
        "confidence_threshold": 0.85
      },
      "powershell_environment": {
        "port_indicators": [
          5985,
          5986
        ],
        "service_indicators": [
          "winrm",
          "powershell"
        ],
        "file_indicators": [
          "ConsoleHost_history.txt",
          ".ps1"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "social_engineering_remote_access",
          "when": "user_interaction_available",
          "reason": "high_success_rate_with_pretext"
        },
        {
          "attack": "legitimate_tool_abuse",
          "when": "remote_access_software_detected",
          "reason": "bypasses_security_controls"
        }
      ],
      "medium_priority": [
        {
          "attack": "c2_deployment",
          "when": "initial_access_established",
          "reason": "requires_prior_compromise"
        },
        {
          "attack": "time_manipulation",
          "when": "administrative_access_gained",
          "reason": "forensic_evasion_technique"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Remote Access Tool Deployment",
        "mitre_id": "T1219",
        "category": "command_and_control",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "TeamViewer",
            "command_template": "TeamViewer remote session establishment",
            "actual_command": "TeamViewer session ID: -2102926010",
            "output_pattern": "SessionManagerDesktop::IncomingConnection: Connection incoming, sessionID = {session_id}",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "Merlin C2 Agent",
            "command_template": "File transfer via remote access tool",
            "actual_command": "Write file C:\\Users\\gladys\\Desktop\\merlin.exe",
            "success_factors": [
              "legitimate_remote_access_tool",
              "social_engineering_success"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "social_engineering_success",
          "victim_cooperation",
          "teamviewer_installed"
        ],
        "success_indicators": [
          "remote_session_established",
          "file_transfer_completed",
          "c2_agent_deployed"
        ],
        "common_failures": [
          "victim_suspicion",
          "security_software_detection",
          "network_restrictions"
        ],
        "follow_up_techniques": [
          "c2_communication",
          "time_manipulation",
          "bitlocker_password_setting"
        ],
        "time_investment": "15-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "System Time Manipulation",
        "mitre_id": "T1070.006",
        "category": "defense_evasion",
        "phase": "defense_evasion",
        "tools_used": [
          {
            "name": "Invoke-TimeWizard.ps1",
            "command_template": ".\\Invoke-TimeWizard.ps1",
            "actual_command": ".\\Invoke-TimeWizard.ps1",
            "output_pattern": "Time jumps in logs and timestamps",
            "effectiveness_rating": 4,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "administrative_privileges",
          "powershell_execution_policy_bypass"
        ],
        "success_indicators": [
          "inconsistent_timestamps_in_logs",
          "time_jumps_observed",
          "forensic_timeline_disruption"
        ],
        "common_failures": [
          "insufficient_privileges",
          "execution_policy_restrictions",
          "security_monitoring_detection"
        ],
        "follow_up_techniques": [
          "log_tampering",
          "artifact_cleanup",
          "persistence_establishment"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Social Engineering via IT Support Impersonation",
        "mitre_id": "T1566.004",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "Phone Call",
            "command_template": "Direct victim contact impersonating IT support",
            "actual_command": "Phone call to victim requesting remote access",
            "output_pattern": "Victim initiates TeamViewer connection",
            "effectiveness_rating": 5,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "victim_contact_information",
          "believable_pretext",
          "social_engineering_skills"
        ],
        "success_indicators": [
          "victim_cooperation",
          "remote_access_granted",
          "trust_establishment"
        ],
        "common_failures": [
          "victim_verification_attempts",
          "security_awareness_training",
          "suspicious_victim_behavior"
        ],
        "follow_up_techniques": [
          "remote_access_tool_deployment",
          "malware_installation",
          "credential_harvesting"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "TeamViewer",
        "use_case": "legitimate_remote_access_for_malicious_purposes",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "social_engineering_attacks",
          "remote_access_scenarios"
        ],
        "alternatives": [
          "anydesk",
          "chrome_remote_desktop",
          "rdp"
        ],
        "best_practices": [
          "use_legitimate_software_to_avoid_detection",
          "establish_trust_through_social_engineering",
          "maintain_session_for_file_transfers"
        ]
      },
      {
        "tool": "Merlin C2",
        "use_case": "command_and_control_agent",
        "effectiveness_rating": 4,
        "reliability": 0.88,
        "learning_curve": "medium",
        "essential_for": [
          "persistent_access",
          "command_execution"
        ],
        "alternatives": [
          "cobalt_strike",
          "metasploit",
          "empire"
        ],
        "best_practices": [
          "deploy_via_trusted_channels",
          "use_time_manipulation_for_evasion",
          "establish_persistence_mechanisms"
        ]
      },
      {
        "tool": "PowerShell Time Manipulation",
        "use_case": "forensic_timeline_disruption",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "anti_forensics",
          "log_tampering"
        ],
        "alternatives": [
          "timestomp",
          "manual_time_changes",
          "registry_manipulation"
        ],
        "best_practices": [
          "change_time_multiple_times",
          "coordinate_with_malicious_activities",
          "restore_time_to_avoid_suspicion"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "social_engineering_to_c2_deployment",
        "steps": [
          {
            "step": 1,
            "command": "Phone call impersonating IT support",
            "purpose": "Establish trust and request remote access",
            "expected_output": "Victim agrees to TeamViewer session"
          },
          {
            "step": 2,
            "command": "TeamViewer session establishment",
            "purpose": "Gain remote access to victim machine",
            "expected_output": "Session ID -2102926010 established at 11:35:27"
          },
          {
            "step": 3,
            "command": "Write file C:\\Users\\gladys\\Desktop\\merlin.exe",
            "purpose": "Deploy C2 agent",
            "expected_output": "10.95 MB merlin.exe transferred successfully"
          },
          {
            "step": 4,
            "command": "set-executionpolicy bypass",
            "purpose": "Allow PowerShell script execution",
            "expected_output": "Execution policy changed"
          },
          {
            "step": 5,
            "command": ".\\Invoke-TimeWizard.ps1",
            "purpose": "Manipulate system time for evasion",
            "expected_output": "System time changes, log timestamps disrupted"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "30-45 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Tick Tock",
      "difficulty": "Medium",
      "os": "Windows",
      "platform": "HackTheBox Sherlock",
      "release_date": "2023-11-13",
      "author": "blitztide",
      "estimated_time": "90-120 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "social_engineering",
        "remote_access",
        "c2_communication"
      ],
      "key_vulnerabilities": [
        "human_factor",
        "remote_access_tools",
        "time_manipulation"
      ],
      "environment_type": "corporate_endpoint",
      "real_world_relevance": "very_high",
      "learning_value": [
        "dfir_analysis",
        "c2_detection",
        "timeline_analysis",
        "social_engineering_tactics"
      ],
      "prerequisite_knowledge": [
        "windows_forensics",
        "event_log_analysis",
        "c2_frameworks",
        "teamviewer_artifacts"
      ]
    },
    "categorization": {
      "primary_category": "digital_forensics",
      "subcategories": [
        "incident_response",
        "malware_analysis",
        "social_engineering"
      ],
      "attack_types": [
        "initial_access",
        "command_and_control",
        "defense_evasion"
      ],
      "defensive_lessons": [
        "user_awareness_training",
        "remote_access_monitoring",
        "time_sync_monitoring",
        "endpoint_detection"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Knock Knock",
        "Campfire-1",
        "OpTinselTrace-1"
      ],
      "similarity_reasons": [
        "dfir_focus",
        "social_engineering",
        "c2_analysis",
        "windows_forensics"
      ],
      "unique_aspects": [
        "time_manipulation_evasion",
        "merlin_c2_framework",
        "teamviewer_compromise",
        "bitlocker_interaction"
      ],
      "difficulty_factors": [
        "timeline_reconstruction",
        "artifact_correlation",
        "anti_forensics_techniques"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-05T00:21:02.775089",
    "original_file": "0xdf_writeups/Htb Sherlock Tick Tock.md",
    "content_length": 77500,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}