{
  "writeup_id": "Htb_Streamio",
  "scenario_fingerprint": {
    "scenario_name": "windows_domain_controller_web_sqli_rfi",
    "primary_services": [
      "http",
      "https",
      "mssql",
      "ldap",
      "smb",
      "kerberos",
      "dns"
    ],
    "port_signature": "53+80+88+135+389+443+445+5985",
    "service_combination": "dns+http+https+kerberos+ldap+smb+winrm",
    "os_family": "windows_server",
    "environment_type": "active_directory",
    "entry_vector": "sql_injection_to_rfi",
    "privilege_path": "web_sqli_to_db_access_to_firefox_creds_to_laps",
    "attack_complexity": "medium",
    "estimated_time": "2-3 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "php_on_windows_with_mssql",
      "hidden_debug_parameter_lfi",
      "remote_file_include_capability",
      "firefox_saved_credentials",
      "laps_password_access"
    ],
    "environmental_clues": [
      "domain_controller_services",
      "iis_with_php_backend",
      "mssql_database_backend",
      "multiple_subdomains_ssl_cert",
      "backup_database_tables"
    ],
    "similar_scenarios": [
      "forest_htb_hard",
      "blackfield_htb_hard"
    ],
    "unique_aspects": [
      "php_windows_mssql_combination",
      "debug_parameter_file_inclusion",
      "firefox_credential_extraction",
      "laps_privilege_escalation"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "SQL_Injection",
        "success_reason": "Web application vulnerable to SQL injection in login form",
        "prerequisite_indicators": [
          "php_application_with_database",
          "user_input_not_sanitized",
          "mssql_backend_accessible"
        ],
        "recognition_patterns": [
          "error messages revealing database type",
          "time-based blind injection responses",
          "union-based injection success",
          "authentication bypass possible"
        ],
        "failure_modes": [
          "input_sanitization_implemented",
          "waf_blocking_payloads",
          "database_user_low_privileges"
        ],
        "environmental_factors": [
          "php_with_mssql_backend",
          "legacy_application_code",
          "insufficient_input_validation"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "15-45 minutes"
      },
      {
        "technique": "Remote_File_Include",
        "success_reason": "Hidden debug parameter allows file inclusion with insufficient filtering",
        "prerequisite_indicators": [
          "php_application_present",
          "file_inclusion_functionality",
          "debug_parameters_enabled"
        ],
        "recognition_patterns": [
          "debug parameter in source code",
          "file inclusion errors in responses",
          "ability to include remote files",
          "php execution context available"
        ],
        "failure_modes": [
          "file_inclusion_properly_filtered",
          "debug_mode_disabled",
          "network_restrictions_block_rfi"
        ],
        "environmental_factors": [
          "development_debug_code_in_production",
          "insufficient_path_validation",
          "php_allow_url_include_enabled"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "Database_Credential_Extraction",
        "success_reason": "High privileged database access revealed additional credentials in backup tables",
        "prerequisite_indicators": [
          "database_access_obtained",
          "elevated_database_privileges",
          "backup_tables_present"
        ],
        "recognition_patterns": [
          "db_datareader and db_datawriter roles",
          "backup table naming patterns",
          "plaintext passwords in database",
          "additional user accounts discovered"
        ],
        "failure_modes": [
          "database_user_low_privileges",
          "passwords_properly_hashed",
          "no_backup_data_available"
        ],
        "environmental_factors": [
          "poor_database_security_practices",
          "plaintext_password_storage",
          "excessive_database_privileges"
        ],
        "success_probability": 0.8,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Firefox_Credential_Extraction",
        "success_reason": "User had saved credentials in Firefox browser with accessible profile",
        "prerequisite_indicators": [
          "user_shell_access_obtained",
          "firefox_installed_and_used",
          "saved_credentials_present"
        ],
        "recognition_patterns": [
          "firefox profile directory accessible",
          "logins.json and key4.db files present",
          "credentials can be decrypted",
          "administrative credentials stored"
        ],
        "failure_modes": [
          "firefox_not_used",
          "master_password_set",
          "no_saved_credentials"
        ],
        "environmental_factors": [
          "user_saves_passwords_in_browser",
          "no_master_password_configured",
          "administrative_accounts_saved"
        ],
        "success_probability": 0.45,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "LAPS_Password_Access",
        "success_reason": "Compromised account had permissions to read LAPS administrator password",
        "prerequisite_indicators": [
          "laps_deployed_in_environment",
          "account_has_laps_read_permissions",
          "active_directory_accessible"
        ],
        "recognition_patterns": [
          "ms-Mcs-AdmPwd attribute readable",
          "LAPS administrative account exists",
          "current password retrievable",
          "local administrator access possible"
        ],
        "failure_modes": [
          "laps_not_deployed",
          "insufficient_permissions_for_laps",
          "laps_password_recently_rotated"
        ],
        "environmental_factors": [
          "laps_properly_deployed",
          "account_permissions_misconfigured",
          "active_directory_integrated"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "5-10 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "SQL injection in login form",
        "discovery_method": "Manual testing of authentication bypass",
        "why_critical": "Provided admin access to web application and database",
        "how_to_recognize": [
          "authentication bypass with SQL payloads",
          "database error messages",
          "time delays in responses"
        ],
        "follow_up_actions": [
          "enumerate_database_structure",
          "extract_user_credentials",
          "identify_additional_attack_vectors"
        ]
      },
      {
        "discovery": "Hidden debug parameter for file inclusion",
        "discovery_method": "Source code analysis and parameter fuzzing",
        "why_critical": "Enabled remote file inclusion leading to code execution",
        "how_to_recognize": [
          "debug parameters in source code",
          "file inclusion functionality",
          "remote file access capability"
        ],
        "follow_up_actions": [
          "test_remote_file_inclusion",
          "upload_php_webshell",
          "establish_reverse_shell"
        ]
      },
      {
        "discovery": "Database backup table with plaintext passwords",
        "discovery_method": "Database enumeration with elevated privileges",
        "why_critical": "Revealed additional user credentials for lateral movement",
        "how_to_recognize": [
          "backup table naming patterns",
          "plaintext password storage",
          "additional user accounts"
        ],
        "follow_up_actions": [
          "test_credentials_across_services",
          "attempt_winrm_access",
          "enumerate_user_privileges"
        ]
      },
      {
        "discovery": "Firefox saved credentials",
        "discovery_method": "Browser profile enumeration and credential extraction",
        "why_critical": "Contained administrative credentials for privilege escalation",
        "how_to_recognize": [
          "firefox profile directory present",
          "logins.json and key4.db files",
          "decryptable saved passwords"
        ],
        "follow_up_actions": [
          "extract_all_saved_credentials",
          "test_administrative_access",
          "check_laps_permissions"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "web_application_admin",
        "escalation_method": "SQL_injection_to_RFI",
        "why_possible": "Debug parameter allowed remote file inclusion after gaining admin access",
        "recognition_signs": [
          "admin_panel_access_obtained",
          "debug_functionality_available",
          "file_inclusion_parameters_present"
        ],
        "exploitation_path": "SQL injection → Admin access → Debug RFI → Code execution"
      },
      {
        "privilege_level": "low_privileged_user",
        "escalation_method": "Database_credentials_to_user_shell",
        "why_possible": "Backup table contained plaintext credentials for domain user",
        "recognition_signs": [
          "database_backup_tables_accessible",
          "plaintext_passwords_stored",
          "winrm_service_available"
        ],
        "exploitation_path": "Database access → Backup table → User credentials → WinRM shell"
      },
      {
        "privilege_level": "domain_user",
        "escalation_method": "Firefox_credentials_to_LAPS_admin",
        "why_possible": "User saved administrative credentials in Firefox browser",
        "recognition_signs": [
          "firefox_profile_accessible",
          "saved_credentials_present",
          "laps_read_permissions_available"
        ],
        "exploitation_path": "User shell → Firefox credentials → LAPS password → Administrator"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 53,88,389,445 open on Windows host",
        "decision": "Identify as Domain Controller and enumerate web services first",
        "reasoning": "Port combination indicates AD DC, but web services (80,443) present unusual attack surface",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "kerberos_enumeration",
            "when": "if web enumeration fails"
          },
          {
            "option": "smb_enumeration",
            "when": "if credentials obtained"
          },
          {
            "option": "ldap_enumeration",
            "when": "if anonymous access available"
          }
        ],
        "success_indicators": [
          "web_application_accessible",
          "domain_name_discovered",
          "technology_stack_identified"
        ],
        "next_decision": "analyze_web_application_attack_surface"
      },
      {
        "step": 2,
        "situation": "Found PHP web application with login/register functionality",
        "decision": "Test for SQL injection in authentication forms",
        "reasoning": "PHP+MSSQL combination often vulnerable to SQLi, auth forms are high-value targets",
        "confidence": 0.85,
        "prerequisites": [
          "web_application_identified",
          "login_forms_found"
        ],
        "success_indicators": [
          "sql_error_messages",
          "authentication_bypass",
          "data_extraction"
        ],
        "failure_fallbacks": [
          "directory_traversal",
          "file_inclusion",
          "credential_brute_force"
        ]
      },
      {
        "step": 3,
        "situation": "SQL injection successful, admin access obtained",
        "decision": "Enumerate hidden functionality and debug parameters",
        "reasoning": "Admin access may reveal additional attack surface not visible to regular users",
        "confidence": 0.8,
        "prerequisites": [
          "admin_access_obtained"
        ],
        "success_indicators": [
          "hidden_parameters_found",
          "debug_functionality_discovered"
        ],
        "failure_fallbacks": [
          "file_upload_attempts",
          "command_injection_tests"
        ]
      },
      {
        "step": 4,
        "situation": "Found file inclusion vulnerability in debug parameter",
        "decision": "Escalate to remote file inclusion for code execution",
        "reasoning": "RFI provides direct path to shell access on Windows/IIS environment",
        "confidence": 0.9,
        "prerequisites": [
          "file_inclusion_confirmed",
          "external_hosting_available"
        ],
        "success_indicators": [
          "remote_code_execution",
          "web_shell_deployed"
        ],
        "failure_fallbacks": [
          "local_file_inclusion",
          "log_poisoning"
        ]
      }
    ],
    "branching_logic": {
      "if_domain_controller_identified": {
        "action": "prioritize_web_enumeration_over_ad_attacks",
        "reasoning": "web_services_unusual_on_dc_high_value_target",
        "next_phase": "web_application_testing"
      },
      "if_sql_injection_succeeds": {
        "action": "extract_credentials_and_explore_admin_functions",
        "tools": [
          "sqlmap",
          "burp_suite"
        ],
        "next_phase": "privilege_escalation_via_web"
      },
      "if_rfi_achieved": {
        "action": "deploy_webshell_and_enumerate_system",
        "tools": [
          "php_webshell",
          "powershell_enumeration"
        ],
        "next_phase": "local_privilege_escalation"
      },
      "if_initial_foothold_obtained": {
        "action": "enumerate_database_and_saved_credentials",
        "purpose": "find_additional_user_accounts",
        "tools": [
          "database_queries",
          "firefox_credential_extraction"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "prioritize_web_attacks_on_domain_controllers",
        "reasoning": "unusual_attack_surface_likely_less_hardened",
        "applicability": "domain_controller_with_web_services"
      },
      {
        "rule": "test_sql_injection_before_complex_ad_attacks",
        "reasoning": "faster_path_to_initial_access",
        "applicability": "web_application_with_database_backend"
      },
      {
        "rule": "explore_admin_functionality_after_authentication_bypass",
        "reasoning": "hidden_features_often_contain_additional_vulnerabilities",
        "applicability": "admin_access_obtained_via_sqli"
      },
      {
        "rule": "check_firefox_saved_credentials_on_windows_compromise",
        "reasoning": "often_contains_high_privilege_account_passwords",
        "applicability": "user_account_compromise_on_windows"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "SQL Injection",
        "mitre_id": "T1190",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "windows",
          "linux"
        ],
        "environmental_prerequisites": [
          "web_application_present",
          "database_backend_detected",
          "user_input_parameters"
        ],
        "success_indicators": [
          "error_messages_revealed",
          "database_version_disclosed",
          "authentication_bypass_achieved"
        ],
        "incompatible_with": [
          "parameterized_queries_only",
          "input_validation_strict",
          "waf_blocking_payloads"
        ],
        "confidence_boosters": [
          "php_application_detected",
          "mssql_backend_identified",
          "login_forms_present"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "15-45 minutes"
      },
      {
        "technique": "Remote File Inclusion",
        "mitre_id": "T1105",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "windows",
          "linux"
        ],
        "environmental_prerequisites": [
          "php_application_detected",
          "file_inclusion_parameters",
          "debug_parameters_accessible"
        ],
        "success_indicators": [
          "remote_file_executed",
          "code_execution_achieved",
          "reverse_shell_obtained"
        ],
        "incompatible_with": [
          "allow_url_include_disabled",
          "strict_file_path_validation",
          "network_egress_blocked"
        ],
        "confidence_boosters": [
          "hidden_debug_parameters",
          "php_include_functions_used",
          "file_parameter_names"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "20-60 minutes"
      },
      {
        "technique": "LAPS Password Extraction",
        "mitre_id": "T1552.004",
        "required_services": [
          "ldap"
        ],
        "required_ports": [
          389,
          636
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "laps_deployed",
          "privileged_user_access"
        ],
        "success_indicators": [
          "laps_attributes_readable",
          "administrator_password_retrieved",
          "local_admin_access_gained"
        ],
        "incompatible_with": [
          "laps_not_deployed",
          "insufficient_privileges",
          "laps_attributes_protected"
        ],
        "confidence_boosters": [
          "domain_controller_identified",
          "privileged_service_account",
          "ldap_enumeration_successful"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "5-15 minutes"
      },
      {
        "technique": "Firefox Credential Extraction",
        "mitre_id": "T1555.003",
        "required_services": [
          "smb",
          "winrm"
        ],
        "required_ports": [
          445,
          5985
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "user_shell_access",
          "firefox_installed",
          "saved_credentials_present"
        ],
        "success_indicators": [
          "firefox_profile_accessible",
          "credentials_database_readable",
          "passwords_extracted"
        ],
        "incompatible_with": [
          "firefox_not_installed",
          "master_password_protected",
          "profile_encrypted"
        ],
        "confidence_boosters": [
          "user_desktop_access",
          "firefox_recently_used",
          "multiple_saved_logins"
        ],
        "typical_success_rate": 0.7,
        "estimated_time": "10-20 minutes"
      }
    ],
    "environmental_detectors": {
      "active_directory": {
        "port_indicators": [
          53,
          88,
          389,
          445,
          636,
          3268,
          3269,
          5985,
          9389
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns",
          "winrm"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server",
          "Domain Controller"
        ],
        "confidence_threshold": 0.9
      },
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https",
          "iis"
        ],
        "technology_indicators": [
          "php",
          "mssql",
          "iis"
        ],
        "confidence_threshold": 0.85
      },
      "windows_domain_controller": {
        "port_indicators": [
          53,
          88,
          135,
          139,
          389,
          445,
          464,
          593,
          636,
          3268,
          5985
        ],
        "service_indicators": [
          "kerberos-sec",
          "ldap",
          "microsoft-ds",
          "msrpc"
        ],
        "banner_indicators": [
          "Windows",
          "Kerberos",
          "LDAP"
        ],
        "confidence_threshold": 0.95
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "sql_injection",
          "when": "web_application_detected_with_database",
          "reason": "direct_path_to_admin_access"
        },
        {
          "attack": "smb_enumeration",
          "when": "active_directory_detected",
          "reason": "often_reveals_shares_and_users"
        }
      ],
      "medium_priority": [
        {
          "attack": "remote_file_inclusion",
          "when": "php_application_with_parameters",
          "reason": "leads_to_code_execution"
        },
        {
          "attack": "laps_extraction",
          "when": "privileged_ad_access_gained",
          "reason": "provides_local_admin_access"
        }
      ],
      "low_priority": [
        {
          "attack": "firefox_credential_extraction",
          "when": "user_shell_access_obtained",
          "reason": "depends_on_user_behavior"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "SQL Injection",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "manual_injection",
            "command_template": "POST request with SQL payload in login form",
            "actual_command": "SQL injection in login.php form fields",
            "output_pattern": "admin access to website",
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "vulnerable_web_application",
          "accessible_login_form",
          "database_backend"
        ],
        "success_indicators": [
          "authentication_bypass_successful",
          "admin_panel_access_gained",
          "database_queries_executed"
        ],
        "common_failures": [
          "input_sanitization_present",
          "prepared_statements_used",
          "web_application_firewall"
        ],
        "follow_up_techniques": [
          "file_inclusion_exploitation",
          "database_enumeration",
          "privilege_escalation"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Remote File Inclusion",
        "mitre_id": "T1105",
        "category": "execution",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "debug_parameter_exploitation",
            "command_template": "GET request with debug parameter pointing to remote file",
            "actual_command": "Hidden debug parameter with file include vulnerability",
            "output_pattern": "remote_code_execution",
            "effectiveness_rating": 5,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "file_inclusion_vulnerability",
          "debug_parameter_accessible",
          "remote_file_hosting_capability"
        ],
        "success_indicators": [
          "remote_file_included_successfully",
          "code_execution_achieved",
          "reverse_shell_established"
        ],
        "common_failures": [
          "file_extension_restrictions",
          "path_traversal_blocked",
          "network_connectivity_issues"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "credential_harvesting",
          "lateral_movement"
        ],
        "time_investment": "15-45 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Database Credential Extraction",
        "mitre_id": "T1555.001",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "mssql_queries",
            "command_template": "SELECT * FROM backup_table WHERE credential_column IS NOT NULL",
            "actual_command": "Database queries to extract stored credentials from backup tables",
            "output_pattern": "plaintext_passwords_discovered",
            "effectiveness_rating": 4,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "database_access_obtained",
          "high_privilege_db_user",
          "backup_tables_present"
        ],
        "success_indicators": [
          "additional_credentials_found",
          "user_account_access_gained",
          "privilege_escalation_path_identified"
        ],
        "common_failures": [
          "credentials_encrypted",
          "no_backup_data_available",
          "insufficient_database_privileges"
        ],
        "follow_up_techniques": [
          "firefox_credential_extraction",
          "laps_password_retrieval",
          "lateral_movement"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Firefox Credential Harvesting",
        "mitre_id": "T1555.003",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "firefox_profile_extraction",
            "command_template": "Access Firefox profile directory and extract saved credentials",
            "actual_command": "Extract credentials from Firefox profile files",
            "output_pattern": "saved_browser_credentials",
            "effectiveness_rating": 4,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "user_account_access",
          "firefox_installed_with_saved_credentials",
          "profile_directory_accessible"
        ],
        "success_indicators": [
          "firefox_credentials_extracted",
          "additional_account_access",
          "administrative_credentials_found"
        ],
        "common_failures": [
          "master_password_protected",
          "no_saved_credentials",
          "profile_encryption_enabled"
        ],
        "follow_up_techniques": [
          "laps_password_access",
          "administrative_access",
          "domain_privilege_escalation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "LAPS Password Retrieval",
        "mitre_id": "T1552.001",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "laps_query",
            "command_template": "Query LAPS password attribute from Active Directory",
            "actual_command": "LDAP query to retrieve ms-Mcs-AdmPwd attribute",
            "output_pattern": "administrator_password_plaintext",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "laps_deployed_environment",
          "sufficient_ad_privileges",
          "target_computer_laps_enabled"
        ],
        "success_indicators": [
          "laps_password_retrieved",
          "administrator_access_gained",
          "full_system_compromise"
        ],
        "common_failures": [
          "insufficient_privileges",
          "laps_not_deployed",
          "password_recently_rotated"
        ],
        "follow_up_techniques": [
          "administrator_shell_access",
          "domain_persistence",
          "lateral_movement"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "feroxbuster",
        "use_case": "web_directory_enumeration",
        "effectiveness_rating": 4,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "web_application_testing"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "use_appropriate_extensions_for_technology_stack",
          "use_case_insensitive_wordlists_for_iis",
          "include_recursive_scanning_for_deep_enumeration"
        ]
      },
      {
        "tool": "crackmapexec",
        "use_case": "smb_enumeration_and_authentication",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "medium",
        "essential_for": [
          "windows_domain_environments"
        ],
        "alternatives": [
          "smbclient",
          "enum4linux",
          "rpcclient"
        ],
        "best_practices": [
          "use_for_initial_smb_reconnaissance",
          "identify_hostname_and_domain_information",
          "test_authentication_with_discovered_credentials"
        ]
      },
      {
        "tool": "evil-winrm",
        "use_case": "windows_remote_management_access",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "windows_post_exploitation"
        ],
        "alternatives": [
          "winrm",
          "powershell_remoting"
        ],
        "best_practices": [
          "use_with_valid_domain_credentials",
          "leverage_for_post_exploitation_activities",
          "combine_with_credential_harvesting_techniques"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "web_to_system_compromise",
        "steps": [
          {
            "step": 1,
            "command": "feroxbuster -u https://streamio.htb -x php -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -k",
            "purpose": "Enumerate web directories and files",
            "expected_output": "Discovery of admin panel and login pages"
          },
          {
            "step": 2,
            "command": "SQL injection in login.php form",
            "purpose": "Bypass authentication via SQL injection",
            "expected_output": "Admin access to web application"
          },
          {
            "step": 3,
            "command": "Exploit debug parameter for remote file inclusion",
            "purpose": "Achieve remote code execution",
            "expected_output": "Reverse shell on target system"
          },
          {
            "step": 4,
            "command": "Query MSSQL database for backup credentials",
            "purpose": "Extract additional user credentials",
            "expected_output": "Domain user credentials discovered"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "45-90 minutes"
      },
      {
        "sequence_name": "credential_escalation_to_admin",
        "steps": [
          {
            "step": 1,
            "command": "Access Firefox profile directory",
            "purpose": "Extract saved browser credentials",
            "expected_output": "Additional user credentials"
          },
          {
            "step": 2,
            "command": "LDAP query for LAPS password attribute",
            "purpose": "Retrieve local administrator password",
            "expected_output": "Administrator password in plaintext"
          },
          {
            "step": 3,
            "command": "evil-winrm -i 10.10.11.158 -u administrator -p [LAPS_PASSWORD]",
            "purpose": "Authenticate as local administrator",
            "expected_output": "Administrative shell access"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "15-30 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "StreamIO",
      "difficulty": "Medium",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2022-06-04",
      "author": "JDgodd, nikk37",
      "estimated_time": "2-3 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "sql_injection",
        "file_inclusion",
        "credential_harvesting"
      ],
      "key_vulnerabilities": [
        "sql_injection",
        "remote_file_inclusion",
        "credential_reuse",
        "laps_exposure"
      ],
      "environment_type": "windows_domain_controller_web_app",
      "real_world_relevance": "high",
      "learning_value": [
        "web_exploitation",
        "database_attacks",
        "credential_harvesting",
        "laps_abuse"
      ],
      "prerequisite_knowledge": [
        "sql_injection",
        "file_inclusion",
        "windows_enumeration",
        "credential_extraction"
      ]
    },
    "categorization": {
      "primary_category": "web_exploitation",
      "subcategories": [
        "sql_injection",
        "file_inclusion",
        "credential_harvesting",
        "privilege_escalation"
      ],
      "attack_types": [
        "initial_access",
        "credential_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "input_validation",
        "secure_file_handling",
        "credential_protection",
        "laps_security"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Acute",
        "Scrambled",
        "Support"
      ],
      "similarity_reasons": [
        "windows_domain",
        "web_application",
        "credential_harvesting",
        "laps_abuse"
      ],
      "unique_aspects": [
        "php_mssql_combination",
        "firefox_credential_extraction",
        "remote_file_inclusion_chain"
      ],
      "difficulty_factors": [
        "multi_stage_exploitation",
        "credential_chain_complexity",
        "database_privilege_escalation"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-05T00:10:02.968785",
    "original_file": "0xdf_writeups/Htb Streamio.md",
    "content_length": 71875,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}