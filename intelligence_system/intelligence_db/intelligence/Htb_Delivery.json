{
  "writeup_id": "Htb_Delivery",
  "scenario_fingerprint": {
    "scenario_name": "linux_web_application_email_bypass",
    "primary_services": [
      "http",
      "ssh",
      "mattermost"
    ],
    "port_signature": "22+80+8065",
    "service_combination": "ssh+nginx+mattermost",
    "os_family": "linux_debian",
    "environment_type": "web_application",
    "entry_vector": "email_verification_bypass",
    "privilege_path": "web_access_to_database_to_root",
    "attack_complexity": "easy",
    "estimated_time": "30-45 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "osticket_helpdesk_system",
      "mattermost_chat_platform",
      "email_verification_bypass_via_ticket",
      "internal_chat_credential_disclosure"
    ],
    "environmental_clues": [
      "nginx_web_server",
      "debian_buster_os",
      "dual_web_applications",
      "email_domain_requirement"
    ],
    "similar_scenarios": [
      "paper_htb_easy",
      "schooled_htb_medium"
    ],
    "unique_aspects": [
      "ticket_system_email_interception",
      "mattermost_internal_communications",
      "hashcat_rules_hint_in_chat"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Email_Relay_Abuse",
        "success_reason": "HelpDesk ticket system allowed email forwarding without validation",
        "prerequisite_indicators": [
          "helpdesk_system_accessible",
          "ticket_creation_without_auth",
          "email_update_functionality"
        ],
        "recognition_patterns": [
          "osTicket or similar helpdesk software",
          "guest ticket creation enabled",
          "email-to-ticket functionality",
          "no email validation on ticket creation"
        ],
        "failure_modes": [
          "email_validation_required",
          "authenticated_ticket_creation_only",
          "no_email_forwarding"
        ],
        "environmental_factors": [
          "default_helpdesk_configuration",
          "insufficient_input_validation",
          "overly_permissive_guest_access"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Database_Credential_Extraction",
        "success_reason": "Mattermost config file readable with database credentials",
        "prerequisite_indicators": [
          "application_config_files_accessible",
          "database_backend_present",
          "file_permissions_misconfigured"
        ],
        "recognition_patterns": [
          "config.json in /opt/mattermost/config/",
          "SqlSettings section with credentials",
          "mysql/postgres connection strings"
        ],
        "failure_modes": [
          "config_files_protected",
          "encrypted_database_passwords",
          "restricted_file_permissions"
        ],
        "environmental_factors": [
          "default_mattermost_installation",
          "shared_service_account_access",
          "insufficient_file_hardening"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "5-10 minutes"
      },
      {
        "technique": "Password_Hash_Cracking_with_Rules",
        "success_reason": "Root password was variant of known base password with predictable mutations",
        "prerequisite_indicators": [
          "password_hashes_accessible",
          "base_password_pattern_known",
          "hashcat_rules_applicable"
        ],
        "recognition_patterns": [
          "bcrypt hashes in database",
          "password pattern hints in chat/documentation",
          "common password mutation patterns"
        ],
        "failure_modes": [
          "strong_unique_passwords",
          "no_pattern_reuse",
          "insufficient_computing_power"
        ],
        "environmental_factors": [
          "password_reuse_culture",
          "predictable_password_policies",
          "leaked_password_patterns"
        ],
        "success_probability": 0.7,
        "typical_timeframe": "30-120 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "HelpDesk email relay functionality",
        "discovery_method": "Manual testing of ticket system",
        "why_critical": "Bypassed email verification for Mattermost registration",
        "how_to_recognize": [
          "guest ticket creation available",
          "email updates to tickets",
          "no sender validation"
        ],
        "follow_up_actions": [
          "create_ticket_with_target_email",
          "register_mattermost_account",
          "check_ticket_for_verification_email"
        ]
      },
      {
        "discovery": "Mattermost internal chat with credentials",
        "discovery_method": "Social engineering via email relay",
        "why_critical": "Provided SSH credentials and password pattern intelligence",
        "how_to_recognize": [
          "internal team communications",
          "credential sharing in chat",
          "password policy discussions"
        ],
        "follow_up_actions": [
          "test_ssh_credentials",
          "note_password_patterns",
          "enumerate_internal_systems"
        ]
      },
      {
        "discovery": "Mattermost database credentials in config",
        "discovery_method": "File system enumeration as service user",
        "why_critical": "Enabled database access and hash extraction",
        "how_to_recognize": [
          "readable config files in /opt/",
          "SqlSettings configuration blocks",
          "plaintext database passwords"
        ],
        "follow_up_actions": [
          "connect_to_database",
          "dump_user_tables",
          "extract_password_hashes"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "service_account",
        "escalation_method": "Password_Pattern_Exploitation",
        "why_possible": "Root used predictable variation of known password pattern",
        "recognition_signs": [
          "password_reuse_hints_in_chat",
          "hashcat_rules_mentioned",
          "base_password_pattern_known"
        ],
        "exploitation_path": "Database Access → Hash Extraction → Pattern-based Cracking → Root Password"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80,8065 open on Linux host with nginx and unknown service",
        "decision": "Enumerate web services and identify service on port 8065",
        "reasoning": "Multiple web services suggest application-focused attack surface",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "ssh_enumeration",
            "when": "if web services fail"
          },
          {
            "option": "service_fingerprinting",
            "when": "if service identification unclear"
          }
        ],
        "success_indicators": [
          "web_applications_identified",
          "service_banners_captured",
          "application_versions_found"
        ],
        "next_decision": "analyze_web_application_functionality"
      },
      {
        "step": 2,
        "situation": "Identified helpdesk system and Mattermost requiring email verification",
        "decision": "Exploit email relay through helpdesk ticket system",
        "reasoning": "Helpdesk provides email address for ticket updates, bypassing email verification",
        "confidence": 0.85,
        "prerequisites": [
          "helpdesk_ticket_creation",
          "email_update_functionality"
        ],
        "success_indicators": [
          "verification_email_received",
          "account_activation_successful"
        ],
        "failure_fallbacks": [
          "alternative_email_methods",
          "credential_stuffing",
          "application_vulnerabilities"
        ]
      },
      {
        "step": 3,
        "situation": "Gained access to internal Mattermost with credentials discovered",
        "decision": "Extract credentials from internal communications",
        "reasoning": "Internal chat systems often contain sensitive information and credentials",
        "confidence": 0.95,
        "prerequisites": [
          "mattermost_access",
          "internal_channels_available"
        ],
        "success_indicators": [
          "credentials_found",
          "system_information_gathered"
        ],
        "failure_fallbacks": [
          "configuration_file_access",
          "database_enumeration"
        ]
      }
    ],
    "branching_logic": {
      "if_email_relay_succeeds": {
        "action": "register_mattermost_account",
        "tools": [
          "web_browser",
          "ticket_system"
        ],
        "next_phase": "internal_application_access"
      },
      "if_mattermost_access_gained": {
        "action": "enumerate_internal_communications",
        "purpose": "find_credentials_and_system_information",
        "tools": [
          "web_interface",
          "api_access"
        ]
      },
      "if_ssh_credentials_obtained": {
        "action": "establish_shell_access",
        "purpose": "system_enumeration_and_privilege_escalation",
        "tools": [
          "ssh",
          "sshpass"
        ]
      },
      "if_database_access_available": {
        "action": "extract_password_hashes",
        "purpose": "credential_cracking_for_privilege_escalation",
        "tools": [
          "mysql",
          "hashcat"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "exploit_email_relay_systems_for_verification_bypass",
        "reasoning": "helpdesk_and_ticketing_systems_often_provide_email_functionality",
        "applicability": "applications_requiring_email_verification"
      },
      {
        "rule": "prioritize_internal_communication_platforms",
        "reasoning": "high_probability_of_credential_and_sensitive_information_disclosure",
        "applicability": "chat_systems_and_collaboration_platforms"
      },
      {
        "rule": "check_application_config_files_for_database_credentials",
        "reasoning": "common_privilege_escalation_path_through_database_access",
        "applicability": "web_applications_with_database_backends"
      },
      {
        "rule": "use_discovered_password_patterns_for_hash_cracking",
        "reasoning": "internal_communications_often_reveal_password_policies",
        "applicability": "environments_with_password_reuse_patterns"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Email Ticket System Abuse",
        "mitre_id": "T1566.002",
        "required_services": [
          "http",
          "smtp"
        ],
        "required_ports": [
          80,
          443,
          25,
          587
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "helpdesk_system_present",
          "email_verification_required",
          "ticket_email_updates_enabled",
          "guest_ticket_creation_allowed"
        ],
        "success_indicators": [
          "ticket_creation_successful",
          "email_address_provided_for_updates",
          "verification_email_interceptable",
          "account_registration_possible"
        ],
        "incompatible_with": [
          "email_validation_on_ticket_creation",
          "captcha_protection",
          "rate_limiting_strict"
        ],
        "confidence_boosters": [
          "osticket_detected",
          "mattermost_integration",
          "guest_access_enabled"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-20 minutes"
      },
      {
        "technique": "Web Application Enumeration",
        "mitre_id": "T1595.003",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8065
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_services_accessible",
          "multiple_subdomains_present",
          "application_integration_exists"
        ],
        "success_indicators": [
          "subdomain_discovery",
          "application_identification",
          "integration_points_found"
        ],
        "incompatible_with": [
          "strict_access_controls",
          "network_segmentation"
        ],
        "confidence_boosters": [
          "nginx_server_detected",
          "custom_ports_open",
          "application_banners_visible"
        ],
        "typical_success_rate": 0.95,
        "estimated_time": "5-15 minutes"
      }
    ],
    "environmental_detectors": {
      "helpdesk_system": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "osTicket",
          "helpdesk",
          "support"
        ],
        "confidence_threshold": 0.8
      },
      "mattermost": {
        "port_indicators": [
          8065,
          8443
        ],
        "service_indicators": [
          "http"
        ],
        "banner_indicators": [
          "Mattermost",
          "X-Version-Id"
        ],
        "confidence_threshold": 0.9
      },
      "linux_debian": {
        "port_indicators": [
          22
        ],
        "service_indicators": [
          "ssh"
        ],
        "banner_indicators": [
          "OpenSSH 7.9p1 Debian"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "email_ticket_abuse",
          "when": "helpdesk_and_email_verification_detected",
          "reason": "bypasses_email_verification_requirements"
        },
        {
          "attack": "subdomain_enumeration",
          "when": "multiple_web_services_detected",
          "reason": "reveals_additional_attack_surface"
        }
      ],
      "medium_priority": [
        {
          "attack": "web_application_testing",
          "when": "custom_applications_detected",
          "reason": "may_reveal_misconfigurations"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Email Relay via Ticketing System",
        "mitre_id": "T1566.001",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "osTicket",
            "command_template": "Create ticket with email: {fake_email}, get ticket ID and email: {ticket_id}@{domain}",
            "actual_command": "Submit ticket, receive 4238791@delivery.htb",
            "output_pattern": "Ticket ID: {number}@delivery.htb",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "ticketing_system_accessible",
          "email_relay_functionality_enabled",
          "target_service_requires_email_verification"
        ],
        "success_indicators": [
          "ticket_created_successfully",
          "email_relay_address_obtained",
          "verification_emails_received_in_ticket"
        ],
        "common_failures": [
          "email_validation_on_ticket_creation",
          "relay_functionality_disabled",
          "rate_limiting_on_ticket_creation"
        ],
        "follow_up_techniques": [
          "service_registration_with_relayed_email",
          "password_reset_attacks",
          "account_takeover"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Database Credential Extraction",
        "mitre_id": "T1555.001",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "file_system_access",
            "command_template": "cat /opt/{application}/config/config.json",
            "actual_command": "cat /opt/mattermost/config/config.json",
            "output_pattern": "\"DataSource\": \"{user}:{password}@tcp({host}:{port})/{database}",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "file_system_access",
          "application_config_readable",
          "plaintext_credentials_in_config"
        ],
        "success_indicators": [
          "config_file_accessible",
          "database_credentials_extracted",
          "database_connection_successful"
        ],
        "common_failures": [
          "encrypted_configuration",
          "restricted_file_permissions",
          "credentials_stored_elsewhere"
        ],
        "follow_up_techniques": [
          "database_enumeration",
          "password_hash_extraction",
          "lateral_movement"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Hash Cracking with Rules",
        "mitre_id": "T1110.002",
        "category": "credential_access",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "hashcat",
            "command_template": "hashcat -m {hash_mode} {hash_file} {wordlist} --user -r {rule_file}",
            "actual_command": "hashcat -m 3200 hash password --user -r /usr/share/hashcat/rules/best64.rule",
            "output_pattern": "{hash}:{cracked_password}",
            "effectiveness_rating": 5,
            "reliability": 0.9
          },
          {
            "name": "mysql",
            "command_template": "mysql -u {username} -p{password} {database}",
            "actual_command": "mysql -u mmuser -pCrack_The_MM_Admin_PW mattermost",
            "success_factors": [
              "database_accessible",
              "valid_credentials"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "password_hashes_obtained",
          "base_password_known_or_guessed",
          "appropriate_hashcat_rules_available"
        ],
        "success_indicators": [
          "hash_cracked_successfully",
          "password_variations_discovered",
          "administrative_access_gained"
        ],
        "common_failures": [
          "insufficient_rule_coverage",
          "complex_password_variations",
          "wrong_hash_mode_selected"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "credential_reuse_testing",
          "system_compromise"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "hashcat",
        "use_case": "bcrypt_hash_cracking_with_rules",
        "effectiveness_rating": 5,
        "reliability": 0.9,
        "learning_curve": "medium",
        "essential_for": [
          "password_cracking",
          "hash_analysis"
        ],
        "alternatives": [
          "john_the_ripper",
          "custom_scripts"
        ],
        "best_practices": [
          "use_appropriate_hash_mode",
          "leverage_rule_files_for_variations",
          "start_with_known_password_patterns",
          "use_user_flag_for_hash_user_format"
        ]
      },
      {
        "tool": "mysql_client",
        "use_case": "database_enumeration_and_extraction",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "database_access",
          "credential_extraction"
        ],
        "alternatives": [
          "database_specific_clients",
          "sqlmap"
        ],
        "best_practices": [
          "focus_on_users_table_first",
          "extract_password_hashes",
          "enumerate_all_databases_and_tables",
          "look_for_sensitive_configuration_data"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "ticket_email_relay_to_service_access",
        "steps": [
          {
            "step": 1,
            "command": "Create ticket at helpdesk.delivery.htb with any email",
            "purpose": "Obtain ticket-based email relay address",
            "expected_output": "Ticket ID and email like 4238791@delivery.htb"
          },
          {
            "step": 2,
            "command": "Register at delivery.htb:8065 using ticket email address",
            "purpose": "Create account requiring email verification",
            "expected_output": "Account created, verification email sent"
          },
          {
            "step": 3,
            "command": "Check ticket status with original email and ticket ID",
            "purpose": "Access verification email through ticket system",
            "expected_output": "Verification email visible in ticket updates"
          },
          {
            "step": 4,
            "command": "Click verification link from ticket",
            "purpose": "Activate service account",
            "expected_output": "Account verified and accessible"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "10-15 minutes"
      },
      {
        "sequence_name": "config_to_database_to_root",
        "steps": [
          {
            "step": 1,
            "command": "cat /opt/mattermost/config/config.json",
            "purpose": "Extract database credentials from config",
            "expected_output": "Database connection string with credentials"
          },
          {
            "step": 2,
            "command": "mysql -u mmuser -pCrack_The_MM_Admin_PW mattermost",
            "purpose": "Connect to database with extracted credentials",
            "expected_output": "MySQL/MariaDB shell access"
          },
          {
            "step": 3,
            "command": "select Username,Password from Users;",
            "purpose": "Extract user password hashes",
            "expected_output": "List of users and bcrypt hashes"
          },
          {
            "step": 4,
            "command": "hashcat -m 3200 hash password --user -r /usr/share/hashcat/rules/best64.rule",
            "purpose": "Crack root hash using password variations",
            "expected_output": "Cracked password: PleaseSubscribe!21"
          },
          {
            "step": 5,
            "command": "su - (with cracked password)",
            "purpose": "Escalate to root privileges",
            "expected_output": "Root shell access"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "15-25 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Delivery",
      "difficulty": "Easy",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2021-01-09",
      "author": "ippsec",
      "estimated_time": "45-60 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "low",
      "skill_level_required": "beginner",
      "primary_attack_vectors": [
        "email_verification_bypass",
        "credential_reuse",
        "database_access"
      ],
      "key_vulnerabilities": [
        "helpdesk_email_bypass",
        "weak_password_policy",
        "database_credential_exposure"
      ],
      "environment_type": "web_application_stack",
      "real_world_relevance": "high",
      "learning_value": [
        "creative_thinking",
        "password_cracking",
        "hashcat_rules"
      ],
      "prerequisite_knowledge": [
        "basic_web_enumeration",
        "database_fundamentals",
        "password_cracking_basics"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "email_bypass",
        "credential_access",
        "database_exploitation"
      ],
      "attack_types": [
        "initial_access",
        "credential_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "proper_email_verification",
        "strong_password_policies",
        "database_security"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Postman",
        "Tabby",
        "Schooled"
      ],
      "similarity_reasons": [
        "web_application_focus",
        "credential_reuse",
        "database_access"
      ],
      "unique_aspects": [
        "helpdesk_ticket_system",
        "mattermost_integration",
        "hashcat_rules_usage"
      ],
      "difficulty_factors": [
        "requires_creative_thinking",
        "straightforward_technical_execution",
        "beginner_friendly"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T00:55:48.042145",
    "original_file": "0xdf_writeups/Htb Delivery.md",
    "content_length": 14773,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}