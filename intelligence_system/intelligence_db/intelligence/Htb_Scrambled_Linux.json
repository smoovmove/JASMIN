{
  "writeup_id": "Htb_Scrambled_Linux",
  "scenario_fingerprint": {
    "scenario_name": "windows_domain_controller_custom_service",
    "primary_services": [
      "kerberos",
      "ldap",
      "smb",
      "dns",
      "mssql",
      "http",
      "custom_app"
    ],
    "port_signature": "53+80+88+389+445+1433+4411+5985",
    "service_combination": "dns+http+kerberos+ldap+smb+mssql+winrm+custom",
    "os_family": "windows_server",
    "environment_type": "active_directory",
    "entry_vector": "information_disclosure",
    "privilege_path": "user_enumeration_to_domain_compromise",
    "attack_complexity": "medium",
    "estimated_time": "90-120 minutes",
    "scenario_confidence": 0.88,
    "distinguishing_factors": [
      "custom_application_on_unusual_port",
      "ntlm_authentication_disabled",
      "internal_corporate_website",
      "mssql_integration"
    ],
    "environmental_clues": [
      "domain_controller_with_web_services",
      "custom_orders_application",
      "username_disclosure_in_screenshots",
      "debug_logging_options"
    ],
    "similar_scenarios": [
      "forest_htb_hard",
      "blackfield_htb_hard"
    ],
    "unique_aspects": [
      "scramblecorp_orders_application",
      "port_4411_custom_service",
      "web_based_information_disclosure",
      "integrated_mssql_backend"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Domain_Enumeration",
        "success_reason": "LDAP service exposed domain information without authentication",
        "prerequisite_indicators": [
          "ldap_port_389_open",
          "ldaps_port_636_open",
          "domain_controller_accessible",
          "anonymous_ldap_queries_allowed"
        ],
        "recognition_patterns": [
          "nmap shows 'Microsoft Windows Active Directory LDAP'",
          "domain name revealed in LDAP banner (scrm.local)",
          "DC hostname in SSL certificate (DC1.scrm.local)",
          "typical AD port combination (53,88,389,445,464,636,9389)"
        ],
        "failure_modes": [
          "ldap_anonymous_access_disabled",
          "domain_controller_not_accessible",
          "firewall_blocking_ldap_ports"
        ],
        "environmental_factors": [
          "default_active_directory_config",
          "ldap_anonymous_queries_enabled",
          "ssl_certificates_revealing_hostnames"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "Information_Disclosure_Web",
        "success_reason": "Static website leaked usernames and system information",
        "prerequisite_indicators": [
          "web_server_accessible",
          "internal_corporate_site",
          "static_html_content",
          "information_pages_present"
        ],
        "recognition_patterns": [
          "screenshots showing usernames (ksimpson)",
          "password reset policy disclosure",
          "service configuration details",
          "internal system documentation"
        ],
        "failure_modes": [
          "no_sensitive_information_disclosed",
          "dynamic_content_properly_secured",
          "authentication_required_for_access"
        ],
        "environmental_factors": [
          "internal_documentation_on_public_site",
          "poor_information_security_practices",
          "static_site_with_embedded_screenshots"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Service_Discovery",
        "success_reason": "Custom application on port 4411 identified through banner grabbing",
        "prerequisite_indicators": [
          "non_standard_ports_open",
          "custom_application_running",
          "banner_grabbing_successful",
          "service_responds_to_connections"
        ],
        "recognition_patterns": [
          "SCRAMBLECORP_ORDERS_V1.0.3 banner",
          "ERROR_UNKNOWN_COMMAND responses",
          "consistent_banner_across_protocols",
          "custom_application_protocol"
        ],
        "failure_modes": [
          "service_requires_authentication",
          "no_banner_information_disclosed",
          "service_not_accessible_externally"
        ],
        "environmental_factors": [
          "custom_internal_applications",
          "verbose_service_banners",
          "development_or_debug_configurations"
        ],
        "success_probability": 0.68,
        "typical_timeframe": "5-10 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Domain Controller identification",
        "discovery_method": "nmap service detection and LDAP banner",
        "why_critical": "Identifies primary target for domain compromise",
        "how_to_recognize": [
          "ports 53,88,389,445,464,636,9389 open",
          "LDAP banner shows Active Directory",
          "Kerberos service on port 88",
          "SSL certificates reveal DC hostname"
        ],
        "follow_up_actions": [
          "enumerate_domain_users",
          "attempt_asrep_roasting",
          "check_smb_null_sessions",
          "test_kerberos_attacks"
        ]
      },
      {
        "discovery": "Username ksimpson",
        "discovery_method": "Screenshot analysis on website",
        "why_critical": "Provides valid domain username for targeted attacks",
        "how_to_recognize": [
          "screenshots in web content",
          "user interface captures",
          "embedded images with system information",
          "documentation with real usernames"
        ],
        "follow_up_actions": [
          "test_password_spray_attacks",
          "attempt_asrep_roasting",
          "check_kerberos_pre_auth",
          "validate_username_format"
        ]
      },
      {
        "discovery": "Password reset policy",
        "discovery_method": "Website information disclosure",
        "why_critical": "Reveals weak password policy (username=password)",
        "how_to_recognize": [
          "password policy documentation",
          "IT support procedures",
          "temporary password patterns",
          "self-service reset information"
        ],
        "follow_up_actions": [
          "test_username_as_password",
          "enumerate_more_usernames",
          "attempt_password_spray",
          "check_common_weak_passwords"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "unauthenticated",
        "escalation_method": "Information_Gathering_to_Initial_Access",
        "why_possible": "Multiple information disclosure vectors provide attack surface",
        "recognition_signs": [
          "domain_controller_identified",
          "usernames_discovered",
          "weak_password_policy_disclosed",
          "custom_services_identified"
        ],
        "exploitation_path": "Domain Enum → Username Discovery → Password Policy → Credential Attack"
      },
      {
        "privilege_level": "external_reconnaissance",
        "escalation_method": "Service_Enumeration_to_Attack_Vectors",
        "why_possible": "Multiple services provide different attack vectors",
        "recognition_signs": [
          "kerberos_service_available",
          "winrm_port_open",
          "mssql_service_running",
          "custom_application_identified"
        ],
        "exploitation_path": "Service Discovery → Protocol Analysis → Vulnerability Identification → Exploitation"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 53,88,389,445,1433,5985 open on Windows host with LDAP showing DC=scrm,DC=local",
        "decision": "Identify as Domain Controller and enumerate web service first for intelligence gathering",
        "reasoning": "Port combination indicates AD DC, but HTTP port 80 may provide usernames and domain info without credentials",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "direct_kerberos_attacks",
            "when": "if no web intelligence found"
          },
          {
            "option": "smb_enumeration",
            "when": "if anonymous access available"
          }
        ],
        "success_indicators": [
          "domain_name_confirmed",
          "usernames_discovered",
          "service_information_gathered"
        ],
        "next_decision": "attempt_credential_attacks"
      },
      {
        "step": 2,
        "situation": "Discovered username 'ksimpson' and password policy hint from web enumeration",
        "decision": "Try password spraying with username=password based on password reset policy",
        "reasoning": "Website states passwords are reset to match username when IT unavailable",
        "confidence": 0.75,
        "prerequisites": [
          "usernames_collected",
          "password_policy_identified"
        ],
        "success_indicators": [
          "authentication_successful",
          "domain_access_obtained"
        ],
        "failure_fallbacks": [
          "asreproast",
          "kerberoasting",
          "custom_service_enumeration"
        ]
      },
      {
        "step": 3,
        "situation": "Standard AD attacks failed, custom service on port 4411 identified",
        "decision": "Enumerate custom SCRAMBLECORP_ORDERS service for additional attack vectors",
        "reasoning": "Custom services often have unique vulnerabilities and may provide alternative entry points",
        "confidence": 0.65,
        "prerequisites": [
          "standard_attacks_exhausted",
          "custom_service_identified"
        ],
        "success_indicators": [
          "service_functionality_understood",
          "additional_credentials_found"
        ],
        "failure_fallbacks": [
          "sql_server_enumeration",
          "deeper_web_enumeration"
        ]
      }
    ],
    "branching_logic": {
      "if_web_enum_succeeds": {
        "action": "compile_username_list_and_try_credential_attacks",
        "tools": [
          "kerbrute",
          "crackmapexec",
          "impacket"
        ],
        "next_phase": "credential_based_enumeration"
      },
      "if_password_spray_succeeds": {
        "action": "enumerate_domain_with_valid_credentials",
        "tools": [
          "bloodhound-python",
          "ldapsearch",
          "smbclient"
        ],
        "next_phase": "privilege_escalation_enumeration"
      },
      "if_standard_attacks_fail": {
        "action": "focus_on_custom_services_and_sql_server",
        "alternatives": [
          "port_4411_analysis",
          "mssql_enumeration",
          "winrm_testing"
        ],
        "decision_criteria": "based_on_service_accessibility"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_enumerate_web_services_first_on_dc",
        "reasoning": "web_services_often_leak_usernames_and_policies_without_authentication",
        "applicability": "domain_controllers_with_web_services"
      },
      {
        "rule": "test_weak_password_policies_immediately",
        "reasoning": "password_reset_policies_often_indicate_weak_credential_practices",
        "applicability": "when_password_policy_hints_discovered"
      },
      {
        "rule": "investigate_custom_services_when_standard_attacks_fail",
        "reasoning": "custom_applications_often_have_unique_vulnerabilities_and_bypass_standard_hardening",
        "applicability": "non_standard_ports_identified"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "ASREPRoast",
        "mitre_id": "T1558.004",
        "required_services": [
          "kerberos"
        ],
        "required_ports": [
          88
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "kerberos_authentication_enabled",
          "accounts_without_preauth_exist"
        ],
        "success_indicators": [
          "GetNPUsers_returns_hashes",
          "domain_controller_accessible",
          "service_accounts_present"
        ],
        "incompatible_with": [
          "kerberos_disabled",
          "all_accounts_require_preauth",
          "network_isolation"
        ],
        "confidence_boosters": [
          "service_account_naming_patterns",
          "default_ad_configuration",
          "legacy_exchange_services"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "5-15 minutes"
      },
      {
        "technique": "Kerberoasting",
        "mitre_id": "T1558.003",
        "required_services": [
          "kerberos",
          "ldap"
        ],
        "required_ports": [
          88,
          389
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "service_accounts_with_spn",
          "valid_domain_credentials"
        ],
        "success_indicators": [
          "GetUserSPNs_returns_tickets",
          "service_accounts_enumerated",
          "tgs_tickets_obtained"
        ],
        "incompatible_with": [
          "no_service_accounts",
          "managed_service_accounts_only",
          "strong_service_passwords"
        ],
        "confidence_boosters": [
          "mssql_service_detected",
          "legacy_service_accounts",
          "default_service_configurations"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "SMB_Anonymous_Enumeration",
        "mitre_id": "T1135",
        "required_services": [
          "smb"
        ],
        "required_ports": [
          445,
          139
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "smb_service_enabled",
          "anonymous_access_allowed"
        ],
        "success_indicators": [
          "shares_enumerated",
          "null_session_established",
          "user_enumeration_successful"
        ],
        "incompatible_with": [
          "smb_signing_required",
          "anonymous_access_disabled",
          "restrictanonymous_enabled"
        ],
        "confidence_boosters": [
          "older_windows_versions",
          "default_configurations",
          "domain_controller_detected"
        ],
        "typical_success_rate": 0.6,
        "estimated_time": "5-10 minutes"
      },
      {
        "technique": "MSSQL_Authentication_Bypass",
        "mitre_id": "T1190",
        "required_services": [
          "mssql"
        ],
        "required_ports": [
          1433
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "mssql_service_accessible",
          "weak_authentication_configured"
        ],
        "success_indicators": [
          "sql_login_successful",
          "database_enumeration_possible",
          "xp_cmdshell_available"
        ],
        "incompatible_with": [
          "strong_authentication_required",
          "network_isolation",
          "sql_hardened"
        ],
        "confidence_boosters": [
          "default_sa_account",
          "integrated_authentication",
          "legacy_sql_versions"
        ],
        "typical_success_rate": 0.45,
        "estimated_time": "15-45 minutes"
      },
      {
        "technique": "Custom_Protocol_Analysis",
        "mitre_id": "T1046",
        "required_services": [
          "custom"
        ],
        "required_ports": [
          4411
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "custom_service_running",
          "protocol_reversible",
          "service_accessible"
        ],
        "success_indicators": [
          "protocol_banner_received",
          "command_structure_identified",
          "debug_mode_available"
        ],
        "incompatible_with": [
          "encrypted_protocol",
          "authentication_required",
          "complex_protocol_structure"
        ],
        "confidence_boosters": [
          "debug_logging_mentioned",
          "version_information_leaked",
          "error_messages_verbose"
        ],
        "typical_success_rate": 0.7,
        "estimated_time": "30-90 minutes"
      }
    ],
    "environmental_detectors": {
      "active_directory": {
        "port_indicators": [
          53,
          88,
          389,
          445,
          636,
          464,
          9389
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns",
          "kpasswd5"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server",
          "DC1.scrm.local"
        ],
        "confidence_threshold": 0.95
      },
      "web_application": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "Microsoft-IIS/10.0"
        ],
        "confidence_threshold": 0.9
      },
      "mssql_database": {
        "port_indicators": [
          1433
        ],
        "service_indicators": [
          "ms-sql-s"
        ],
        "banner_indicators": [
          "Microsoft SQL Server 15.00.2000.00"
        ],
        "confidence_threshold": 0.95
      },
      "custom_service": {
        "port_indicators": [
          4411
        ],
        "service_indicators": [
          "found"
        ],
        "banner_indicators": [
          "SCRAMBLECORP_ORDERS_V1.0.3"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "asreproast",
          "when": "active_directory_detected",
          "reason": "high_success_rate_no_creds_needed"
        },
        {
          "attack": "custom_protocol_analysis",
          "when": "custom_service_detected_with_debug",
          "reason": "debug_logging_suggests_vulnerability"
        },
        {
          "attack": "smb_anonymous_enumeration",
          "when": "smb_service_detected",
          "reason": "often_reveals_usernames_and_shares"
        }
      ],
      "medium_priority": [
        {
          "attack": "kerberoasting",
          "when": "active_directory_detected_with_mssql",
          "reason": "mssql_service_accounts_common_target"
        },
        {
          "attack": "mssql_authentication_bypass",
          "when": "mssql_service_detected",
          "reason": "database_often_misconfigured"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Network Service Discovery",
        "mitre_id": "T1046",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "nmap",
            "command_template": "nmap -p- --min-rate 10000 {target_ip}",
            "actual_command": "nmap -p- --min-rate 10000 10.10.11.168",
            "output_pattern": "PORT      STATE SERVICE",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "nmap",
            "command_template": "nmap -p {ports} -sCV {target_ip}",
            "actual_command": "nmap -p 53,80,88,135,139,389,445,464,593,636,1433,4411,5985,9389 -sCV 10.10.11.168",
            "success_factors": [
              "comprehensive_port_coverage",
              "service_version_detection"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "network_connectivity",
          "target_ip_address"
        ],
        "success_indicators": [
          "active_directory_ports_identified",
          "domain_controller_services_detected",
          "custom_services_discovered"
        ],
        "common_failures": [
          "firewall_blocking_scans",
          "rate_limiting_detection"
        ],
        "follow_up_techniques": [
          "ldap_enumeration",
          "smb_enumeration",
          "web_application_testing"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "LDAP Enumeration",
        "mitre_id": "T1087.002",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "ldapsearch",
            "command_template": "ldapsearch -h {target_ip} -x -s base namingcontexts",
            "actual_command": "ldapsearch -h 10.10.11.168 -x -s base namingcontexts",
            "output_pattern": "namingcontexts: DC=",
            "effectiveness_rating": 4,
            "reliability": 0.95
          },
          {
            "name": "ldapsearch",
            "command_template": "ldapsearch -h {target_ip} -x -b \"{naming_context}\"",
            "actual_command": "ldapsearch -h 10.10.11.168 -x -b \"DC=scrm,DC=local\"",
            "success_factors": [
              "anonymous_bind_allowed"
            ],
            "effectiveness_rating": 3
          }
        ],
        "prerequisites": [
          "ldap_service_accessible",
          "anonymous_bind_enabled"
        ],
        "success_indicators": [
          "domain_naming_context_retrieved",
          "directory_structure_enumerated"
        ],
        "common_failures": [
          "authentication_required",
          "anonymous_bind_disabled"
        ],
        "follow_up_techniques": [
          "credential_guessing",
          "kerberos_enumeration"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Web Application Reconnaissance",
        "mitre_id": "T1590.002",
        "category": "reconnaissance",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "feroxbuster",
            "command_template": "feroxbuster -u http://{target_ip} -w {wordlist}",
            "actual_command": "feroxbuster -u http://10.10.11.168 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt",
            "output_pattern": "200      GET",
            "effectiveness_rating": 4,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "web_service_accessible",
          "appropriate_wordlist"
        ],
        "success_indicators": [
          "hidden_directories_discovered",
          "sensitive_files_found",
          "application_structure_mapped"
        ],
        "common_failures": [
          "waf_blocking_requests",
          "rate_limiting_active"
        ],
        "follow_up_techniques": [
          "manual_web_testing",
          "credential_harvesting"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Information Disclosure via Web Content",
        "mitre_id": "T1213.002",
        "category": "collection",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "manual_browsing",
            "command_template": "curl -s http://{target_ip}/{page} | grep -i {pattern}",
            "actual_command": "Manual browsing of /salesorders.html and other pages",
            "output_pattern": "username: ksimpson",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "web_application_accessible",
          "information_disclosure_present"
        ],
        "success_indicators": [
          "usernames_discovered",
          "system_information_leaked",
          "application_details_revealed"
        ],
        "common_failures": [
          "no_sensitive_information_exposed",
          "information_requires_authentication"
        ],
        "follow_up_techniques": [
          "credential_guessing",
          "password_spraying"
        ],
        "time_investment": "15-45 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Credential Guessing",
        "mitre_id": "T1110.001",
        "category": "credential_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "smbclient.py",
            "command_template": "smbclient.py -k {domain}/{username}:{password}@{hostname} -dc-ip {dc_ip}",
            "actual_command": "smbclient.py -k scrm.local/ksimpson:ksimpson@dc1.scrm.local -dc-ip dc1.scrm.local",
            "output_pattern": "Type help for list of commands",
            "effectiveness_rating": 4,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "username_identified",
          "password_policy_known",
          "kerberos_authentication_available"
        ],
        "success_indicators": [
          "successful_authentication",
          "service_access_granted"
        ],
        "common_failures": [
          "account_lockout_policies",
          "strong_password_requirements",
          "ntlm_authentication_disabled"
        ],
        "follow_up_techniques": [
          "smb_enumeration",
          "privilege_escalation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "nmap",
        "use_case": "network_service_discovery",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "network_reconnaissance"
        ],
        "alternatives": [
          "masscan",
          "rustscan"
        ],
        "best_practices": [
          "use_high_min_rate_for_initial_scan",
          "follow_up_with_service_detection",
          "identify_domain_controller_services"
        ]
      },
      {
        "tool": "smbclient.py",
        "use_case": "kerberos_smb_authentication",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "medium",
        "essential_for": [
          "ntlm_disabled_environments"
        ],
        "alternatives": [
          "smbclient",
          "crackmapexec"
        ],
        "best_practices": [
          "use_kerberos_flag_when_ntlm_disabled",
          "specify_dc_ip_for_resolution",
          "use_fqdn_for_target_hostname"
        ]
      },
      {
        "tool": "ldapsearch",
        "use_case": "active_directory_enumeration",
        "effectiveness_rating": 4,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "domain_reconnaissance"
        ],
        "alternatives": [
          "ldapdomaindump",
          "bloodhound"
        ],
        "best_practices": [
          "start_with_naming_context_enumeration",
          "attempt_anonymous_bind_first",
          "escalate_to_authenticated_queries"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "active_directory_reconnaissance",
        "steps": [
          {
            "step": 1,
            "command": "nmap -p- --min-rate 10000 10.10.11.168",
            "purpose": "Discover all open ports",
            "expected_output": "List of open TCP ports including AD services"
          },
          {
            "step": 2,
            "command": "nmap -p 53,80,88,135,139,389,445,464,593,636,1433,4411,5985,9389 -sCV 10.10.11.168",
            "purpose": "Identify services and versions",
            "expected_output": "Domain controller services and domain name"
          },
          {
            "step": 3,
            "command": "ldapsearch -h 10.10.11.168 -x -s base namingcontexts",
            "purpose": "Extract domain naming context",
            "expected_output": "DC=scrm,DC=local"
          },
          {
            "step": 4,
            "command": "feroxbuster -u http://10.10.11.168 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt",
            "purpose": "Discover web directories and files",
            "expected_output": "Web application structure"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "20-40 minutes"
      },
      {
        "sequence_name": "credential_discovery_and_validation",
        "steps": [
          {
            "step": 1,
            "command": "Manual browsing of web application pages",
            "purpose": "Harvest usernames and system information",
            "expected_output": "Username: ksimpson, password reset policy"
          },
          {
            "step": 2,
            "command": "smbclient.py -k scrm.local/ksimpson:ksimpson@dc1.scrm.local -dc-ip dc1.scrm.local",
            "purpose": "Test username as password",
            "expected_output": "Successful SMB authentication"
          },
          {
            "step": 3,
            "command": "shares",
            "purpose": "Enumerate available SMB shares",
            "expected_output": "List of accessible shares including HR, IT"
          }
        ],
        "success_rate": 0.8,
        "typical_duration": "10-20 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Scrambled",
      "difficulty": "Medium",
      "os": "Windows Server 2019",
      "platform": "HackTheBox",
      "release_date": "2022-06-11",
      "author": "felamos",
      "estimated_time": "2-4 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "kerberos",
        "sql_server",
        "active_directory"
      ],
      "key_vulnerabilities": [
        "kerberoasting",
        "sql_injection",
        "service_account_abuse"
      ],
      "environment_type": "corporate_domain_controller",
      "real_world_relevance": "high",
      "learning_value": [
        "advanced_kerberos_attacks",
        "sql_server_exploitation",
        "ad_enumeration"
      ],
      "prerequisite_knowledge": [
        "kerberos_fundamentals",
        "sql_server_basics",
        "active_directory_concepts"
      ]
    },
    "categorization": {
      "primary_category": "active_directory",
      "subcategories": [
        "kerberos_attacks",
        "database_exploitation",
        "service_enumeration"
      ],
      "attack_types": [
        "credential_access",
        "lateral_movement",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "secure_sql_configuration",
        "service_account_hardening",
        "kerberos_monitoring"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Forest",
        "Sauna",
        "Blackfield"
      ],
      "similarity_reasons": [
        "ad_environment",
        "kerberos_attacks",
        "windows_domain"
      ],
      "unique_aspects": [
        "sql_server_integration",
        "custom_port_4411",
        "complex_service_interaction"
      ],
      "difficulty_factors": [
        "multiple_attack_vectors",
        "service_chaining",
        "advanced_enumeration_required"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-05T01:23:31.245942",
    "original_file": "0xdf_writeups/Htb Scrambled Linux.md",
    "content_length": 64569,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}