{
  "writeup_id": "Htb_Zetta",
  "scenario_fingerprint": {
    "scenario_name": "linux_ipv6_ftp_bounce_rsync",
    "primary_services": [
      "ftp",
      "ssh",
      "http",
      "rsync"
    ],
    "port_signature": "21+22+80+8730",
    "service_combination": "ftp+ssh+http+rsync_ipv6",
    "os_family": "linux",
    "environment_type": "dual_stack_network",
    "entry_vector": "ftp_bounce_attack",
    "privilege_path": "rsync_to_ssh_key_injection",
    "attack_complexity": "hard",
    "estimated_time": "3-4 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "ftp_bounce_attack_capability",
      "ipv6_only_services",
      "rsync_password_length_oracle",
      "ssh_authorized_keys_writable"
    ],
    "environmental_clues": [
      "pure_ftpd_with_fxp_support",
      "dual_stack_ipv4_ipv6_hints",
      "32_character_random_credentials",
      "debian_10_buster_fingerprint"
    ],
    "similar_scenarios": [
      "networked_htb_hard",
      "sneaky_htb_medium"
    ],
    "unique_aspects": [
      "ftp_bounce_for_ipv6_discovery",
      "rsync_bruteforce_via_file_size",
      "sql_injection_into_syslog"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "FTP_Bounce_Attack",
        "success_reason": "FTP server supported FXP transfers with weak authentication",
        "prerequisite_indicators": [
          "ftp_server_supports_fxp",
          "weak_authentication_mechanism",
          "ipv6_dual_stack_configuration"
        ],
        "recognition_patterns": [
          "FXP transfers mentioned in banner",
          "RFC-2428 support indicated",
          "IPv6 connections welcome message",
          "32-character random credentials work"
        ],
        "failure_modes": [
          "fxp_transfers_disabled",
          "strong_authentication_required",
          "bounce_attacks_filtered"
        ],
        "environmental_factors": [
          "dual_stack_ipv4_ipv6_setup",
          "legacy_ftp_configuration",
          "insufficient_access_controls"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "IPv6_Discovery_via_FTP_Bounce",
        "success_reason": "FTP bounce revealed IPv6 address for additional attack surface",
        "prerequisite_indicators": [
          "ipv6_hints_in_web_content",
          "dual_stack_references",
          "ftp_bounce_capability"
        ],
        "recognition_patterns": [
          ":: notation in site name",
          "dual-stack almost there message",
          "IPv6 welcome in FTP banner",
          "EPRT command acceptance"
        ],
        "failure_modes": [
          "ipv6_disabled",
          "bounce_connections_blocked",
          "no_additional_services_on_ipv6"
        ],
        "environmental_factors": [
          "ipv6_transition_period",
          "incomplete_security_hardening",
          "service_binding_differences"
        ],
        "success_probability": 0.78,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "RSync_Access_via_IPv6",
        "success_reason": "RSync service only accessible via IPv6 with limited authentication",
        "prerequisite_indicators": [
          "ipv6_address_discovered",
          "service_enumeration_on_ipv6",
          "rsync_port_accessible"
        ],
        "recognition_patterns": [
          "port 873 or custom port open on IPv6",
          "rsync protocol response",
          "module enumeration possible"
        ],
        "failure_modes": [
          "rsync_requires_authentication",
          "no_writable_modules",
          "ipv6_service_hardened"
        ],
        "environmental_factors": [
          "ipv6_only_service_binding",
          "incomplete_security_migration",
          "legacy_service_configurations"
        ],
        "success_probability": 0.72,
        "typical_timeframe": "5-15 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "FXP transfer support with weak authentication",
        "discovery_method": "FTP banner analysis and credential testing",
        "why_critical": "Enabled FTP bounce attacks for network reconnaissance",
        "how_to_recognize": [
          "FXP transfers mentioned in banner",
          "32-character username/password pattern works",
          "Pure-FTPd with permissive config"
        ],
        "follow_up_actions": [
          "test_ftp_bounce_capabilities",
          "enumerate_ipv6_address",
          "scan_internal_network_via_bounce"
        ]
      },
      {
        "discovery": "IPv6 dual-stack configuration",
        "discovery_method": "Web content analysis and FTP bounce",
        "why_critical": "Revealed additional attack surface on IPv6-only services",
        "how_to_recognize": [
          ":: notation in branding",
          "dual-stack references",
          "IPv6 connections welcome message"
        ],
        "follow_up_actions": [
          "discover_ipv6_address_via_bounce",
          "enumerate_ipv6_services",
          "test_service_binding_differences"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "network_reconnaissance",
        "escalation_method": "FTP_Bounce_to_IPv6_Discovery",
        "why_possible": "FTP server allowed proxy connections to reveal IPv6 address",
        "recognition_signs": [
          "ftp_bounce_successful",
          "ipv6_hints_in_application",
          "eprt_command_accepted"
        ],
        "exploitation_path": "FTP Bounce → IPv6 Discovery → Additional Service Enumeration"
      },
      {
        "privilege_level": "service_discovery",
        "escalation_method": "IPv6_Service_Enumeration",
        "why_possible": "Services bound only to IPv6 with different security posture",
        "recognition_signs": [
          "ipv6_address_obtained",
          "services_respond_on_ipv6",
          "different_access_controls"
        ],
        "exploitation_path": "IPv6 Access → RSync Enumeration → File System Access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 21,22,80 open on Linux host with FTP, SSH, HTTP",
        "decision": "Investigate FTP service first due to unusual authentication hints",
        "reasoning": "Website shows random 32-char credentials and mentions FXP/RFC-2428, indicating special FTP configuration",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "web_enumeration",
            "when": "if ftp access fails"
          },
          {
            "option": "ssh_enumeration",
            "when": "if credentials found elsewhere"
          }
        ],
        "success_indicators": [
          "ftp_login_successful",
          "fxp_transfers_supported",
          "ipv6_hints_confirmed"
        ],
        "next_decision": "explore_ftp_bounce_capabilities"
      },
      {
        "step": 2,
        "situation": "FTP allows login with any 32-char string as user/pass and supports FXP",
        "decision": "Use FTP bounce attack to discover IPv6 address and scan internal services",
        "reasoning": "FXP support enables bounce attacks, IPv6 hints suggest dual-stack with hidden services",
        "confidence": 0.85,
        "prerequisites": [
          "ftp_access_confirmed",
          "fxp_support_verified"
        ],
        "success_indicators": [
          "ipv6_address_discovered",
          "internal_services_found"
        ],
        "failure_fallbacks": [
          "direct_ipv6_enumeration",
          "web_directory_bruteforce"
        ]
      },
      {
        "step": 3,
        "situation": "IPv6 address discovered, need to find IPv6-only services",
        "decision": "Scan IPv6 address for services not available on IPv4",
        "reasoning": "Dual-stack hints suggest services running on IPv6 only",
        "confidence": 0.8,
        "prerequisites": [
          "ipv6_address_known"
        ],
        "success_indicators": [
          "rsync_or_other_services_found"
        ],
        "failure_fallbacks": [
          "return_to_ipv4_enumeration",
          "web_vulnerability_search"
        ]
      }
    ],
    "branching_logic": {
      "if_ftp_bounce_succeeds": {
        "action": "discover_ipv6_and_scan_services",
        "tools": [
          "nc",
          "nmap",
          "custom_scripts"
        ],
        "next_phase": "ipv6_service_enumeration"
      },
      "if_ipv6_services_found": {
        "action": "enumerate_discovered_services",
        "alternatives": [
          "rsync_enumeration",
          "other_service_specific_enum"
        ],
        "decision_criteria": "based_on_service_type_discovered"
      },
      "if_rsync_access_obtained": {
        "action": "explore_file_system_access",
        "purpose": "find_credential_files_or_ssh_keys",
        "tools": [
          "rsync",
          "ssh-keygen"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_check_ftp_bounce_when_fxp_supported",
        "reasoning": "fxp_enables_internal_network_discovery",
        "applicability": "ftp_servers_with_fxp_support"
      },
      {
        "rule": "investigate_ipv6_when_dual_stack_hints_present",
        "reasoning": "services_often_hidden_on_ipv6_only",
        "applicability": "dual_stack_environments"
      },
      {
        "rule": "use_custom_scripts_for_slow_ftp_connections",
        "reasoning": "automated_tools_may_timeout_on_slow_connections",
        "applicability": "slow_or_rate_limited_services"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "FTP Bounce Attack",
        "mitre_id": "T1090.001",
        "required_services": [
          "ftp"
        ],
        "required_ports": [
          21
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "ftp_server_supports_fxp",
          "ftp_server_allows_port_command",
          "weak_authentication_mechanism"
        ],
        "success_indicators": [
          "fxp_transfers_supported_banner",
          "port_command_accepted",
          "can_authenticate_with_weak_creds"
        ],
        "incompatible_with": [
          "fxp_disabled",
          "port_command_filtered",
          "strong_authentication_required"
        ],
        "confidence_boosters": [
          "pure_ftpd_banner",
          "fxp_mentioned_in_banner",
          "predictable_auth_patterns"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "IPv6 Service Discovery",
        "mitre_id": "T1046",
        "required_services": [
          "any"
        ],
        "required_ports": [
          "any"
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "ipv6_enabled",
          "dual_stack_configuration",
          "services_bound_to_ipv6"
        ],
        "success_indicators": [
          "ipv6_connectivity_confirmed",
          "services_respond_on_ipv6",
          "different_service_exposure"
        ],
        "incompatible_with": [
          "ipv6_disabled",
          "ipv4_only_stack",
          "ipv6_firewall_blocking"
        ],
        "confidence_boosters": [
          "dual_stack_references",
          "ipv6_welcome_messages",
          "different_ipv4_ipv6_exposure"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "5-15 minutes"
      },
      {
        "technique": "RSync Enumeration",
        "mitre_id": "T1083",
        "required_services": [
          "rsync"
        ],
        "required_ports": [
          873
        ],
        "os_requirements": [
          "unix",
          "linux"
        ],
        "environmental_prerequisites": [
          "rsync_daemon_running",
          "anonymous_or_weak_auth",
          "readable_modules_exist"
        ],
        "success_indicators": [
          "rsync_modules_listed",
          "file_enumeration_successful",
          "write_access_available"
        ],
        "incompatible_with": [
          "rsync_authentication_required",
          "all_modules_restricted",
          "network_isolation"
        ],
        "confidence_boosters": [
          "default_rsync_configuration",
          "home_directory_modules",
          "backup_related_modules"
        ],
        "typical_success_rate": 0.8,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "SSH Key Injection",
        "mitre_id": "T1098.004",
        "required_services": [
          "ssh"
        ],
        "required_ports": [
          22
        ],
        "os_requirements": [
          "unix",
          "linux"
        ],
        "environmental_prerequisites": [
          "write_access_to_ssh_directory",
          "authorized_keys_writable",
          "ssh_key_auth_enabled"
        ],
        "success_indicators": [
          "authorized_keys_file_writable",
          "ssh_directory_accessible",
          "key_injection_successful"
        ],
        "incompatible_with": [
          "ssh_key_auth_disabled",
          "authorized_keys_immutable",
          "ssh_directory_protected"
        ],
        "confidence_boosters": [
          "home_directory_write_access",
          "default_ssh_configuration",
          "user_ssh_directory_exists"
        ],
        "typical_success_rate": 0.95,
        "estimated_time": "2-5 minutes"
      }
    ],
    "environmental_detectors": {
      "ftp_with_fxp": {
        "port_indicators": [
          21
        ],
        "service_indicators": [
          "ftp"
        ],
        "banner_indicators": [
          "FXP transfers",
          "Pure-FTPd"
        ],
        "confidence_threshold": 0.9
      },
      "ipv6_dual_stack": {
        "port_indicators": [
          21,
          22,
          80
        ],
        "service_indicators": [
          "any"
        ],
        "banner_indicators": [
          "IPv6 connections",
          "dual-stack",
          "::"
        ],
        "confidence_threshold": 0.85
      },
      "rsync_service": {
        "port_indicators": [
          873
        ],
        "service_indicators": [
          "rsync"
        ],
        "banner_indicators": [
          "rsync"
        ],
        "confidence_threshold": 0.95
      },
      "weak_ftp_auth": {
        "port_indicators": [
          21
        ],
        "service_indicators": [
          "ftp"
        ],
        "banner_indicators": [
          "random",
          "32 character"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "ipv6_service_discovery",
          "when": "dual_stack_indicators_present",
          "reason": "often_reveals_additional_services"
        },
        {
          "attack": "ftp_bounce_scan",
          "when": "fxp_support_detected",
          "reason": "enables_internal_network_scanning"
        }
      ],
      "medium_priority": [
        {
          "attack": "rsync_enumeration",
          "when": "rsync_service_detected",
          "reason": "high_success_rate_for_file_access"
        },
        {
          "attack": "ssh_key_injection",
          "when": "ssh_directory_write_access",
          "reason": "reliable_persistence_method"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "FTP Bounce Attack",
        "mitre_id": "T1090.001",
        "category": "command_and_control",
        "phase": "discovery",
        "tools_used": [
          {
            "name": "nmap",
            "command_template": "nmap -Pn -p{port_range} -b {username}:{password}@{ftp_server} {target}",
            "actual_command": "nmap -Pn -p8725-8735 -b dddddddddddddddddddddddddddddddd:dddddddddddddddddddddddddddddddd@10.10.10.156 127.0.0.1",
            "output_pattern": "filtered|closed|open",
            "effectiveness_rating": 3,
            "reliability": 0.7
          },
          {
            "name": "netcat",
            "command_template": "nc {target_ip} 21",
            "actual_command": "nc 10.10.10.156 21",
            "success_factors": [
              "fxp_transfers_enabled",
              "weak_authentication"
            ],
            "effectiveness_rating": 4
          }
        ],
        "prerequisites": [
          "ftp_server_supports_fxp",
          "valid_ftp_credentials",
          "target_allows_port_commands"
        ],
        "success_indicators": [
          "eprt_command_accepted",
          "connection_established_to_listener",
          "target_ipv6_address_revealed"
        ],
        "common_failures": [
          "ports_under_1024_blocked",
          "slow_connection_timeouts",
          "fxp_not_enabled"
        ],
        "follow_up_techniques": [
          "ipv6_enumeration",
          "port_scanning_via_bounce",
          "service_discovery"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "IPv6 Address Discovery via FTP Bounce",
        "mitre_id": "T1018",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "custom_python_script",
            "command_template": "python3 get_ipv6.py",
            "actual_command": "python3 get_ipv6.py",
            "output_pattern": "dead:beef::",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "manual_ftp_commands",
            "command_template": "EPRT |2|{local_ipv6}|{port}",
            "actual_command": "EPRT |2|dead:beef:2::1003|2222",
            "success_factors": [
              "listener_ready",
              "valid_ipv6_syntax"
            ],
            "effectiveness_rating": 4
          }
        ],
        "prerequisites": [
          "ftp_bounce_capability",
          "local_ipv6_connectivity",
          "ability_to_bind_high_ports"
        ],
        "success_indicators": [
          "incoming_connection_from_target_ipv6",
          "ipv6_address_extracted_from_connection",
          "address_responds_to_ping6"
        ],
        "common_failures": [
          "firewall_blocking_ipv6",
          "incorrect_eprt_syntax",
          "listener_not_ready"
        ],
        "follow_up_techniques": [
          "ipv6_port_scanning",
          "ipv6_service_enumeration",
          "dual_stack_exploitation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Weak FTP Authentication Bypass",
        "mitre_id": "T1110.001",
        "category": "credential_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "ftp_client",
            "command_template": "ftp {target_ip}",
            "actual_command": "ftp 10.10.10.156",
            "output_pattern": "230-OK. Current restricted directory",
            "effectiveness_rating": 5,
            "reliability": 1.0
          }
        ],
        "prerequisites": [
          "ftp_service_accessible",
          "weak_authentication_logic",
          "32_character_string_generation"
        ],
        "success_indicators": [
          "successful_authentication_with_any_32_char_string",
          "ftp_session_established",
          "directory_listing_accessible"
        ],
        "common_failures": [
          "incorrect_string_length",
          "username_password_mismatch",
          "service_unavailable"
        ],
        "follow_up_techniques": [
          "ftp_bounce_attack",
          "file_enumeration",
          "privilege_escalation"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "nmap_ftp_bounce",
        "use_case": "port_scanning_through_ftp_proxy",
        "effectiveness_rating": 3,
        "reliability": 0.7,
        "learning_curve": "medium",
        "essential_for": [
          "network_pivoting",
          "firewall_bypass"
        ],
        "alternatives": [
          "manual_ftp_commands",
          "custom_scripts"
        ],
        "best_practices": [
          "use_high_port_numbers_above_1024",
          "account_for_slow_connection_speeds",
          "validate_fxp_support_first"
        ]
      },
      {
        "tool": "custom_ipv6_discovery_script",
        "use_case": "automated_ipv6_address_extraction",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "dual_stack_environments",
          "ipv6_enumeration"
        ],
        "alternatives": [
          "manual_ftp_bounce",
          "arp_table_analysis"
        ],
        "best_practices": [
          "use_random_ports_to_avoid_conflicts",
          "implement_proper_socket_cleanup",
          "validate_ipv6_connectivity_first"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "ftp_bounce_to_ipv6_discovery",
        "steps": [
          {
            "step": 1,
            "command": "ftp 10.10.10.156",
            "purpose": "Connect to FTP server",
            "expected_output": "220---------- Welcome to Pure-FTPd"
          },
          {
            "step": 2,
            "command": "USER bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
            "purpose": "Authenticate with 32-char username",
            "expected_output": "331 User bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb OK"
          },
          {
            "step": 3,
            "command": "PASS bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb",
            "purpose": "Complete authentication",
            "expected_output": "230-This server supports FXP transfers"
          },
          {
            "step": 4,
            "command": "EPRT |2|dead:beef:2::1003|2222",
            "purpose": "Set up FXP transfer to local IPv6",
            "expected_output": "200 PORT command successful"
          },
          {
            "step": 5,
            "command": "LIST",
            "purpose": "Trigger connection to reveal target IPv6",
            "expected_output": "Connection from dead:beef::250:56ff:fe88:e5fa"
          }
        ],
        "success_rate": 0.9,
        "typical_duration": "5-10 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Zetta",
      "difficulty": "Hard",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2019-08-31",
      "author": "jkr",
      "estimated_time": "4-6 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "ftp_bounce",
        "ipv6_enumeration",
        "rsync_abuse",
        "sql_injection"
      ],
      "key_vulnerabilities": [
        "ftp_bounce_attack",
        "rsync_misconfiguration",
        "syslog_sql_injection",
        "weak_authentication"
      ],
      "environment_type": "linux_server_multi_service",
      "real_world_relevance": "high",
      "learning_value": [
        "ipv6_attacks",
        "ftp_bounce_techniques",
        "rsync_exploitation",
        "syslog_injection",
        "git_forensics"
      ],
      "prerequisite_knowledge": [
        "advanced_networking",
        "ipv6_concepts",
        "rsync_protocol",
        "sql_injection",
        "git_internals"
      ]
    },
    "categorization": {
      "primary_category": "network_exploitation",
      "subcategories": [
        "protocol_abuse",
        "service_misconfiguration",
        "injection_attacks"
      ],
      "attack_types": [
        "information_disclosure",
        "credential_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "disable_ftp_bounce",
        "secure_rsync_config",
        "input_validation",
        "service_hardening"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Sneaky",
        "Cronos",
        "Poison"
      ],
      "similarity_reasons": [
        "ipv6_usage",
        "service_chaining",
        "complex_attack_paths"
      ],
      "unique_aspects": [
        "ftp_bounce_for_ipv6_discovery",
        "rsync_password_length_oracle",
        "syslog_sql_injection",
        "git_config_analysis"
      ],
      "difficulty_factors": [
        "multiple_complex_techniques",
        "ipv6_networking",
        "creative_attack_chaining",
        "forensic_analysis_required"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T20:47:14.921679",
    "original_file": "0xdf_writeups/Htb Zetta.md",
    "content_length": 58381,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}