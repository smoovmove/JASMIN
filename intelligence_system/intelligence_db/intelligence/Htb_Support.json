{
  "writeup_id": "Htb_Support",
  "scenario_fingerprint": {
    "scenario_name": "windows_domain_controller_ldap_enumeration",
    "primary_services": [
      "dns",
      "kerberos",
      "ldap",
      "smb",
      "winrm"
    ],
    "port_signature": "53+88+389+445+5985",
    "service_combination": "dns+kerberos+ldap+smb+winrm",
    "os_family": "windows_server",
    "environment_type": "active_directory",
    "entry_vector": "smb_share_enumeration",
    "privilege_path": "service_account_to_domain_admin",
    "attack_complexity": "easy",
    "estimated_time": "30-45 minutes",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "open_smb_shares",
      "dotnet_binary_with_hardcoded_creds",
      "ldap_password_in_info_field",
      "genericall_permissions_on_dc"
    ],
    "environmental_clues": [
      "domain_controller_role",
      "support_tools_in_shares",
      "it_staff_environment",
      "shared_service_accounts"
    ],
    "similar_scenarios": [
      "forest_htb_easy",
      "active_htb_easy"
    ],
    "unique_aspects": [
      "dotnet_reverse_engineering",
      "userinfo_exe_tool",
      "ldap_info_field_password",
      "support_staff_scenario"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "SMB_Share_Enumeration",
        "success_reason": "Anonymous access allowed to support-tools share containing sensitive files",
        "prerequisite_indicators": [
          "smb_service_available",
          "anonymous_access_enabled",
          "shares_enumerable"
        ],
        "recognition_patterns": [
          "smbclient -N succeeds",
          "custom share names (support-tools)",
          "executable files in shares"
        ],
        "failure_modes": [
          "anonymous_access_disabled",
          "share_permissions_restricted",
          "no_custom_shares"
        ],
        "environmental_factors": [
          "it_support_environment",
          "tool_sharing_practices",
          "insufficient_access_controls"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "Dotnet_Binary_Analysis",
        "success_reason": "Hardcoded credentials in UserInfo.exe .NET binary",
        "prerequisite_indicators": [
          "dotnet_executable_available",
          "decompilation_tools_accessible",
          "credentials_hardcoded"
        ],
        "recognition_patterns": [
          ".exe files in shares",
          ".NET assemblies",
          "custom internal tools"
        ],
        "failure_modes": [
          "obfuscated_binaries",
          "no_hardcoded_secrets",
          "encrypted_credentials"
        ],
        "environmental_factors": [
          "internal_tool_development",
          "poor_credential_management",
          "dotnet_framework_usage"
        ],
        "success_probability": 0.82,
        "typical_timeframe": "10-30 minutes"
      },
      {
        "technique": "LDAP_Enumeration_With_Creds",
        "success_reason": "Service account credentials allowed LDAP enumeration revealing password in info field",
        "prerequisite_indicators": [
          "valid_domain_credentials",
          "ldap_service_accessible",
          "user_enumeration_possible"
        ],
        "recognition_patterns": [
          "ldap bind successful",
          "user objects enumerable",
          "info fields populated"
        ],
        "failure_modes": [
          "ldap_access_restricted",
          "no_sensitive_attributes",
          "minimal_user_info"
        ],
        "environmental_factors": [
          "active_directory_environment",
          "shared_account_usage",
          "poor_attribute_hygiene"
        ],
        "success_probability": 0.68,
        "typical_timeframe": "5-15 minutes"
      },
      {
        "technique": "GenericAll_Privilege_Escalation",
        "success_reason": "Shared account had GenericAll permissions on Domain Controller object",
        "prerequisite_indicators": [
          "privileged_account_access",
          "domain_controller_accessible",
          "genericall_permissions_exist"
        ],
        "recognition_patterns": [
          "bloodhound shows GenericAll",
          "shared service accounts",
          "excessive permissions"
        ],
        "failure_modes": [
          "restricted_permissions",
          "no_dc_object_access",
          "proper_delegation"
        ],
        "environmental_factors": [
          "exchange_legacy_permissions",
          "over_privileged_service_accounts",
          "insufficient_permission_review"
        ],
        "success_probability": 0.91,
        "typical_timeframe": "5-10 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "UserInfo.exe with hardcoded credentials",
        "discovery_method": "SMB share enumeration and .NET decompilation",
        "why_critical": "Provided initial domain access for LDAP enumeration",
        "how_to_recognize": [
          "custom .exe files in shares",
          ".NET assemblies",
          "internal support tools"
        ],
        "follow_up_actions": [
          "decompile_dotnet_binary",
          "extract_hardcoded_credentials",
          "test_ldap_authentication"
        ]
      },
      {
        "discovery": "Password in LDAP info field",
        "discovery_method": "LDAP enumeration with service account",
        "why_critical": "Provided access to privileged shared account",
        "how_to_recognize": [
          "populated info attributes",
          "shared account naming",
          "password-like strings in fields"
        ],
        "follow_up_actions": [
          "test_discovered_credentials",
          "enumerate_account_permissions",
          "run_bloodhound_collection"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "shared_account",
        "escalation_method": "GenericAll_to_DCSync",
        "why_possible": "Shared account had GenericAll permission on Domain Controller object",
        "recognition_signs": [
          "bloodhound_shows_genericall",
          "shared_account_excessive_permissions",
          "dc_object_control"
        ],
        "exploitation_path": "GenericAll on DC → Resource-Based Constrained Delegation → Domain Admin"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 53,88,389,445 open on Windows host",
        "decision": "Identify as Domain Controller and prioritize SMB enumeration",
        "reasoning": "Port combination indicates AD DC - SMB shares often contain tools/files with embedded credentials",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "ldap_enumeration",
            "when": "if anonymous access available"
          },
          {
            "option": "kerberos_attacks",
            "when": "if usernames discovered"
          }
        ],
        "success_indicators": [
          "smb_shares_accessible",
          "custom_tools_found",
          "domain_name_discovered"
        ],
        "next_decision": "analyze_custom_binaries"
      },
      {
        "step": 2,
        "situation": "Found custom .NET binary UserInfo.exe in support-tools share",
        "decision": "Reverse engineer .NET binary for hardcoded credentials",
        "reasoning": ".NET binaries are easily reversible and support tools often contain embedded service account credentials",
        "confidence": 0.9,
        "prerequisites": [
          "custom_binary_downloaded",
          "dotnet_reversing_tools_available"
        ],
        "success_indicators": [
          "hardcoded_credentials_found",
          "ldap_connection_strings_discovered"
        ],
        "failure_fallbacks": [
          "dynamic_analysis",
          "string_extraction",
          "config_file_analysis"
        ]
      },
      {
        "step": 3,
        "situation": "Obtained domain credentials from binary analysis",
        "decision": "Use credentials for comprehensive LDAP enumeration",
        "reasoning": "Domain credentials enable full LDAP directory enumeration to find privilege escalation paths",
        "confidence": 0.95,
        "prerequisites": [
          "valid_domain_credentials"
        ],
        "success_indicators": [
          "ldap_bind_successful",
          "user_objects_enumerated"
        ],
        "next_decision": "search_for_privileged_accounts"
      },
      {
        "step": 4,
        "situation": "Found shared account with password in LDAP info field",
        "decision": "Check account privileges over domain objects",
        "reasoning": "Shared accounts often have elevated privileges for administrative tasks",
        "confidence": 0.85,
        "prerequisites": [
          "additional_credentials_found"
        ],
        "success_indicators": [
          "genericall_permissions_found",
          "dc_machine_object_control"
        ],
        "next_decision": "exploit_machine_object_permissions"
      }
    ],
    "branching_logic": {
      "if_smb_shares_accessible": {
        "action": "download_custom_tools_first",
        "tools": [
          "smbclient",
          "crackmapexec"
        ],
        "next_phase": "binary_analysis"
      },
      "if_dotnet_binary_found": {
        "action": "reverse_engineer_for_credentials",
        "tools": [
          "dnspy",
          "ilspy",
          "strings"
        ],
        "decision_criteria": "prioritize_dynamic_analysis_over_static"
      },
      "if_domain_credentials_obtained": {
        "action": "comprehensive_ldap_enumeration",
        "tools": [
          "ldapsearch",
          "bloodhound-python"
        ],
        "purpose": "find_privilege_escalation_paths"
      },
      "if_genericall_on_dc_found": {
        "action": "dcsync_attack",
        "tools": [
          "impacket-secretsdump"
        ],
        "purpose": "dump_administrator_hash"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_analyze_custom_binaries_from_smb_shares",
        "reasoning": "custom_tools_frequently_contain_hardcoded_service_credentials",
        "applicability": "windows_domain_environments"
      },
      {
        "rule": "check_ldap_info_fields_for_passwords",
        "reasoning": "administrators_often_store_passwords_in_description_fields",
        "applicability": "when_domain_credentials_available"
      },
      {
        "rule": "prioritize_machine_object_permissions_over_user_permissions",
        "reasoning": "genericall_on_dc_machine_object_enables_dcsync",
        "applicability": "active_directory_privilege_escalation"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "SMB Anonymous Enumeration",
        "mitre_id": "T1135",
        "required_services": [
          "smb"
        ],
        "required_ports": [
          445,
          139
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "smb_service_accessible",
          "anonymous_access_enabled"
        ],
        "success_indicators": [
          "shares_enumerable",
          "files_accessible",
          "null_session_allowed"
        ],
        "incompatible_with": [
          "smb_disabled",
          "anonymous_access_blocked",
          "network_isolation"
        ],
        "confidence_boosters": [
          "default_windows_configuration",
          "legacy_smb_settings",
          "it_support_shares"
        ],
        "typical_success_rate": 0.65,
        "estimated_time": "2-10 minutes"
      },
      {
        "technique": "LDAP Anonymous Bind",
        "mitre_id": "T1087.002",
        "required_services": [
          "ldap"
        ],
        "required_ports": [
          389,
          3268
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "ldap_service_accessible"
        ],
        "success_indicators": [
          "base_dn_enumerable",
          "naming_contexts_accessible",
          "anonymous_bind_successful"
        ],
        "incompatible_with": [
          "ldap_disabled",
          "anonymous_bind_disabled",
          "authentication_required"
        ],
        "confidence_boosters": [
          "default_ad_configuration",
          "legacy_ldap_settings"
        ],
        "typical_success_rate": 0.45,
        "estimated_time": "3-8 minutes"
      },
      {
        "technique": "Kerberos User Enumeration",
        "mitre_id": "T1087.002",
        "required_services": [
          "kerberos"
        ],
        "required_ports": [
          88
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "kerberos_authentication_enabled",
          "domain_controller_accessible"
        ],
        "success_indicators": [
          "valid_usernames_found",
          "kerberos_responses_received",
          "domain_enumerable"
        ],
        "incompatible_with": [
          "kerberos_disabled",
          "account_lockout_strict",
          "network_isolation"
        ],
        "confidence_boosters": [
          "common_username_patterns",
          "service_accounts_present",
          "default_ad_users"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "Dotnet Binary Analysis",
        "mitre_id": "T1140",
        "required_services": [
          "file_access"
        ],
        "required_ports": [],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "dotnet_binaries_accessible",
          "file_system_access"
        ],
        "success_indicators": [
          "hardcoded_credentials_found",
          "configuration_strings_extracted",
          "decompilation_successful"
        ],
        "incompatible_with": [
          "obfuscated_binaries",
          "encrypted_strings",
          "native_compilation"
        ],
        "confidence_boosters": [
          "support_tools_present",
          "internal_applications",
          "development_artifacts"
        ],
        "typical_success_rate": 0.8,
        "estimated_time": "10-30 minutes"
      }
    ],
    "environmental_detectors": {
      "active_directory": {
        "port_indicators": [
          53,
          88,
          389,
          445,
          3268,
          3269,
          464,
          636,
          9389
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns",
          "adws"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server",
          "Domain Controller"
        ],
        "confidence_threshold": 0.95
      },
      "windows_domain_controller": {
        "port_indicators": [
          53,
          88,
          135,
          389,
          445,
          464,
          593,
          636,
          3268,
          3269,
          5985,
          9389
        ],
        "service_indicators": [
          "domain",
          "kerberos-sec",
          "ldap",
          "microsoft-ds",
          "globalcatLDAP"
        ],
        "banner_indicators": [
          "Microsoft Windows",
          "Domain:",
          "Site:"
        ],
        "confidence_threshold": 0.9
      },
      "smb_file_sharing": {
        "port_indicators": [
          445,
          139
        ],
        "service_indicators": [
          "microsoft-ds",
          "netbios-ssn"
        ],
        "banner_indicators": [
          "SMB",
          "Windows"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "smb_anonymous_enumeration",
          "when": "smb_service_detected",
          "reason": "often_reveals_shares_and_files_no_creds_needed"
        },
        {
          "attack": "ldap_anonymous_bind",
          "when": "active_directory_detected",
          "reason": "can_reveal_domain_structure_and_users"
        }
      ],
      "medium_priority": [
        {
          "attack": "kerberos_user_enumeration",
          "when": "kerberos_service_detected",
          "reason": "reliable_user_discovery_method"
        },
        {
          "attack": "dotnet_binary_analysis",
          "when": "dotnet_files_found",
          "reason": "high_chance_of_hardcoded_credentials"
        }
      ],
      "low_priority": [
        {
          "attack": "dns_zone_transfer",
          "when": "dns_service_detected",
          "reason": "rarely_successful_on_modern_systems"
        }
      ]
    }
  },
  "technique_intelligence": {
    "error": "Failed to extract technique_intelligence",
    "data": []
  },
  "metadata": {
    "basic_metadata": {
      "name": "Support",
      "difficulty": "Easy",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2022-07-30",
      "author": "0xdf",
      "estimated_time": "45-75 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "low",
      "skill_level_required": "beginner",
      "primary_attack_vectors": [
        "smb_enumeration",
        "dotnet_reversing",
        "ldap_enumeration",
        "active_directory"
      ],
      "key_vulnerabilities": [
        "hardcoded_credentials",
        "excessive_permissions",
        "sensitive_data_in_ldap"
      ],
      "environment_type": "corporate_domain_controller",
      "real_world_relevance": "very_high",
      "learning_value": [
        "dotnet_analysis",
        "ldap_enumeration",
        "ad_privilege_escalation",
        "dcsync_attack"
      ],
      "prerequisite_knowledge": [
        "basic_ad_concepts",
        "smb_enumeration",
        "basic_reversing"
      ]
    },
    "categorization": {
      "primary_category": "active_directory",
      "subcategories": [
        "reverse_engineering",
        "credential_access",
        "privilege_escalation"
      ],
      "attack_types": [
        "credential_access",
        "privilege_escalation",
        "lateral_movement"
      ],
      "defensive_lessons": [
        "secure_credential_storage",
        "limit_service_account_permissions",
        "sanitize_ldap_attributes",
        "monitor_dcsync_attempts"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Forest",
        "Active",
        "Sauna",
        "Resolute"
      ],
      "similarity_reasons": [
        "ad_environment",
        "ldap_enumeration",
        "service_account_abuse",
        "dcsync_attack"
      ],
      "unique_aspects": [
        "dotnet_tool_analysis",
        "hardcoded_credentials_in_binary",
        "ldap_password_discovery"
      ],
      "difficulty_factors": [
        "straightforward_attack_path",
        "realistic_scenario",
        "well_documented_techniques"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T23:24:57.637349",
    "original_file": "0xdf_writeups/Htb Support.md",
    "content_length": 40974,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 0.85,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 0.0
  }
}