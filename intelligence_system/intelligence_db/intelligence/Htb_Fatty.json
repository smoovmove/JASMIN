{
  "writeup_id": "Htb_Fatty",
  "scenario_fingerprint": {
    "scenario_name": "java_thick_client_reverse_engineering",
    "primary_services": [
      "ftp",
      "ssh",
      "custom_ssl"
    ],
    "port_signature": "21+22+1337+1338+1339",
    "service_combination": "ftp+ssh+custom_ssl_services",
    "os_family": "linux",
    "environment_type": "custom_application",
    "entry_vector": "java_client_modification",
    "privilege_path": "deserialization_to_container_escape",
    "attack_complexity": "insane",
    "estimated_time": "8-12 hours",
    "scenario_confidence": 0.92,
    "distinguishing_factors": [
      "java_thick_client_jar",
      "multiple_ssl_wrapped_services",
      "client_modification_required",
      "deserialization_vulnerability"
    ],
    "environmental_clues": [
      "anonymous_ftp_with_jar_file",
      "custom_high_ports_ssl",
      "java_application_notes",
      "development_server_setup"
    ],
    "similar_scenarios": [
      "arkham_htb_hard",
      "json_htb_hard"
    ],
    "unique_aspects": [
      "three_identical_ssl_services",
      "jar_port_modification_needed",
      "scp_archive_privilege_escalation",
      "container_to_host_escape"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Java_Client_Reverse_Engineering",
        "success_reason": "Client application exposed hardcoded connection details and could be modified",
        "prerequisite_indicators": [
          "java_application_available",
          "ftp_anonymous_access",
          "client_source_accessible"
        ],
        "recognition_patterns": [
          "jar file available for download",
          "connection errors to wrong ports",
          "hardcoded configuration values"
        ],
        "failure_modes": [
          "obfuscated_java_code",
          "encrypted_jar_contents",
          "runtime_configuration_checks"
        ],
        "environmental_factors": [
          "java_8_compatibility_requirement",
          "unprotected_ftp_service",
          "development_artifacts_exposed"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "Directory_Traversal",
        "success_reason": "Application allowed path traversal to access server binaries",
        "prerequisite_indicators": [
          "file_access_functionality",
          "insufficient_input_validation",
          "server_binaries_accessible"
        ],
        "recognition_patterns": [
          "file download features",
          "path parameters in requests",
          "error messages revealing paths"
        ],
        "failure_modes": [
          "proper_input_sanitization",
          "chroot_jail_restrictions",
          "file_access_controls"
        ],
        "environmental_factors": [
          "development_environment_exposure",
          "insufficient_security_controls",
          "debug_features_enabled"
        ],
        "success_probability": 0.78,
        "typical_timeframe": "15-30 minutes"
      },
      {
        "technique": "SQL_Injection",
        "success_reason": "Server binary revealed SQL injection vulnerability in authentication",
        "prerequisite_indicators": [
          "database_backend_present",
          "dynamic_sql_queries",
          "insufficient_parameterization"
        ],
        "recognition_patterns": [
          "login bypass attempts",
          "sql syntax in parameters",
          "database error messages"
        ],
        "failure_modes": [
          "prepared_statements_used",
          "input_validation_present",
          "database_permissions_restricted"
        ],
        "environmental_factors": [
          "legacy_database_code",
          "insufficient_secure_coding",
          "development_shortcuts"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "20-45 minutes"
      },
      {
        "technique": "Java_Deserialization",
        "success_reason": "Application accepted and processed malicious serialized objects",
        "prerequisite_indicators": [
          "java_serialization_used",
          "untrusted_input_deserialized",
          "dangerous_classes_available"
        ],
        "recognition_patterns": [
          "serialized object parameters",
          "java serialization headers",
          "object streaming functionality"
        ],
        "failure_modes": [
          "deserialization_filters",
          "whitelist_validation",
          "sandboxed_execution"
        ],
        "environmental_factors": [
          "legacy_java_patterns",
          "insufficient_security_awareness",
          "complex_object_handling"
        ],
        "success_probability": 0.89,
        "typical_timeframe": "45-90 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "fatty-client.jar with hardcoded port 8000",
        "discovery_method": "FTP anonymous access and jar analysis",
        "why_critical": "Provided entry point and revealed application architecture",
        "how_to_recognize": [
          "anonymous ftp access enabled",
          "development files exposed",
          "connection configuration errors"
        ],
        "follow_up_actions": [
          "decompile_jar_file",
          "modify_connection_settings",
          "analyze_application_logic"
        ]
      },
      {
        "discovery": "Server binary via directory traversal",
        "discovery_method": "Path traversal through client functionality",
        "why_critical": "Exposed server-side vulnerabilities and authentication logic",
        "how_to_recognize": [
          "file access features in application",
          "path parameters accepted",
          "insufficient input validation"
        ],
        "follow_up_actions": [
          "reverse_engineer_server_binary",
          "identify_sql_injection_points",
          "map_admin_functionality"
        ]
      },
      {
        "discovery": "Admin access via SQL injection",
        "discovery_method": "Authentication bypass in server binary",
        "why_critical": "Unlocked additional application functionality with serialization features",
        "how_to_recognize": [
          "dynamic sql in authentication",
          "insufficient input sanitization",
          "admin role escalation possible"
        ],
        "follow_up_actions": [
          "explore_admin_features",
          "identify_serialization_points",
          "craft_deserialization_payload"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "anonymous_user",
        "escalation_method": "FTP_to_Application_Access",
        "why_possible": "Anonymous FTP exposed client application and credentials",
        "recognition_signs": [
          "anonymous_ftp_enabled",
          "development_files_accessible",
          "hardcoded_credentials_in_notes"
        ],
        "exploitation_path": "FTP Access → Client Modification → Application Login"
      },
      {
        "privilege_level": "application_user",
        "escalation_method": "Directory_Traversal_to_Code_Access",
        "why_possible": "Application allowed file system traversal to access server binaries",
        "recognition_signs": [
          "file_download_functionality",
          "path_traversal_possible",
          "server_files_accessible"
        ],
        "exploitation_path": "User Access → Directory Traversal → Server Binary → Vulnerability Analysis"
      },
      {
        "privilege_level": "application_admin",
        "escalation_method": "Deserialization_to_RCE",
        "why_possible": "Admin functionality processed untrusted serialized objects",
        "recognition_signs": [
          "java_serialization_features",
          "admin_only_functionality",
          "object_processing_endpoints"
        ],
        "exploitation_path": "SQL Injection → Admin Access → Malicious Serialization → Container Shell"
      },
      {
        "privilege_level": "container_user",
        "escalation_method": "SCP_Archive_Manipulation",
        "why_possible": "Recurring SCP process extracted archives without validation",
        "recognition_signs": [
          "automated_backup_processes",
          "archive_extraction_behavior",
          "predictable_file_operations"
        ],
        "exploitation_path": "Container Access → Malicious Archive → SCP Process → Root SSH Access"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 21,22,1337,1338,1339 open with FTP anonymous access",
        "decision": "Enumerate FTP first for application files and documentation",
        "reasoning": "Anonymous FTP often contains critical application files and setup information",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "ssl_service_enumeration",
            "when": "if ftp yields no useful info"
          },
          {
            "option": "ssh_enumeration",
            "when": "if credentials found"
          }
        ],
        "success_indicators": [
          "application_files_found",
          "configuration_files_present",
          "documentation_available"
        ],
        "next_decision": "analyze_application_files"
      },
      {
        "step": 2,
        "situation": "Found Java thick client and configuration notes on FTP",
        "decision": "Reverse engineer and modify client to connect to correct ports",
        "reasoning": "Notes indicate port change from 8000 to 1337-1339, client needs modification",
        "confidence": 0.9,
        "prerequisites": [
          "java_8_environment",
          "jar_modification_tools"
        ],
        "success_indicators": [
          "client_connects_successfully",
          "authentication_possible"
        ],
        "failure_fallbacks": [
          "direct_ssl_service_analysis",
          "certificate_analysis"
        ]
      },
      {
        "step": 3,
        "situation": "Client modified and connecting with provided credentials",
        "decision": "Explore application functionality for vulnerabilities",
        "reasoning": "Thick clients often have directory traversal, deserialization, or injection flaws",
        "confidence": 0.85,
        "prerequisites": [
          "valid_credentials",
          "functional_client"
        ],
        "success_indicators": [
          "additional_functionality_discovered",
          "file_access_possible"
        ],
        "failure_fallbacks": [
          "credential_brute_force",
          "protocol_analysis"
        ]
      }
    ],
    "branching_logic": {
      "if_ftp_anonymous_succeeds": {
        "action": "download_all_files_and_analyze",
        "tools": [
          "ftp",
          "unzip",
          "grep",
          "strings"
        ],
        "next_phase": "application_analysis"
      },
      "if_java_client_found": {
        "action": "setup_correct_java_version_and_modify",
        "alternatives": [
          "jar_unpacking",
          "bytecode_modification",
          "configuration_changes"
        ],
        "decision_criteria": "based_on_modification_complexity"
      },
      "if_client_functional": {
        "action": "test_for_common_thick_client_vulnerabilities",
        "vulnerabilities": [
          "directory_traversal",
          "sql_injection",
          "deserialization"
        ],
        "tools": [
          "burp_suite",
          "custom_payloads"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_check_ftp_anonymous_first",
        "reasoning": "high_information_disclosure_potential_with_minimal_effort",
        "applicability": "ftp_service_detected"
      },
      {
        "rule": "prioritize_thick_client_modification_over_protocol_fuzzing",
        "reasoning": "application_logic_flaws_more_likely_than_protocol_bugs",
        "applicability": "java_thick_client_applications"
      },
      {
        "rule": "test_directory_traversal_early_in_thick_clients",
        "reasoning": "common_vulnerability_with_high_impact_for_source_code_access",
        "applicability": "file_handling_functionality_present"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Anonymous FTP Enumeration",
        "mitre_id": "T1083",
        "required_services": [
          "ftp"
        ],
        "required_ports": [
          21
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "ftp_service_running",
          "anonymous_login_enabled"
        ],
        "success_indicators": [
          "ftp_banner_responds",
          "anonymous_230_response",
          "directory_listing_accessible"
        ],
        "incompatible_with": [
          "anonymous_login_disabled",
          "ftp_service_down",
          "firewall_blocking_ftp"
        ],
        "confidence_boosters": [
          "vsftpd_banner_detected",
          "ftp_anon_nmap_script_success",
          "readable_files_present"
        ],
        "typical_success_rate": 0.92,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "Java Application Reverse Engineering",
        "mitre_id": "T1140",
        "required_services": [
          "custom_java_service"
        ],
        "required_ports": [
          "variable"
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "java_jar_file_accessible",
          "java_runtime_available",
          "decompilation_tools_available"
        ],
        "success_indicators": [
          "jar_file_extracted",
          "source_code_readable",
          "configuration_modifiable"
        ],
        "incompatible_with": [
          "jar_file_obfuscated",
          "code_signing_enforced",
          "runtime_integrity_checks"
        ],
        "confidence_boosters": [
          "jar_file_over_1mb",
          "client_server_architecture",
          "configuration_files_present"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "30-60 minutes"
      },
      {
        "technique": "SSL Service Enumeration",
        "mitre_id": "T1046",
        "required_services": [
          "ssl_wrapped_service"
        ],
        "required_ports": [
          "custom_ssl_ports"
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "ssl_service_responding",
          "certificate_accessible",
          "custom_application_running"
        ],
        "success_indicators": [
          "ssl_handshake_successful",
          "service_banner_retrieved",
          "application_protocol_identified"
        ],
        "incompatible_with": [
          "certificate_validation_strict",
          "client_certificate_required",
          "service_not_responding"
        ],
        "confidence_boosters": [
          "multiple_similar_ports",
          "custom_port_ranges",
          "development_environment_indicators"
        ],
        "typical_success_rate": 0.78,
        "estimated_time": "10-20 minutes"
      }
    ],
    "environmental_detectors": {
      "ftp_anonymous": {
        "port_indicators": [
          21
        ],
        "service_indicators": [
          "ftp",
          "vsftpd"
        ],
        "banner_indicators": [
          "220",
          "FTP",
          "vsftpd"
        ],
        "confidence_threshold": 0.9
      },
      "java_application": {
        "port_indicators": [
          8000,
          8080,
          8443,
          1337,
          1338,
          1339
        ],
        "service_indicators": [
          "java",
          "ssl"
        ],
        "technology_indicators": [
          ".jar",
          "java"
        ],
        "confidence_threshold": 0.85
      },
      "development_environment": {
        "port_indicators": [
          1337,
          1338,
          1339,
          8000
        ],
        "service_indicators": [
          "ssl",
          "custom"
        ],
        "banner_indicators": [
          "development",
          "qtc"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "anonymous_ftp_enumeration",
          "when": "ftp_service_detected",
          "reason": "often_contains_sensitive_files_and_credentials"
        },
        {
          "attack": "java_jar_analysis",
          "when": "jar_file_discovered",
          "reason": "reveals_application_logic_and_vulnerabilities"
        }
      ],
      "medium_priority": [
        {
          "attack": "ssl_service_enumeration",
          "when": "custom_ssl_ports_detected",
          "reason": "may_reveal_custom_protocols_and_services"
        },
        {
          "attack": "credential_testing",
          "when": "credentials_found_in_files",
          "reason": "discovered_credentials_often_valid"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Java Application Reverse Engineering",
        "mitre_id": "T1140",
        "category": "defense_evasion",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "unzip",
            "command_template": "unzip -d {output_dir}/ {jar_file}",
            "actual_command": "unzip -d unzipped/ fatty-client.jar",
            "output_pattern": "Archive extracted to directory",
            "effectiveness_rating": 5,
            "reliability": 0.99
          },
          {
            "name": "jar",
            "command_template": "jar -cmf META-INF/MANIFEST.MF {output_jar} *",
            "actual_command": "jar -cmf META-INF/MANIFEST.MF ../fatty-client-fixed_port.jar *",
            "success_factors": [
              "valid_manifest_file",
              "proper_directory_structure"
            ],
            "effectiveness_rating": 4
          },
          {
            "name": "grep",
            "command_template": "grep -r '{search_term}' .",
            "actual_command": "grep -r 'server.fatty.htb' .",
            "output_pattern": "./beans.xml:      <constructor-arg index=\"0\" value = \"server.fatty.htb\"/>",
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "java_8_installed",
          "jar_file_accessible",
          "unzip_utility_available"
        ],
        "success_indicators": [
          "jar_extracts_without_errors",
          "configuration_files_identified",
          "application_runs_after_repack"
        ],
        "common_failures": [
          "sha256_digest_mismatch",
          "manifest_corruption",
          "java_version_incompatibility"
        ],
        "follow_up_techniques": [
          "configuration_modification",
          "network_traffic_analysis",
          "application_functionality_testing"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "Java Version Management",
        "mitre_id": "T1562.001",
        "category": "defense_evasion",
        "phase": "preparation",
        "tools_used": [
          {
            "name": "update-alternatives",
            "command_template": "update-alternatives --config java",
            "actual_command": "update-alternatives --config java",
            "output_pattern": "Selection menu with available Java versions",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "java",
            "command_template": "java -version",
            "actual_command": "java -version",
            "success_factors": [
              "correct_java_8_version_active"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "multiple_java_versions_installed",
          "root_or_sudo_access"
        ],
        "success_indicators": [
          "java_8_version_active",
          "application_compatibility_restored"
        ],
        "common_failures": [
          "java_8_not_installed",
          "path_configuration_issues"
        ],
        "follow_up_techniques": [
          "java_application_execution",
          "jar_file_analysis"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Network Traffic Analysis",
        "mitre_id": "T1040",
        "category": "discovery",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "wireshark",
            "command_template": "wireshark -i {interface}",
            "actual_command": "wireshark -i tun0",
            "output_pattern": "DNS queries and TCP connection attempts",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "hosts_file_modification",
            "command_template": "echo '{ip} {hostname}' >> /etc/hosts",
            "actual_command": "echo '10.10.10.181 fatty.htb server.fatty.htb' >> /etc/hosts",
            "success_factors": [
              "dns_resolution_redirected"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "network_capture_capability",
          "application_generating_traffic"
        ],
        "success_indicators": [
          "dns_queries_captured",
          "connection_attempts_identified",
          "target_ports_discovered"
        ],
        "common_failures": [
          "wrong_interface_monitored",
          "traffic_not_generated"
        ],
        "follow_up_techniques": [
          "port_redirection",
          "application_configuration_modification"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "FTP Anonymous Access",
        "mitre_id": "T1021.003",
        "category": "lateral_movement",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "ftp",
            "command_template": "ftp {target_ip}",
            "actual_command": "ftp 10.10.10.174",
            "output_pattern": "230 Login successful",
            "effectiveness_rating": 5,
            "reliability": 0.99
          },
          {
            "name": "mget",
            "command_template": "mget *",
            "actual_command": "mget *",
            "success_factors": [
              "anonymous_access_enabled",
              "files_present"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "ftp_service_accessible",
          "anonymous_login_enabled"
        ],
        "success_indicators": [
          "successful_anonymous_login",
          "file_listing_obtained",
          "files_downloaded_successfully"
        ],
        "common_failures": [
          "anonymous_access_disabled",
          "network_connectivity_issues"
        ],
        "follow_up_techniques": [
          "file_analysis",
          "credential_extraction",
          "application_reverse_engineering"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Wireshark",
        "use_case": "java_application_traffic_analysis",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "medium",
        "essential_for": [
          "network_protocol_analysis",
          "application_debugging"
        ],
        "alternatives": [
          "tcpdump",
          "netstat"
        ],
        "best_practices": [
          "monitor_correct_network_interface",
          "filter_traffic_by_application_process",
          "capture_during_application_interaction"
        ]
      },
      {
        "tool": "Java JAR manipulation",
        "use_case": "thick_client_modification",
        "effectiveness_rating": 4,
        "reliability": 0.85,
        "learning_curve": "high",
        "essential_for": [
          "java_application_testing",
          "configuration_bypass"
        ],
        "alternatives": [
          "jadx",
          "jd-gui",
          "bytecode_manipulation"
        ],
        "best_practices": [
          "backup_original_jar_before_modification",
          "understand_manifest_structure",
          "test_repackaged_application_thoroughly"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "java_thick_client_analysis_setup",
        "steps": [
          {
            "step": 1,
            "command": "ftp 10.10.10.174",
            "purpose": "Access anonymous FTP service",
            "expected_output": "FTP login successful"
          },
          {
            "step": 2,
            "command": "mget *",
            "purpose": "Download all available files",
            "expected_output": "fatty-client.jar and note files downloaded"
          },
          {
            "step": 3,
            "command": "update-alternatives --config java",
            "purpose": "Switch to Java 8 for compatibility",
            "expected_output": "Java 8 selected as active version"
          },
          {
            "step": 4,
            "command": "echo '10.10.10.181 fatty.htb server.fatty.htb' >> /etc/hosts",
            "purpose": "Configure DNS resolution",
            "expected_output": "Hostname resolution configured"
          },
          {
            "step": 5,
            "command": "unzip -d unzipped/ fatty-client.jar",
            "purpose": "Extract JAR contents for analysis",
            "expected_output": "JAR contents extracted to directory"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "10-20 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Fatty",
      "difficulty": "Insane",
      "os": "Linux",
      "platform": "HackTheBox",
      "release_date": "2020-02-08",
      "author": "qtc",
      "estimated_time": "6-8 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "very_high",
      "skill_level_required": "expert",
      "primary_attack_vectors": [
        "java_reverse_engineering",
        "deserialization",
        "directory_traversal"
      ],
      "key_vulnerabilities": [
        "java_client_modification",
        "sql_injection",
        "deserialization_rce",
        "scp_archive_manipulation"
      ],
      "environment_type": "java_application_server",
      "real_world_relevance": "very_high",
      "learning_value": [
        "java_reversing",
        "thick_client_attacks",
        "deserialization_exploits",
        "container_escape"
      ],
      "prerequisite_knowledge": [
        "java_programming",
        "reverse_engineering",
        "serialization_concepts",
        "linux_containers"
      ]
    },
    "categorization": {
      "primary_category": "reverse_engineering",
      "subcategories": [
        "thick_client_security",
        "deserialization",
        "container_security"
      ],
      "attack_types": [
        "code_analysis",
        "client_modification",
        "injection_attacks",
        "privilege_escalation"
      ],
      "defensive_lessons": [
        "secure_client_design",
        "input_validation",
        "secure_deserialization",
        "container_hardening"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Arkham",
        "Jeeves",
        "Kotarak"
      ],
      "similarity_reasons": [
        "java_exploitation",
        "deserialization_attacks",
        "complex_attack_chains"
      ],
      "unique_aspects": [
        "thick_client_modification",
        "scp_archive_manipulation",
        "multi_stage_container_escape"
      ],
      "difficulty_factors": [
        "extensive_reverse_engineering",
        "multiple_exploitation_phases",
        "advanced_java_concepts"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T18:16:06.111726",
    "original_file": "0xdf_writeups/Htb Fatty.md",
    "content_length": 72082,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}