{
  "writeup_id": "Htb_Object",
  "scenario_fingerprint": {
    "scenario_name": "jenkins_pipeline_execution_to_ad_privilege_escalation",
    "primary_services": [
      "http",
      "winrm",
      "jenkins",
      "active_directory"
    ],
    "port_signature": "80+5985+8080",
    "service_combination": "iis+winrm+jenkins",
    "os_family": "windows_server",
    "environment_type": "active_directory",
    "entry_vector": "jenkins_pipeline_execution",
    "privilege_path": "jenkins_to_winrm_to_domain_admin",
    "attack_complexity": "hard",
    "estimated_time": "120-180 minutes",
    "scenario_confidence": 0.88,
    "distinguishing_factors": [
      "jenkins_user_registration_enabled",
      "pipeline_creation_without_build_permissions",
      "outbound_tcp_firewall_restrictions",
      "bloodhound_ad_enumeration_required"
    ],
    "environmental_clues": [
      "jenkins_on_jetty_with_iis_coexistence",
      "winrm_enabled",
      "multi_hop_ad_privilege_escalation",
      "logon_script_abuse"
    ],
    "similar_scenarios": [
      "jeeves_htb_medium",
      "worker_htb_medium"
    ],
    "unique_aspects": [
      "jenkins_pipeline_forced_execution",
      "three_hop_ad_escalation",
      "password_change_to_logon_script_abuse",
      "group_privilege_exploitation"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "Jenkins_Job_Creation_and_Execution",
        "success_reason": "User registration enabled with job creation permissions but restricted build permissions",
        "prerequisite_indicators": [
          "jenkins_server_accessible",
          "user_registration_enabled",
          "authenticated_user_can_create_jobs"
        ],
        "recognition_patterns": [
          "jenkins login page allows registration",
          "create job/new item accessible after auth",
          "build now button missing indicates permission restrictions"
        ],
        "failure_modes": [
          "user_registration_disabled",
          "no_job_creation_permissions",
          "script_console_access_denied",
          "groovy_execution_blocked"
        ],
        "environmental_factors": [
          "default_jenkins_permissions",
          "misconfigured_user_privileges",
          "automation_server_exposure"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "10-30 minutes"
      },
      {
        "technique": "Windows_Batch_Command_Execution",
        "success_reason": "Jenkins job allows Windows batch command execution without proper sandboxing",
        "prerequisite_indicators": [
          "windows_target_system",
          "jenkins_on_windows",
          "batch_command_build_step_available"
        ],
        "recognition_patterns": [
          "execute windows batch command option",
          "jenkins running on windows (jetty + winrm)",
          "build step configuration accessible"
        ],
        "failure_modes": [
          "linux_target_system",
          "command_execution_sandboxed",
          "build_permissions_denied"
        ],
        "environmental_factors": [
          "jenkins_running_as_service_account",
          "windows_server_environment",
          "insufficient_job_restrictions"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "5-15 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Jenkins server with user registration",
        "discovery_method": "Port scan revealing Jenkins on 8080",
        "why_critical": "Allows authenticated access to create malicious jobs",
        "how_to_recognize": [
          "jetty server on port 8080",
          "jenkins login page with registration",
          "version disclosure in footer"
        ],
        "follow_up_actions": [
          "register_user_account",
          "explore_job_creation_permissions",
          "test_build_execution_methods"
        ]
      },
      {
        "discovery": "Job creation permissions without build permissions",
        "discovery_method": "Authenticated Jenkins exploration",
        "why_critical": "Indicates misconfigured permissions that can be bypassed",
        "how_to_recognize": [
          "new item/create job accessible",
          "build now button missing",
          "manage jenkins access denied"
        ],
        "follow_up_actions": [
          "create_job_with_malicious_payload",
          "find_alternative_execution_methods",
          "test_api_token_usage"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "authenticated_jenkins_user",
        "escalation_method": "Job_Creation_to_Code_Execution",
        "why_possible": "Jenkins allows job creation with Windows batch commands despite restricted build permissions",
        "recognition_signs": [
          "windows_batch_command_option_available",
          "job_configuration_saves_successfully",
          "alternative_execution_methods_exist"
        ],
        "exploitation_path": "Register User → Create Job → Add Batch Command → Trigger Execution"
      },
      {
        "privilege_level": "jenkins_service_account",
        "escalation_method": "Service_Account_to_Domain_Privilege",
        "why_possible": "Jenkins likely running as service account with potential domain permissions",
        "recognition_signs": [
          "winrm_port_open",
          "jenkins_on_domain_joined_system",
          "service_account_context_execution"
        ],
        "exploitation_path": "Code Execution → Credential Discovery → WinRM Access → AD Enumeration"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 80,5985,8080 open on Windows host",
        "decision": "Prioritize Jenkins on 8080 for code execution over IIS enumeration",
        "reasoning": "Jenkins automation server provides direct path to command execution",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "iis_enumeration",
            "when": "if jenkins access fails"
          },
          {
            "option": "winrm_bruteforce",
            "when": "if credentials discovered"
          }
        ],
        "success_indicators": [
          "jenkins_login_accessible",
          "user_registration_enabled",
          "job_creation_permissions"
        ],
        "next_decision": "evaluate_jenkins_permissions"
      },
      {
        "step": 2,
        "situation": "Jenkins accessible but no Build Now button visible",
        "decision": "Use alternative job triggering methods instead of privilege escalation",
        "reasoning": "Build permissions may exist through different mechanisms",
        "confidence": 0.85,
        "prerequisites": [
          "jenkins_job_created",
          "build_step_configured"
        ],
        "success_indicators": [
          "scheduled_build_executes",
          "remote_trigger_works"
        ],
        "failure_fallbacks": [
          "api_token_method",
          "webhook_triggers",
          "scm_polling"
        ]
      },
      {
        "step": 3,
        "situation": "Code execution achieved via Jenkins job",
        "decision": "Enumerate firewall rules before attempting reverse shells",
        "reasoning": "Outbound connectivity restrictions common in enterprise environments",
        "confidence": 0.8,
        "prerequisites": [
          "command_execution_confirmed"
        ],
        "success_indicators": [
          "firewall_rules_identified",
          "allowed_protocols_found"
        ],
        "failure_fallbacks": [
          "dns_exfiltration",
          "http_callbacks",
          "file_based_communication"
        ]
      }
    ],
    "branching_logic": {
      "if_jenkins_accessible": {
        "action": "create_job_with_windows_batch_command",
        "tools": [
          "jenkins_web_interface"
        ],
        "next_phase": "trigger_job_execution"
      },
      "if_build_now_missing": {
        "action": "try_alternative_triggers",
        "alternatives": [
          "scheduled_builds",
          "remote_api_triggers",
          "scm_webhooks"
        ],
        "decision_criteria": "based_on_available_permissions"
      },
      "if_execution_achieved": {
        "action": "enumerate_network_restrictions",
        "purpose": "determine_exfiltration_methods",
        "tools": [
          "netstat",
          "firewall_commands",
          "connectivity_tests"
        ]
      },
      "if_credentials_found": {
        "action": "attempt_winrm_connection",
        "tools": [
          "evil-winrm",
          "winrs"
        ],
        "next_phase": "active_directory_enumeration"
      }
    },
    "optimization_rules": [
      {
        "rule": "always_check_jenkins_job_permissions_before_exploit_attempts",
        "reasoning": "legitimate_functionality_often_easier_than_exploits",
        "applicability": "jenkins_environments"
      },
      {
        "rule": "test_outbound_connectivity_early_in_windows_environments",
        "reasoning": "firewall_restrictions_affect_payload_strategy",
        "applicability": "enterprise_windows_networks"
      },
      {
        "rule": "use_scheduled_triggers_when_manual_build_unavailable",
        "reasoning": "cron_syntax_provides_immediate_execution_option",
        "applicability": "restricted_jenkins_permissions"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Jenkins Pipeline Execution",
        "mitre_id": "T1059.007",
        "required_services": [
          "http",
          "jenkins"
        ],
        "required_ports": [
          8080,
          8443
        ],
        "os_requirements": [
          "windows",
          "linux"
        ],
        "environmental_prerequisites": [
          "jenkins_server_accessible",
          "user_registration_enabled",
          "pipeline_creation_permissions"
        ],
        "success_indicators": [
          "jenkins_login_page_accessible",
          "account_creation_successful",
          "pipeline_job_creation_allowed"
        ],
        "incompatible_with": [
          "user_registration_disabled",
          "strict_rbac_enforced",
          "network_isolation"
        ],
        "confidence_boosters": [
          "default_jenkins_configuration",
          "groovy_plugin_installed",
          "build_triggers_available"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "WinRM Authentication",
        "mitre_id": "T1021.006",
        "required_services": [
          "winrm"
        ],
        "required_ports": [
          5985,
          5986
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "winrm_service_enabled",
          "valid_credentials_obtained",
          "network_connectivity"
        ],
        "success_indicators": [
          "winrm_port_open",
          "authentication_successful",
          "powershell_session_established"
        ],
        "incompatible_with": [
          "winrm_disabled",
          "certificate_authentication_only",
          "firewall_blocking"
        ],
        "confidence_boosters": [
          "default_winrm_configuration",
          "domain_joined_machine",
          "service_account_credentials"
        ],
        "typical_success_rate": 0.9,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "Active Directory Privilege Escalation",
        "mitre_id": "T1484.001",
        "required_services": [
          "ldap",
          "kerberos"
        ],
        "required_ports": [
          389,
          636,
          88
        ],
        "os_requirements": [
          "windows"
        ],
        "environmental_prerequisites": [
          "active_directory_domain",
          "domain_user_access",
          "bloodhound_enumeration_possible"
        ],
        "success_indicators": [
          "domain_controller_accessible",
          "user_permissions_enumerated",
          "privilege_escalation_path_identified"
        ],
        "incompatible_with": [
          "standalone_workgroup",
          "strict_delegation_controls",
          "comprehensive_monitoring"
        ],
        "confidence_boosters": [
          "default_ad_permissions",
          "service_accounts_present",
          "group_policy_misconfigurations"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "30-60 minutes"
      }
    ],
    "environmental_detectors": {
      "jenkins_server": {
        "port_indicators": [
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "Jenkins",
          "Jetty"
        ],
        "path_indicators": [
          "/login",
          "/manage",
          "/job"
        ],
        "confidence_threshold": 0.95
      },
      "windows_server": {
        "port_indicators": [
          80,
          443,
          5985,
          5986
        ],
        "service_indicators": [
          "http",
          "winrm",
          "wsman"
        ],
        "banner_indicators": [
          "Microsoft-IIS",
          "Microsoft-HTTPAPI"
        ],
        "confidence_threshold": 0.9
      },
      "active_directory": {
        "port_indicators": [
          53,
          88,
          389,
          445,
          3268
        ],
        "service_indicators": [
          "kerberos",
          "ldap",
          "smb",
          "dns"
        ],
        "banner_indicators": [
          "Active Directory",
          "Windows Server"
        ],
        "confidence_threshold": 0.85
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "jenkins_pipeline_execution",
          "when": "jenkins_server_detected_and_registration_enabled",
          "reason": "often_allows_code_execution_with_minimal_privileges"
        },
        {
          "attack": "winrm_authentication",
          "when": "winrm_port_open_and_credentials_available",
          "reason": "direct_shell_access_high_success_rate"
        }
      ],
      "medium_priority": [
        {
          "attack": "active_directory_enumeration",
          "when": "domain_environment_detected",
          "reason": "multiple_escalation_paths_typically_available"
        },
        {
          "attack": "iis_enumeration",
          "when": "iis_server_detected",
          "reason": "may_reveal_additional_applications_or_files"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "Jenkins Job Execution",
        "mitre_id": "T1053.003",
        "category": "execution",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "Jenkins Web Interface",
            "command_template": "Create job with 'Execute Windows batch command' build step",
            "actual_command": "powershell -c whoami",
            "output_pattern": "Console output shows command execution results",
            "effectiveness_rating": 5,
            "reliability": 0.95
          },
          {
            "name": "Jenkins Remote Trigger",
            "command_template": "curl \"http://{username}:{api_token}@{host}/job/{job_name}/build?token={trigger_token}\"",
            "actual_command": "curl \"http://0xdf:1176e6f7ba9fdf90c7ec7dba8c413cda89@object.htb:8080/job/0xdf's%20job/build?token=0xdfToken\"",
            "success_factors": [
              "valid_api_token",
              "proper_url_encoding",
              "remote_trigger_enabled"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "jenkins_account_creation_enabled",
          "job_creation_permissions",
          "api_token_generation_access"
        ],
        "success_indicators": [
          "job_created_successfully",
          "build_history_shows_execution",
          "console_output_displays_command_results"
        ],
        "common_failures": [
          "insufficient_permissions_for_build_now",
          "outbound_firewall_blocking_callbacks",
          "authentication_token_misconfiguration"
        ],
        "follow_up_techniques": [
          "firewall_enumeration",
          "credential_harvesting",
          "privilege_escalation"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "Windows Firewall Enumeration",
        "mitre_id": "T1518.001",
        "category": "discovery",
        "phase": "post_exploitation",
        "tools_used": [
          {
            "name": "Get-NetFirewallRule",
            "command_template": "powershell -c Get-NetFirewallRule -Direction {direction} -Enabled True -Action {action}",
            "actual_command": "powershell -c Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block",
            "output_pattern": "DisplayName: BlockOutboundDC",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "powershell_execution_capability",
          "sufficient_privileges_for_firewall_query"
        ],
        "success_indicators": [
          "firewall_rules_enumerated",
          "blocking_rules_identified",
          "network_restrictions_understood"
        ],
        "common_failures": [
          "insufficient_privileges",
          "powershell_execution_policy_restrictions"
        ],
        "follow_up_techniques": [
          "alternative_communication_channels",
          "local_credential_harvesting",
          "winrm_authentication"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "BloodHound Active Directory Enumeration",
        "mitre_id": "T1087.002",
        "category": "discovery",
        "phase": "post_exploitation",
        "tools_used": [
          {
            "name": "BloodHound",
            "command_template": "Run after obtaining domain credentials",
            "actual_command": "Referenced as essential for AD privilege escalation paths",
            "output_pattern": "Visual graph showing privilege escalation paths",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "domain_credentials_obtained",
          "network_access_to_domain_controller",
          "bloodhound_collector_deployment"
        ],
        "success_indicators": [
          "domain_objects_enumerated",
          "privilege_escalation_paths_identified",
          "attack_paths_visualized"
        ],
        "common_failures": [
          "insufficient_domain_privileges",
          "network_connectivity_issues",
          "detection_by_security_tools"
        ],
        "follow_up_techniques": [
          "password_change_attacks",
          "logon_script_abuse",
          "group_privilege_escalation"
        ],
        "time_investment": "15-30 minutes",
        "skill_level": "intermediate"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Jenkins",
        "use_case": "initial_code_execution",
        "effectiveness_rating": 5,
        "reliability": 0.95,
        "learning_curve": "low",
        "essential_for": [
          "ci_cd_environments"
        ],
        "alternatives": [
          "direct_shell_access",
          "web_shell_upload"
        ],
        "best_practices": [
          "create_account_if_registration_open",
          "use_api_tokens_for_automation",
          "leverage_scheduled_builds_if_manual_trigger_blocked"
        ]
      },
      {
        "tool": "BloodHound",
        "use_case": "active_directory_attack_path_discovery",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "medium",
        "essential_for": [
          "active_directory_environments"
        ],
        "alternatives": [
          "manual_ldap_enumeration",
          "powerview"
        ],
        "best_practices": [
          "run_after_obtaining_domain_credentials",
          "focus_on_shortest_path_to_domain_admin",
          "validate_paths_before_exploitation"
        ]
      },
      {
        "tool": "Get-NetFirewallRule",
        "use_case": "network_restriction_discovery",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "windows_environments"
        ],
        "alternatives": [
          "netsh_advfirewall",
          "manual_connection_testing"
        ],
        "best_practices": [
          "filter_by_direction_and_action",
          "focus_on_enabled_rules_only",
          "understand_blocking_patterns"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "jenkins_job_execution_setup",
        "steps": [
          {
            "step": 1,
            "command": "Create Jenkins account via web interface",
            "purpose": "Gain authenticated access to Jenkins",
            "expected_output": "Successful login to Jenkins dashboard"
          },
          {
            "step": 2,
            "command": "Create new job -> Freestyle project -> Add build step -> Execute Windows batch command",
            "purpose": "Setup job for command execution",
            "expected_output": "Job configuration saved"
          },
          {
            "step": 3,
            "command": "Generate API token in user profile",
            "purpose": "Enable remote job triggering",
            "expected_output": "API token generated successfully"
          },
          {
            "step": 4,
            "command": "curl \"http://username:api_token@host/job/job_name/build?token=trigger_token\"",
            "purpose": "Remotely trigger job execution",
            "expected_output": "Job executes and shows in build history"
          }
        ],
        "success_rate": 0.9,
        "typical_duration": "10-15 minutes"
      },
      {
        "sequence_name": "firewall_enumeration_and_bypass",
        "steps": [
          {
            "step": 1,
            "command": "powershell -c Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block",
            "purpose": "Identify outbound blocking rules",
            "expected_output": "List of active outbound blocking firewall rules"
          },
          {
            "step": 2,
            "command": "Test alternative communication methods (WinRM, etc.)",
            "purpose": "Find allowed communication channels",
            "expected_output": "Identification of permitted protocols"
          },
          {
            "step": 3,
            "command": "Harvest local credentials for alternative access",
            "purpose": "Enable direct authentication bypassing firewall",
            "expected_output": "Valid credentials for WinRM or other services"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "15-25 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Object",
      "difficulty": "Hard",
      "os": "Windows Server 2016+",
      "platform": "HackTheBox",
      "release_date": "2022-02-28",
      "author": "MrR3boot",
      "estimated_time": "4-6 hours"
    },
    "intelligence_metadata": {
      "attack_complexity": "high",
      "skill_level_required": "advanced",
      "primary_attack_vectors": [
        "jenkins_exploitation",
        "active_directory",
        "winrm"
      ],
      "key_vulnerabilities": [
        "jenkins_pipeline_execution",
        "ad_privilege_escalation",
        "logon_script_abuse"
      ],
      "environment_type": "corporate_mixed_infrastructure",
      "real_world_relevance": "very_high",
      "learning_value": [
        "jenkins_security",
        "ad_attack_chains",
        "bloodhound_analysis",
        "firewall_evasion"
      ],
      "prerequisite_knowledge": [
        "jenkins_administration",
        "advanced_ad_concepts",
        "bloodhound_usage",
        "winrm_protocols"
      ]
    },
    "categorization": {
      "primary_category": "active_directory",
      "subcategories": [
        "jenkins_exploitation",
        "privilege_escalation",
        "lateral_movement"
      ],
      "attack_types": [
        "initial_access",
        "credential_access",
        "privilege_escalation",
        "lateral_movement"
      ],
      "defensive_lessons": [
        "jenkins_hardening",
        "logon_script_security",
        "group_privilege_auditing",
        "network_segmentation"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Forest",
        "Blackfield",
        "Intelligence"
      ],
      "similarity_reasons": [
        "multi_hop_ad_escalation",
        "bloodhound_analysis",
        "complex_attack_chains"
      ],
      "unique_aspects": [
        "jenkins_pipeline_exploitation",
        "logon_script_abuse",
        "firewall_bypass_techniques"
      ],
      "difficulty_factors": [
        "multiple_escalation_hops",
        "firewall_restrictions",
        "complex_permissions_model"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T13:01:34.880976",
    "original_file": "0xdf_writeups/Htb Object.md",
    "content_length": 66476,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 0.9166666666666667,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 0.6666666666666666,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}