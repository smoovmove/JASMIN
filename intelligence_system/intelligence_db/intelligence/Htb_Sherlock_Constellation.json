{
  "writeup_id": "Htb_Sherlock_Constellation",
  "scenario_fingerprint": {
    "scenario_name": "insider_threat_url_forensics",
    "primary_services": [
      "discord",
      "google_search",
      "aws_s3"
    ],
    "port_signature": "443",
    "service_combination": "https+discord+google+cloud_storage",
    "os_family": "unknown",
    "environment_type": "corporate_workstation",
    "entry_vector": "insider_threat_recruitment",
    "privilege_path": "legitimate_employee_access",
    "attack_complexity": "medium",
    "estimated_time": "2-4 hours",
    "scenario_confidence": 0.9,
    "distinguishing_factors": [
      "discord_file_sharing",
      "google_search_osint",
      "pdf_metadata_manipulation",
      "aws_s3_exfiltration"
    ],
    "environmental_clues": [
      "memory_dump_analysis",
      "url_artifacts_extraction",
      "discord_cdn_links",
      "google_search_parameters"
    ],
    "similar_scenarios": [
      "corporate_data_exfiltration",
      "social_engineering_recruitment"
    ],
    "unique_aspects": [
      "unfurl_url_analysis",
      "anticorp_threat_group",
      "tar_archive_instructions",
      "timestamp_forensics_from_urls"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "URL_Forensics_Analysis",
        "success_reason": "Discord and Google URLs contained embedded timestamps and metadata that revealed timeline of insider threat activity",
        "prerequisite_indicators": [
          "memory_dump_available",
          "urls_extracted_from_memory",
          "discord_cdn_links_present",
          "google_search_urls_with_parameters"
        ],
        "recognition_patterns": [
          "Discord CDN URLs with channel/message IDs",
          "Google search URLs with timestamp parameters",
          "URL parameters containing encoded data",
          "Snowflake ID patterns in Discord URLs"
        ],
        "failure_modes": [
          "urls_not_preserved_in_memory",
          "encrypted_communications",
          "url_parameters_stripped",
          "private_browsing_mode_used"
        ],
        "environmental_factors": [
          "unencrypted_memory_dumps",
          "browser_history_retention",
          "discord_metadata_preservation",
          "google_search_parameter_logging"
        ],
        "success_probability": 0.75,
        "typical_timeframe": "30-60 minutes"
      },
      {
        "technique": "PDF_Metadata_Extraction",
        "success_reason": "PDF contained unredacted metadata including author email and creation details",
        "prerequisite_indicators": [
          "pdf_files_available",
          "metadata_not_stripped",
          "exiftool_accessible"
        ],
        "recognition_patterns": [
          "Author field with email addresses",
          "Custom producer/creator fields",
          "Anomalous creation dates",
          "Subject fields with campaign info"
        ],
        "failure_modes": [
          "metadata_properly_stripped",
          "pdf_created_with_secure_tools",
          "metadata_sanitization_applied"
        ],
        "environmental_factors": [
          "threat_actor_opsec_failures",
          "standard_pdf_creation_tools",
          "lack_of_metadata_awareness"
        ],
        "success_probability": 0.82,
        "typical_timeframe": "5-10 minutes"
      },
      {
        "technique": "OSINT_Email_Investigation",
        "success_reason": "Threat actor used same email address across multiple platforms including LinkedIn",
        "prerequisite_indicators": [
          "email_addresses_discovered",
          "public_social_media_presence",
          "search_engines_accessible"
        ],
        "recognition_patterns": [
          "Email addresses in metadata",
          "LinkedIn profile matches",
          "Consistent usernames across platforms",
          "Geographic location data"
        ],
        "failure_modes": [
          "proper_opsec_compartmentalization",
          "fake_identity_management",
          "private_social_media_profiles"
        ],
        "environmental_factors": [
          "threat_actor_opsec_negligence",
          "public_social_media_profiles",
          "search_engine_indexing"
        ],
        "success_probability": 0.65,
        "typical_timeframe": "15-30 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "Discord Channel ID with embedded timestamp",
        "discovery_method": "Unfurl URL analysis tool",
        "why_critical": "Revealed exact start time of insider threat communications",
        "how_to_recognize": [
          "Discord CDN URLs in memory dumps",
          "Snowflake ID patterns (18-19 digit numbers)",
          "Channel/message ID structure in URLs"
        ],
        "follow_up_actions": [
          "decode_all_snowflake_ids",
          "build_communication_timeline",
          "correlate_with_other_artifacts"
        ]
      },
      {
        "discovery": "PDF metadata with threat actor email",
        "discovery_method": "exiftool metadata extraction",
        "why_critical": "Provided direct link to threat actor identity for OSINT investigation",
        "how_to_recognize": [
          "Author field with suspicious domains",
          "Custom producer/creator fields",
          "Anomalous or future creation dates"
        ],
        "follow_up_actions": [
          "osint_investigation_on_email",
          "search_social_media_platforms",
          "correlate_geographic_indicators"
        ]
      },
      {
        "discovery": "Google search parameters with timestamps",
        "discovery_method": "URL parameter analysis",
        "why_critical": "Showed insider threat researching how to exfiltrate data",
        "how_to_recognize": [
          "sca_esv parameter in Google URLs",
          "Search query about data exfiltration methods",
          "Original vs suggested search terms"
        ],
        "follow_up_actions": [
          "decode_timestamp_parameters",
          "analyze_search_behavior_patterns",
          "correlate_with_file_transfer_timeline"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "insider_employee_access",
        "escalation_method": "social_engineering_bribery",
        "why_possible": "Employee had legitimate access to sensitive data and financial motivation",
        "recognition_signs": [
          "direct_message_communications",
          "financial_incentives_offered",
          "specific_data_exfiltration_instructions"
        ],
        "exploitation_path": "Initial Contact → File Transfer → Search Research → Data Exfiltration"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Extracted URLs from memory during insider threat investigation",
        "decision": "Analyze URLs with forensic tools to extract timestamps and metadata",
        "reasoning": "URLs contain embedded forensic artifacts like timestamps, IDs, and parameters that reveal timeline",
        "confidence": 0.95,
        "alternatives": [
          {
            "option": "manual_url_analysis",
            "when": "if specialized tools unavailable"
          },
          {
            "option": "network_traffic_analysis",
            "when": "if pcap data available"
          }
        ],
        "success_indicators": [
          "timestamps_extracted_from_urls",
          "file_metadata_recovered",
          "communication_timeline_established"
        ],
        "next_decision": "correlate_url_artifacts_with_file_metadata"
      },
      {
        "step": 2,
        "situation": "Discord URL reveals channel ID and file upload timestamps",
        "decision": "Use Unfurl tool to decode Discord snowflake IDs for precise timestamps",
        "reasoning": "Discord IDs contain embedded timestamps that reveal exact communication timeline",
        "confidence": 0.9,
        "prerequisites": [
          "discord_url_extracted",
          "unfurl_tool_available"
        ],
        "success_indicators": [
          "channel_creation_time_found",
          "file_upload_time_extracted"
        ],
        "failure_fallbacks": [
          "manual_snowflake_decoding",
          "discord_api_lookup"
        ]
      },
      {
        "step": 3,
        "situation": "PDF file available with suspicious metadata",
        "decision": "Extract PDF metadata with exiftool and cross-reference with URL timeline",
        "reasoning": "PDF metadata may contain creator info and timestamps for attribution",
        "confidence": 0.85,
        "prerequisites": [
          "pdf_file_available"
        ],
        "success_indicators": [
          "author_email_extracted",
          "creation_date_found",
          "producer_identified"
        ],
        "failure_fallbacks": [
          "strings_analysis",
          "hex_editor_examination"
        ]
      },
      {
        "step": 4,
        "situation": "Email address found in PDF metadata",
        "decision": "Conduct OSINT on email address for threat actor attribution",
        "reasoning": "Email addresses often link to social media profiles revealing real identity",
        "confidence": 0.8,
        "prerequisites": [
          "email_address_extracted",
          "osint_tools_available"
        ],
        "success_indicators": [
          "linkedin_profile_found",
          "real_name_identified",
          "location_discovered"
        ],
        "failure_fallbacks": [
          "search_engine_dorking",
          "social_media_enumeration"
        ]
      }
    ],
    "branching_logic": {
      "if_discord_url_found": {
        "action": "decode_snowflake_ids_for_timestamps",
        "tools": [
          "unfurl",
          "discord_snowflake_decoder"
        ],
        "next_phase": "timeline_construction"
      },
      "if_google_url_found": {
        "action": "extract_search_query_and_timestamp",
        "purpose": "understand_insider_actions_post_contact",
        "tools": [
          "url_decoder",
          "unfurl"
        ]
      },
      "if_pdf_metadata_contains_email": {
        "action": "osint_investigation",
        "purpose": "threat_actor_attribution",
        "tools": [
          "google_search",
          "linkedin",
          "social_media_search"
        ]
      },
      "if_timestamps_extracted": {
        "action": "create_incident_timeline",
        "purpose": "establish_sequence_of_events",
        "correlation_points": [
          "first_contact",
          "file_delivery",
          "post_delivery_actions"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_use_unfurl_for_url_forensics",
        "reasoning": "specialized_tool_extracts_maximum_forensic_value_from_urls",
        "applicability": "any_url_based_investigation"
      },
      {
        "rule": "cross_reference_url_timestamps_with_file_metadata",
        "reasoning": "validates_timeline_and_identifies_inconsistencies",
        "applicability": "investigations_with_multiple_artifact_types"
      },
      {
        "rule": "conduct_osint_on_any_email_addresses_in_metadata",
        "reasoning": "high_probability_of_attribution_success",
        "applicability": "threat_actor_identification_required"
      },
      {
        "rule": "decode_platform_specific_ids_for_timestamps",
        "reasoning": "social_platforms_embed_creation_times_in_ids",
        "applicability": "discord_twitter_other_social_platform_urls"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "URL_Forensics",
        "mitre_id": "T1005",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "url_artifacts_available",
          "browser_history_accessible",
          "memory_dumps_contain_urls"
        ],
        "success_indicators": [
          "timestamp_extraction_possible",
          "parameter_decoding_successful",
          "metadata_preserved_in_urls"
        ],
        "incompatible_with": [
          "encrypted_traffic_only",
          "no_url_artifacts",
          "corrupted_memory_dumps"
        ],
        "confidence_boosters": [
          "discord_cdn_urls_present",
          "google_search_parameters_intact",
          "unfurl_tool_compatibility"
        ],
        "typical_success_rate": 0.92,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "PDF_Metadata_Analysis",
        "mitre_id": "T1083",
        "required_services": [
          "file_system"
        ],
        "required_ports": [],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "pdf_files_accessible",
          "exiftool_available",
          "file_system_permissions"
        ],
        "success_indicators": [
          "metadata_extraction_successful",
          "creation_dates_available",
          "author_information_present"
        ],
        "incompatible_with": [
          "completely_stripped_metadata",
          "corrupted_pdf_files",
          "encrypted_pdfs"
        ],
        "confidence_boosters": [
          "anomalous_timestamps_present",
          "custom_producer_fields",
          "author_attribution_available"
        ],
        "typical_success_rate": 0.85,
        "estimated_time": "2-5 minutes"
      },
      {
        "technique": "OSINT_Investigation",
        "mitre_id": "T1590",
        "required_services": [
          "internet_access"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "internet_connectivity",
          "search_engines_accessible",
          "social_media_platforms_available"
        ],
        "success_indicators": [
          "threat_actor_attribution_found",
          "real_names_discovered",
          "geographic_locations_identified"
        ],
        "incompatible_with": [
          "no_internet_access",
          "heavily_filtered_networks",
          "complete_operational_security"
        ],
        "confidence_boosters": [
          "unique_identifiers_present",
          "cross_platform_correlation",
          "metadata_leakage_available"
        ],
        "typical_success_rate": 0.73,
        "estimated_time": "30-120 minutes"
      }
    ],
    "environmental_detectors": {
      "url_artifacts": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "banner_indicators": [
          "discord",
          "google",
          "cdn"
        ],
        "confidence_threshold": 0.9
      },
      "pdf_documents": {
        "port_indicators": [],
        "service_indicators": [
          "file_system"
        ],
        "technology_indicators": [
          "pdf",
          "exiftool",
          "metadata"
        ],
        "confidence_threshold": 0.95
      },
      "insider_threat_indicators": {
        "port_indicators": [
          22,
          80,
          443
        ],
        "service_indicators": [
          "ssh",
          "aws_s3",
          "file_transfer"
        ],
        "banner_indicators": [
          "data_exfiltration",
          "financial_motivation"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "url_parameter_analysis",
          "when": "discord_or_google_urls_detected",
          "reason": "high_timestamp_and_metadata_extraction_success"
        },
        {
          "attack": "pdf_metadata_extraction",
          "when": "pdf_files_present",
          "reason": "reliable_author_and_creation_data_available"
        }
      ],
      "medium_priority": [
        {
          "attack": "osint_correlation",
          "when": "unique_identifiers_found",
          "reason": "time_intensive_but_valuable_attribution"
        },
        {
          "attack": "timeline_reconstruction",
          "when": "multiple_timestamp_sources_available",
          "reason": "comprehensive_incident_understanding"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "URL Forensics Analysis",
        "mitre_id": "T1005",
        "category": "collection",
        "phase": "investigation",
        "tools_used": [
          {
            "name": "Unfurl",
            "command_template": "unfurl {url}",
            "actual_command": "https://dfir.blog/unfurl (web interface)",
            "output_pattern": "Timestamp extraction, parameter decoding, metadata visualization",
            "effectiveness_rating": 5,
            "reliability": 0.98
          }
        ],
        "prerequisites": [
          "urls_extracted_from_memory",
          "access_to_unfurl_tool",
          "understanding_of_url_structure"
        ],
        "success_indicators": [
          "timestamps_successfully_extracted",
          "discord_channel_ids_decoded",
          "google_search_parameters_parsed"
        ],
        "common_failures": [
          "expired_discord_urls",
          "malformed_timestamp_data",
          "url_encoding_issues"
        ],
        "follow_up_techniques": [
          "osint_investigation",
          "metadata_analysis",
          "timeline_construction"
        ],
        "time_investment": "15-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "PDF Metadata Analysis",
        "mitre_id": "T1083",
        "category": "discovery",
        "phase": "investigation",
        "tools_used": [
          {
            "name": "exiftool",
            "command_template": "exiftool {filename}",
            "actual_command": "exiftool NDA_Instructions.pdf",
            "output_pattern": "Author: {email}, Create Date: {timestamp}, Producer: {software}",
            "effectiveness_rating": 4,
            "reliability": 0.85
          }
        ],
        "prerequisites": [
          "pdf_file_available",
          "exiftool_installed"
        ],
        "success_indicators": [
          "author_information_extracted",
          "creation_timestamps_found",
          "producer_software_identified"
        ],
        "common_failures": [
          "metadata_stripped_or_modified",
          "corrupted_timestamp_data",
          "false_metadata_injection"
        ],
        "follow_up_techniques": [
          "osint_email_investigation",
          "linkedin_profile_discovery"
        ],
        "time_investment": "5-10 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "OSINT Email Investigation",
        "mitre_id": "T1589.002",
        "category": "reconnaissance",
        "phase": "investigation",
        "tools_used": [
          {
            "name": "Google Search",
            "command_template": "\"{email_address}\"",
            "actual_command": "\"CyberJunkie@AntiCorp.Gr04p\"",
            "output_pattern": "LinkedIn profiles, social media accounts",
            "effectiveness_rating": 4,
            "reliability": 0.75
          }
        ],
        "prerequisites": [
          "email_address_extracted",
          "internet_access"
        ],
        "success_indicators": [
          "linkedin_profile_discovered",
          "real_name_identified",
          "location_information_found"
        ],
        "common_failures": [
          "no_public_profiles_found",
          "false_identity_information",
          "privacy_settings_blocking_access"
        ],
        "follow_up_techniques": [
          "social_media_enumeration",
          "reverse_image_search"
        ],
        "time_investment": "10-20 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "Unfurl",
        "use_case": "url_forensics_analysis",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "digital_forensics",
          "incident_response"
        ],
        "alternatives": [
          "manual_url_parsing",
          "custom_python_scripts"
        ],
        "best_practices": [
          "use_web_interface_for_quick_analysis",
          "focus_on_timestamp_extraction",
          "validate_decoded_parameters"
        ]
      },
      {
        "tool": "exiftool",
        "use_case": "metadata_extraction",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "file_analysis",
          "forensic_investigation"
        ],
        "alternatives": [
          "file_properties",
          "strings_command"
        ],
        "best_practices": [
          "check_for_metadata_tampering",
          "cross_reference_timestamps",
          "extract_all_available_fields"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "insider_threat_url_analysis",
        "steps": [
          {
            "step": 1,
            "command": "unfurl https://cdn.discordapp.com/attachments/...",
            "purpose": "Extract Discord channel creation and file upload timestamps",
            "expected_output": "Channel ID: 2023-09-16 16:03:37, File ID: 2023-09-27 05:27:02"
          },
          {
            "step": 2,
            "command": "unfurl https://www.google.com/search?q=...",
            "purpose": "Extract Google search timestamps and query parameters",
            "expected_output": "Search time: 2023-09-27 05:31:45, Original query extraction"
          },
          {
            "step": 3,
            "command": "exiftool NDA_Instructions.pdf",
            "purpose": "Extract PDF metadata for threat actor identification",
            "expected_output": "Author email, creation date, producer information"
          },
          {
            "step": 4,
            "command": "Google search: \"CyberJunkie@AntiCorp.Gr04p\"",
            "purpose": "OSINT investigation of threat actor email",
            "expected_output": "LinkedIn profile with real name and location"
          }
        ],
        "success_rate": 0.92,
        "typical_duration": "30-60 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "Constellation",
      "difficulty": "Medium",
      "os": "N/A",
      "platform": "HackTheBox Sherlock",
      "release_date": "2023-12-14",
      "author": "CyberJunkie",
      "estimated_time": "90-120 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "intermediate",
      "primary_attack_vectors": [
        "insider_threat",
        "social_engineering"
      ],
      "key_vulnerabilities": [
        "human_factor",
        "data_exfiltration"
      ],
      "environment_type": "corporate_workstation",
      "real_world_relevance": "very_high",
      "learning_value": [
        "url_forensics",
        "osint_techniques",
        "timeline_analysis",
        "insider_threat_detection"
      ],
      "prerequisite_knowledge": [
        "digital_forensics",
        "osint_fundamentals",
        "url_structure_analysis"
      ]
    },
    "categorization": {
      "primary_category": "digital_forensics",
      "subcategories": [
        "url_analysis",
        "osint",
        "insider_threat"
      ],
      "attack_types": [
        "data_exfiltration",
        "insider_threat",
        "social_engineering"
      ],
      "defensive_lessons": [
        "employee_monitoring",
        "data_loss_prevention",
        "behavioral_analysis",
        "timeline_reconstruction"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Tracer",
        "Reminiscent",
        "OpTinselTrace"
      ],
      "similarity_reasons": [
        "forensics_focus",
        "osint_requirements",
        "timeline_analysis"
      ],
      "unique_aspects": [
        "url_based_forensics",
        "discord_analysis",
        "google_search_forensics"
      ],
      "difficulty_factors": [
        "osint_research_required",
        "url_parameter_analysis",
        "external_intelligence_gathering"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-05T02:46:03.659712",
    "original_file": "0xdf_writeups/Htb Sherlock Constellation.md",
    "content_length": 16088,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}