{
  "writeup_id": "Htb_Twomillion",
  "scenario_fingerprint": {
    "scenario_name": "linux_web_api_command_injection",
    "primary_services": [
      "http",
      "ssh"
    ],
    "port_signature": "22+80",
    "service_combination": "ssh+nginx",
    "os_family": "linux",
    "environment_type": "web_application",
    "entry_vector": "api_enumeration_privilege_escalation",
    "privilege_path": "web_user_to_admin_to_system",
    "attack_complexity": "easy",
    "estimated_time": "60-90 minutes",
    "scenario_confidence": 0.9,
    "distinguishing_factors": [
      "invite_code_challenge",
      "api_privilege_escalation",
      "command_injection_admin_endpoint",
      "database_credential_reuse"
    ],
    "environmental_clues": [
      "custom_web_application",
      "api_endpoints_exposed",
      "nginx_webserver",
      "ubuntu_22_04_jammy"
    ],
    "similar_scenarios": [
      "api_based_web_apps",
      "command_injection_scenarios"
    ],
    "unique_aspects": [
      "hackthebox_throwback_theme",
      "original_invite_challenge",
      "api_admin_escalation",
      "kernel_exploit_privesc"
    ]
  },
  "success_patterns": {
    "success_factors": [
      {
        "technique": "JavaScript_API_Discovery",
        "success_reason": "Client-side JavaScript exposed makeInviteCode function",
        "prerequisite_indicators": [
          "javascript_files_accessible",
          "minified_code_contains_functions",
          "developer_tools_available"
        ],
        "recognition_patterns": [
          "inviteapi.min.js file present",
          "function names in minified code",
          "autocomplete reveals hidden functions"
        ],
        "failure_modes": [
          "server_side_only_validation",
          "obfuscated_function_names",
          "no_client_side_logic"
        ],
        "environmental_factors": [
          "client_side_challenge_implementation",
          "educational_platform_design",
          "intentional_vulnerability"
        ],
        "success_probability": 0.95,
        "typical_timeframe": "10-20 minutes"
      },
      {
        "technique": "API_Endpoint_Enumeration",
        "success_reason": "Feroxbuster discovered API endpoints through link extraction",
        "prerequisite_indicators": [
          "api_endpoints_linked_in_html",
          "directory_traversal_possible",
          "rest_api_structure_present"
        ],
        "recognition_patterns": [
          "/api/v1/ structure visible",
          "405 Method Not Allowed responses",
          "consistent API versioning"
        ],
        "failure_modes": [
          "api_endpoints_not_linked",
          "authentication_required_immediately",
          "rate_limiting_active"
        ],
        "environmental_factors": [
          "modern_web_application_architecture",
          "restful_api_design",
          "insufficient_endpoint_protection"
        ],
        "success_probability": 0.85,
        "typical_timeframe": "5-10 minutes"
      },
      {
        "technique": "ROT13_Decoding",
        "success_reason": "JavaScript response contained ROT13 encoded instructions",
        "prerequisite_indicators": [
          "encoded_data_in_response",
          "recognizable_character_patterns",
          "educational_context_hints"
        ],
        "recognition_patterns": [
          "character_substitution_pattern",
          "readable_after_rotation",
          "instructional_content_revealed"
        ],
        "failure_modes": [
          "different_encoding_method",
          "multiple_encoding_layers",
          "encrypted_rather_than_encoded"
        ],
        "environmental_factors": [
          "beginner_friendly_challenge",
          "classic_encoding_method",
          "educational_platform_context"
        ],
        "success_probability": 0.9,
        "typical_timeframe": "2-5 minutes"
      }
    ],
    "critical_discoveries": [
      {
        "discovery": "makeInviteCode JavaScript function",
        "discovery_method": "Browser developer tools autocomplete",
        "why_critical": "Revealed hidden API endpoint for invite generation",
        "how_to_recognize": [
          "function names in minified javascript",
          "developer console autocomplete",
          "invite-related naming patterns"
        ],
        "follow_up_actions": [
          "execute_function_in_console",
          "decode_returned_data",
          "follow_api_instructions"
        ]
      },
      {
        "discovery": "/api/v1/ endpoint structure",
        "discovery_method": "Feroxbuster link extraction",
        "why_critical": "Exposed API architecture for further enumeration",
        "how_to_recognize": [
          "405 method not allowed responses",
          "consistent versioning pattern",
          "RESTful endpoint structure"
        ],
        "follow_up_actions": [
          "enumerate_additional_endpoints",
          "test_different_http_methods",
          "analyze_api_functionality"
        ]
      },
      {
        "discovery": "ROT13 encoded API instructions",
        "discovery_method": "JavaScript function execution and decoding",
        "why_critical": "Provided next step in challenge progression",
        "how_to_recognize": [
          "character_substitution_patterns",
          "educational_context_clues",
          "readable_after_rotation"
        ],
        "follow_up_actions": [
          "make_post_request_to_endpoint",
          "decode_invite_code",
          "register_account"
        ]
      }
    ],
    "escalation_keys": [
      {
        "privilege_level": "anonymous_user",
        "escalation_method": "Client_Side_Challenge_Bypass",
        "why_possible": "Educational platform with intentional client-side vulnerabilities",
        "recognition_signs": [
          "challenge_based_registration",
          "client_side_validation_logic",
          "educational_platform_context"
        ],
        "exploitation_path": "JavaScript Analysis → API Discovery → Invite Generation → Account Registration"
      }
    ]
  },
  "decision_tree": {
    "decision_points": [
      {
        "step": 1,
        "situation": "Found ports 22,80 open on Linux host with HTTP redirect to domain",
        "decision": "Add domain to hosts file and enumerate web application thoroughly",
        "reasoning": "Domain-based routing suggests potential for subdomain enumeration and web app focus",
        "confidence": 0.9,
        "alternatives": [
          {
            "option": "subdomain_bruteforce",
            "when": "after initial web enum"
          },
          {
            "option": "ssh_enumeration",
            "when": "if web fails"
          }
        ],
        "success_indicators": [
          "web_application_accessible",
          "custom_functionality_found",
          "api_endpoints_discovered"
        ],
        "next_decision": "analyze_web_application_attack_surface"
      },
      {
        "step": 2,
        "situation": "Found invite code challenge and JavaScript API references",
        "decision": "Analyze client-side JavaScript for API endpoints and hidden functionality",
        "reasoning": "JavaScript often contains API endpoints and logic that reveals attack vectors",
        "confidence": 0.95,
        "prerequisites": [
          "web_application_accessible"
        ],
        "success_indicators": [
          "javascript_functions_found",
          "api_endpoints_discovered"
        ],
        "failure_fallbacks": [
          "directory_bruteforce",
          "parameter_fuzzing"
        ]
      },
      {
        "step": 3,
        "situation": "Discovered makeInviteCode function and API endpoints",
        "decision": "Follow the intended challenge flow to gain authenticated access",
        "reasoning": "Legitimate access provides better enumeration opportunities than forced entry",
        "confidence": 0.85,
        "prerequisites": [
          "javascript_analysis_complete"
        ],
        "success_indicators": [
          "invite_code_generated",
          "account_registered",
          "authenticated_access"
        ],
        "failure_fallbacks": [
          "api_fuzzing",
          "parameter_manipulation"
        ]
      },
      {
        "step": 4,
        "situation": "Gained authenticated access to web application",
        "decision": "Enumerate API endpoints systematically for privilege escalation",
        "reasoning": "Authenticated users often have access to additional API functionality",
        "confidence": 0.9,
        "prerequisites": [
          "authenticated_access_obtained"
        ],
        "success_indicators": [
          "admin_endpoints_found",
          "privilege_escalation_possible"
        ],
        "failure_fallbacks": [
          "file_upload_testing",
          "parameter_injection_testing"
        ]
      }
    ],
    "branching_logic": {
      "if_javascript_analysis_succeeds": {
        "action": "follow_api_challenge_flow",
        "tools": [
          "curl",
          "browser_dev_tools",
          "base64"
        ],
        "next_phase": "authenticated_enumeration"
      },
      "if_invite_challenge_fails": {
        "action": "try_direct_api_fuzzing",
        "alternatives": [
          "directory_bruteforce",
          "parameter_fuzzing",
          "subdomain_enum"
        ],
        "decision_criteria": "based_on_error_responses"
      },
      "if_authenticated_access_obtained": {
        "action": "enumerate_api_endpoints_systematically",
        "purpose": "find_privilege_escalation_paths",
        "tools": [
          "burp_suite",
          "curl",
          "feroxbuster"
        ]
      }
    },
    "optimization_rules": [
      {
        "rule": "always_analyze_client_side_javascript_thoroughly",
        "reasoning": "javascript_often_reveals_api_endpoints_and_hidden_functionality",
        "applicability": "web_applications_with_dynamic_content"
      },
      {
        "rule": "follow_intended_challenge_flows_before_forcing_entry",
        "reasoning": "legitimate_access_provides_better_enumeration_opportunities",
        "applicability": "ctf_style_challenges_and_applications_with_puzzles"
      },
      {
        "rule": "systematically_enumerate_api_endpoints_after_authentication",
        "reasoning": "authenticated_users_often_have_access_to_privileged_functionality",
        "applicability": "api_driven_web_applications"
      }
    ]
  },
  "applicability_rules": {
    "technique_rules": [
      {
        "technique": "Web Directory Bruteforce",
        "mitre_id": "T1083",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "web_server_accessible",
          "directory_listing_disabled",
          "predictable_directory_structure"
        ],
        "success_indicators": [
          "200_status_codes_found",
          "hidden_directories_discovered",
          "api_endpoints_revealed"
        ],
        "incompatible_with": [
          "web_application_firewall_blocking",
          "rate_limiting_aggressive",
          "custom_404_handling_all_paths"
        ],
        "confidence_boosters": [
          "standard_web_frameworks",
          "default_installations",
          "common_cms_patterns"
        ],
        "typical_success_rate": 0.75,
        "estimated_time": "10-30 minutes"
      },
      {
        "technique": "API Enumeration",
        "mitre_id": "T1590.005",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443,
          8080,
          8443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "api_endpoints_exposed",
          "rest_api_architecture",
          "predictable_api_versioning"
        ],
        "success_indicators": [
          "api_directory_found",
          "version_endpoints_accessible",
          "method_not_allowed_responses"
        ],
        "incompatible_with": [
          "api_authentication_required_all_endpoints",
          "api_gateway_blocking",
          "non_standard_api_structure"
        ],
        "confidence_boosters": [
          "versioned_api_paths",
          "restful_naming_conventions",
          "swagger_documentation_present"
        ],
        "typical_success_rate": 0.82,
        "estimated_time": "5-20 minutes"
      },
      {
        "technique": "Client-Side Code Analysis",
        "mitre_id": "T1213.002",
        "required_services": [
          "http",
          "https"
        ],
        "required_ports": [
          80,
          443
        ],
        "os_requirements": [
          "any"
        ],
        "environmental_prerequisites": [
          "javascript_files_accessible",
          "minified_code_present",
          "client_side_logic_exposed"
        ],
        "success_indicators": [
          "api_endpoints_in_js",
          "authentication_logic_found",
          "hidden_functionality_discovered"
        ],
        "incompatible_with": [
          "server_side_rendering_only",
          "obfuscated_javascript",
          "dynamic_code_loading"
        ],
        "confidence_boosters": [
          "invite_challenge_patterns",
          "frontend_frameworks_detected",
          "unminified_debug_files"
        ],
        "typical_success_rate": 0.68,
        "estimated_time": "15-45 minutes"
      },
      {
        "technique": "SSH Service Enumeration",
        "mitre_id": "T1046",
        "required_services": [
          "ssh"
        ],
        "required_ports": [
          22
        ],
        "os_requirements": [
          "linux",
          "unix"
        ],
        "environmental_prerequisites": [
          "ssh_service_running",
          "banner_grabbing_allowed",
          "version_information_exposed"
        ],
        "success_indicators": [
          "ssh_version_identified",
          "os_version_determined",
          "authentication_methods_discovered"
        ],
        "incompatible_with": [
          "ssh_banner_disabled",
          "port_knocking_required",
          "fail2ban_aggressive"
        ],
        "confidence_boosters": [
          "ubuntu_openssh_versions",
          "default_ssh_configurations",
          "standard_port_usage"
        ],
        "typical_success_rate": 0.95,
        "estimated_time": "1-5 minutes"
      }
    ],
    "environmental_detectors": {
      "web_application": {
        "port_indicators": [
          80,
          443,
          8080,
          8443
        ],
        "service_indicators": [
          "http",
          "https",
          "nginx",
          "apache"
        ],
        "banner_indicators": [
          "nginx",
          "Apache",
          "IIS"
        ],
        "confidence_threshold": 0.9
      },
      "linux_system": {
        "port_indicators": [
          22
        ],
        "service_indicators": [
          "ssh",
          "OpenSSH"
        ],
        "banner_indicators": [
          "Ubuntu",
          "OpenSSH"
        ],
        "confidence_threshold": 0.85
      },
      "api_service": {
        "port_indicators": [
          80,
          443
        ],
        "service_indicators": [
          "http",
          "https"
        ],
        "path_indicators": [
          "/api",
          "/api/v1",
          "/rest"
        ],
        "confidence_threshold": 0.8
      }
    },
    "attack_prioritization": {
      "high_priority": [
        {
          "attack": "web_directory_bruteforce",
          "when": "web_service_detected",
          "reason": "reveals_hidden_endpoints_and_api_structure"
        },
        {
          "attack": "client_side_code_analysis",
          "when": "javascript_files_found",
          "reason": "often_contains_api_endpoints_and_logic_flaws"
        }
      ],
      "medium_priority": [
        {
          "attack": "api_enumeration",
          "when": "api_endpoints_discovered",
          "reason": "may_reveal_admin_functions_and_vulnerabilities"
        },
        {
          "attack": "ssh_enumeration",
          "when": "ssh_service_detected",
          "reason": "provides_os_fingerprinting_for_exploit_selection"
        }
      ]
    }
  },
  "technique_intelligence": {
    "techniques": [
      {
        "name": "API Enumeration and Privilege Escalation",
        "mitre_id": "T1087.004",
        "category": "discovery",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "curl",
            "command_template": "curl -X {method} http://{target}/api/v1/{endpoint}",
            "actual_command": "curl -X POST http://2million.htb/api/v1/invite/generate -s | jq .",
            "output_pattern": "JSON response with API structure",
            "effectiveness_rating": 5,
            "reliability": 0.98
          },
          {
            "name": "feroxbuster",
            "command_template": "feroxbuster -u http://{target}",
            "actual_command": "feroxbuster -u http://2million.htb",
            "success_factors": [
              "discovers_api_endpoints",
              "finds_javascript_files"
            ],
            "effectiveness_rating": 4
          }
        ],
        "prerequisites": [
          "web_application_accessible",
          "api_endpoints_discoverable"
        ],
        "success_indicators": [
          "api_structure_revealed",
          "admin_endpoints_identified",
          "privilege_escalation_possible"
        ],
        "common_failures": [
          "authentication_required",
          "rate_limiting_active",
          "api_documentation_hidden"
        ],
        "follow_up_techniques": [
          "parameter_manipulation",
          "privilege_escalation",
          "command_injection"
        ],
        "time_investment": "10-30 minutes",
        "skill_level": "intermediate"
      },
      {
        "name": "JavaScript Analysis for Hidden Functions",
        "mitre_id": "T1059.007",
        "category": "execution",
        "phase": "reconnaissance",
        "tools_used": [
          {
            "name": "browser_dev_tools",
            "command_template": "Open dev console and type function name",
            "actual_command": "makeInviteCode()",
            "output_pattern": "Encrypted/encoded response with hints",
            "effectiveness_rating": 5,
            "reliability": 0.95
          }
        ],
        "prerequisites": [
          "javascript_files_accessible",
          "minified_code_contains_functions"
        ],
        "success_indicators": [
          "hidden_functions_discovered",
          "api_endpoints_revealed",
          "authentication_bypass_possible"
        ],
        "common_failures": [
          "functions_obfuscated_beyond_recognition",
          "no_useful_functions_present"
        ],
        "follow_up_techniques": [
          "rot13_decoding",
          "base64_decoding",
          "api_exploitation"
        ],
        "time_investment": "5-15 minutes",
        "skill_level": "beginner"
      },
      {
        "name": "ROT13 and Base64 Decoding Chain",
        "mitre_id": "T1140",
        "category": "defense_evasion",
        "phase": "initial_access",
        "tools_used": [
          {
            "name": "tr",
            "command_template": "echo '{encoded_text}' | tr 'a-zA-Z' 'n-za-mN-ZA-M'",
            "actual_command": "curl -s -X POST http://2million.htb/api/v1/invite/how/to/generate | jq -r '.data.data' | tr 'a-zA-Z' 'n-za-mN-ZA-M'",
            "output_pattern": "Decoded instructions or endpoints",
            "effectiveness_rating": 5,
            "reliability": 1.0
          },
          {
            "name": "base64",
            "command_template": "echo '{base64_string}' | base64 -d",
            "actual_command": "echo 'TUlQU1gtNDRFWkctVVNWVTgtMTk0VUs=' | base64 -d",
            "success_factors": [
              "valid_base64_encoding",
              "meaningful_decoded_output"
            ],
            "effectiveness_rating": 5
          }
        ],
        "prerequisites": [
          "encoded_data_available",
          "encoding_type_identified"
        ],
        "success_indicators": [
          "data_successfully_decoded",
          "actionable_information_revealed",
          "access_codes_obtained"
        ],
        "common_failures": [
          "incorrect_encoding_assumption",
          "corrupted_encoded_data"
        ],
        "follow_up_techniques": [
          "credential_validation",
          "account_registration",
          "authenticated_enumeration"
        ],
        "time_investment": "2-5 minutes",
        "skill_level": "beginner"
      }
    ],
    "tool_effectiveness": [
      {
        "tool": "curl",
        "use_case": "api_enumeration_and_exploitation",
        "effectiveness_rating": 5,
        "reliability": 0.98,
        "learning_curve": "low",
        "essential_for": [
          "api_testing",
          "http_method_manipulation"
        ],
        "alternatives": [
          "burp_suite",
          "postman",
          "httpie"
        ],
        "best_practices": [
          "use_json_output_with_jq",
          "specify_content_type_headers",
          "test_different_http_methods"
        ]
      },
      {
        "tool": "feroxbuster",
        "use_case": "web_directory_and_api_discovery",
        "effectiveness_rating": 4,
        "reliability": 0.9,
        "learning_curve": "low",
        "essential_for": [
          "web_application_enumeration"
        ],
        "alternatives": [
          "gobuster",
          "dirbuster",
          "ffuf"
        ],
        "best_practices": [
          "use_appropriate_wordlists",
          "enable_link_extraction",
          "filter_false_positives"
        ]
      }
    ],
    "command_sequences": [
      {
        "sequence_name": "hackthebox_invite_challenge_bypass",
        "steps": [
          {
            "step": 1,
            "command": "curl -s http://2million.htb/js/inviteapi.min.js | grep -o 'makeInviteCode\\|verifyInviteCode'",
            "purpose": "Identify hidden JavaScript functions",
            "expected_output": "Function names in minified JS"
          },
          {
            "step": 2,
            "command": "curl -s -X POST http://2million.htb/api/v1/invite/how/to/generate | jq -r '.data.data' | tr 'a-zA-Z' 'n-za-mN-ZA-M'",
            "purpose": "Decode ROT13 instructions",
            "expected_output": "API endpoint for invite generation"
          },
          {
            "step": 3,
            "command": "curl -X POST http://2million.htb/api/v1/invite/generate -s | jq -r '.data.code' | base64 -d",
            "purpose": "Generate and decode invite code",
            "expected_output": "Valid invite code format"
          },
          {
            "step": 4,
            "command": "curl -X GET http://2million.htb/api/v1",
            "purpose": "Enumerate full API structure",
            "expected_output": "Complete API endpoint listing including admin endpoints"
          }
        ],
        "success_rate": 0.95,
        "typical_duration": "10-20 minutes"
      },
      {
        "sequence_name": "api_privilege_escalation_discovery",
        "steps": [
          {
            "step": 1,
            "command": "curl -X GET http://2million.htb/api/v1/admin/auth -H 'Cookie: PHPSESSID=your_session'",
            "purpose": "Check admin status",
            "expected_output": "Admin status false"
          },
          {
            "step": 2,
            "command": "curl -X PUT http://2million.htb/api/v1/admin/settings/update -H 'Content-Type: application/json' -H 'Cookie: PHPSESSID=your_session'",
            "purpose": "Test admin endpoint accessibility",
            "expected_output": "Parameter validation errors instead of 401"
          },
          {
            "step": 3,
            "command": "curl -X PUT http://2million.htb/api/v1/admin/settings/update -H 'Content-Type: application/json' -d '{\"email\":\"test@test.com\"}' -H 'Cookie: PHPSESSID=your_session'",
            "purpose": "Attempt parameter manipulation",
            "expected_output": "Further parameter requirements or success"
          }
        ],
        "success_rate": 0.85,
        "typical_duration": "15-30 minutes"
      }
    ]
  },
  "metadata": {
    "basic_metadata": {
      "name": "TwoMillion",
      "difficulty": "Easy",
      "os": "Ubuntu 22.04",
      "platform": "HackTheBox",
      "release_date": "2023-06-07",
      "author": "TRX & TheCyberGeek",
      "estimated_time": "60-90 minutes"
    },
    "intelligence_metadata": {
      "attack_complexity": "medium",
      "skill_level_required": "beginner_to_intermediate",
      "primary_attack_vectors": [
        "api_enumeration",
        "command_injection",
        "kernel_exploit"
      ],
      "key_vulnerabilities": [
        "api_privilege_escalation",
        "command_injection",
        "kernel_vulnerability"
      ],
      "environment_type": "web_application_linux_server",
      "real_world_relevance": "high",
      "learning_value": [
        "api_security",
        "privilege_escalation_techniques",
        "kernel_exploitation"
      ],
      "prerequisite_knowledge": [
        "web_enumeration",
        "api_testing",
        "linux_fundamentals"
      ]
    },
    "categorization": {
      "primary_category": "web_application",
      "subcategories": [
        "api_security",
        "command_injection",
        "kernel_exploitation"
      ],
      "attack_types": [
        "privilege_escalation",
        "code_execution",
        "credential_access"
      ],
      "defensive_lessons": [
        "api_security_controls",
        "input_validation",
        "kernel_patching"
      ]
    },
    "similarity_markers": {
      "similar_boxes": [
        "Invite",
        "API",
        "Postman"
      ],
      "similarity_reasons": [
        "api_enumeration",
        "web_application_focus",
        "privilege_escalation"
      ],
      "unique_aspects": [
        "htb_nostalgia_theme",
        "invite_code_challenge",
        "special_commemorative_release"
      ],
      "difficulty_factors": [
        "api_discovery_required",
        "multiple_escalation_steps",
        "kernel_exploit_needed"
      ]
    }
  },
  "extraction_metadata": {
    "parse_date": "2025-07-04T13:44:34.847148",
    "original_file": "0xdf_writeups/Htb Twomillion.md",
    "content_length": 30566,
    "extraction_version": "2.0-claude",
    "model_used": "claude-sonnet-4-20250514"
  },
  "intelligence_confidence": 1.0,
  "quality_breakdown": {
    "scenario_uniqueness": 1.0,
    "success_logic_clarity": 1.0,
    "applicability_completeness": 1.0,
    "decision_tree_depth": 1.0,
    "technique_actionability": 1.0
  }
}